{
  "spec": {
    "title": "CSS View Transitions Module Level 2",
    "url": "https://drafts.csswg.org/css-view-transitions-2/"
  },
  "algorithms": [
    {
      "html": "A successful cross-document view transition goes through the following phases:",
      "rationale": "if",
      "steps": [
        {
          "html": "In the old <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document\">Document</a></code>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>The user initiates a navigation, by clicking a link, submitting a form, pressing the browser’s back button, etc.</p>"
            },
            {
              "html": "<p>When the new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document①\">Document</a></code> is ready to be activated, the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/indices.html#event-pageswap\" id=\"ref-for-event-pageswap①\">pageswap</a></code> event is fired.</p>"
            },
            {
              "html": "<p>If the navigation is <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#same-origin\" id=\"ref-for-same-origin①\">same origin</a>, has no cross-origin redirects,\nand the old <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document②\">Document</a></code> has <a href=\"https://drafts.csswg.org/css-view-transitions-2/#cross-doc-opt-in\">opted in to cross-document view transitions</a>, the event’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-pageswapevent-viewtransition\" id=\"ref-for-dom-pageswapevent-viewtransition①\">viewTransition</a></code> attribute would be\na <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition\" id=\"ref-for-viewtransition③\">ViewTransition</a></code> object.</p>"
            },
            {
              "html": "<p>The author can now customize the transition, e.g. by mutating its <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-2/#dom-viewtransition-types\" id=\"ref-for-dom-viewtransition-types②\">types</a></code>, or <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-1/#dom-viewtransition-skiptransition\" id=\"ref-for-dom-viewtransition-skiptransition\">skip</a></code> it altogether.</p>"
            },
            {
              "html": "<p>If the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition\" id=\"ref-for-viewtransition④\">ViewTransition</a></code> is not skipped, the state of the old document is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#capture-the-old-state\" id=\"ref-for-capture-the-old-state\">captured</a>.</p>"
            },
            {
              "html": "<p>The navigation proceeds: the old <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document③\">Document</a></code> is unloaded, and the new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document④\">Document</a></code> is now active.</p>"
            }
          ]
        },
        {
          "html": "Then, in the new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document⑤\">Document</a></code>:",
          "rationale": "resolve",
          "steps": [
            {
              "html": "<p>When the new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document⑥\">Document</a></code> is ready for its first <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#rendering-opportunity\" id=\"ref-for-rendering-opportunity\">rendering opportunity</a>, an event named <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/indices.html#event-pagereveal\" id=\"ref-for-event-pagereveal①\">pagereveal</a></code> is fired on the new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document⑦\">Document</a></code>, with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-pagerevealevent-viewtransition\" id=\"ref-for-dom-pagerevealevent-viewtransition①\">viewTransition</a></code> attribute.</p>"
            },
            {
              "html": "<p>This <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition\" id=\"ref-for-viewtransition⑤\">ViewTransition</a></code>’s <code><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-1/#dom-viewtransition-updatecallbackdone\" id=\"ref-for-dom-viewtransition-updatecallbackdone\">updateCallbackDone</a></code></code> promise is already resolved,\nand its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#captured-element\" id=\"ref-for-captured-element\">captured elements</a> are populated from the old <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document⑧\">Document</a></code>.</p>"
            },
            {
              "html": "<p>This is another opportunity for the author to customize the transition, e.g. by mutating its <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-2/#dom-viewtransition-types\" id=\"ref-for-dom-viewtransition-types③\">types</a></code>, or <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-1/#dom-viewtransition-skiptransition\" id=\"ref-for-dom-viewtransition-skiptransition①\">skip</a></code> it altogether.</p>"
            },
            {
              "html": "<p>The state of the new document is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#capture-the-new-state\" id=\"ref-for-capture-the-new-state\">captured</a> as the \"new\" state of the transition.</p>"
            },
            {
              "html": "<p>From this point forward, the transition continues in a similar fashion to a same-document transition, as per <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#activate-view-transition\" id=\"ref-for-activate-view-transition\">activate view transition</a>.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "start-vt-with-options",
      "href": "https://drafts.csswg.org/css-view-transitions-2/#dom-document-startviewtransition",
      "html": "The <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#method-steps\" id=\"ref-for-method-steps\">method steps</a> for <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"Document\" data-dfn-type=\"method\" data-export=\"\" data-lt=\"startViewTransition(callbackOptions)|startViewTransition()\" id=\"dom-document-startviewtransition\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>startViewTransition(<var>callbackOptions</var>)</code></dfn> are as follows:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>updateCallback</var> be null.</p>"
        },
        {
          "html": "<p>If <var>callbackOptions</var> is a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-1/#callbackdef-viewtransitionupdatecallback\" id=\"ref-for-callbackdef-viewtransitionupdatecallback②\">ViewTransitionUpdateCallback</a></code>, set <var>updateCallback</var> to <var>callbackOptions</var>.</p>"
        },
        {
          "html": "<p>Otherwise, if <var>callbackOptions</var> is a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-2/#dictdef-startviewtransitionoptions\" id=\"ref-for-dictdef-startviewtransitionoptions①\">StartViewTransitionOptions</a></code>, then set <var>updateCallback</var> to <var>callbackOptions</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-2/#dom-startviewtransitionoptions-update\" id=\"ref-for-dom-startviewtransitionoptions-update\">update</a></code>.</p>"
        },
        {
          "html": "If <var>this</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#document-active-view-transition\" id=\"ref-for-document-active-view-transition⑦\">active view transition</a> is not null and its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#viewtransition-outbound-post-capture-steps\" id=\"ref-for-viewtransition-outbound-post-capture-steps\">outbound post-capture steps</a> is not null,\nthen:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>preSkippedTransition</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition\" id=\"ref-for-viewtransition①②\">ViewTransition</a></code> in <var>this</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\" id=\"ref-for-concept-relevant-realm\">relevant realm</a> whose <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition-update-callback\" id=\"ref-for-viewtransition-update-callback\">update callback</a> is <var>updateCallback</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#skip-the-view-transition\" id=\"ref-for-skip-the-view-transition\">Skip</a> <var>preSkippedTransition</var> with an \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror\">InvalidStateError</a></code>\" <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException\">DOMException</a></code>.</p>"
            },
            {
              "html": "<p>Return <var>preSkippedTransition</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Let <var>viewTransition</var> be the result of running the <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#method-steps\" id=\"ref-for-method-steps①\">method steps</a> for <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-1/#dom-document-startviewtransition\" id=\"ref-for-dom-document-startviewtransition⑦\">startViewTransition(updateCallback)</a></code> given <var>updateCallback</var>.</p>"
        },
        {
          "html": "<p>If <var>callbackOptions</var> is a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-2/#dictdef-startviewtransitionoptions\" id=\"ref-for-dictdef-startviewtransitionoptions②\">StartViewTransitionOptions</a></code>, set <var>viewTransition</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#viewtransition-active-types\" id=\"ref-for-viewtransition-active-types⑥\">active types</a> to a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-clone\" id=\"ref-for-list-clone\">clone</a> of <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-2/#dom-startviewtransitionoptions-types\" id=\"ref-for-dom-startviewtransitionoptions-types①\">types</a></code> as a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ordered-set\" id=\"ref-for-ordered-set①\">set</a>.</p>"
        },
        {
          "html": "<p>Return <var>viewTransition</var>.</p>"
        }
      ]
    },
    {
      "name": "view-transition-name/auto",
      "href": "https://drafts.csswg.org/css-view-transitions-2/#view-transition-name-auto",
      "html": "In addition to the existing values, the <a class=\"property css\" data-link-type=\"property\" href=\"https://drafts.csswg.org/css-view-transitions-1/#propdef-view-transition-name\" id=\"ref-for-propdef-view-transition-name①④\">view-transition-name</a> also accepts an <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"view-transition-name\" data-dfn-type=\"dfn\" data-export=\"\" id=\"view-transition-name-auto\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">auto</dfn> keyword.\nTo resolve the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-cascade-5/#used-value\" id=\"ref-for-used-value\">used value</a> of <span class=\"property\" id=\"ref-for-propdef-view-transition-name①⑤\">view-transition-name</span> for <var>element</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>computed</var> be the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-cascade-5/#computed-value\" id=\"ref-for-computed-value\">computed value</a> of <a class=\"property css\" data-link-type=\"property\" href=\"https://drafts.csswg.org/css-view-transitions-1/#propdef-view-transition-name\" id=\"ref-for-propdef-view-transition-name①⑥\">view-transition-name</a>.</p>"
        },
        {
          "html": "<p>If <var>computed</var> is <span class=\"css\">none</span>, return null.</p>"
        },
        {
          "html": "<p>If <var>computed</var> is a <a class=\"production css\" data-link-type=\"type\" href=\"https://drafts.csswg.org/css-values-4/#identifier-value\" id=\"ref-for-identifier-value①③\">&lt;custom-ident&gt;</a>, return <var>computed</var>.</p>"
        },
        {
          "html": "<p class=\"assertion\">Assert: <var>computed</var> is <span class=\"css\">auto</span> or <span class=\"css\">match-element</span>.</p>"
        },
        {
          "html": "<p>If <var>computed</var> is <span class=\"css\">auto</span>, <var>element</var> has an associated <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-id\" id=\"ref-for-concept-id②\">id</a>, and <var>computed</var> is associated with the same <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-tree-root\" id=\"ref-for-concept-tree-root\">root</a> as <var>element</var>’s <span id=\"ref-for-concept-tree-root①\">root</span>, then return a unique string starting with \"<code>-ua-</code>\".\nTwo elements with the same <span id=\"ref-for-concept-id③\">id</span> must return the same string, regardless of their <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-node-document\" id=\"ref-for-concept-node-document②\">node document</a>.</p>"
        },
        {
          "html": "<p>Return a unique string starting with \"<code>-ua-</code>\". The string should remain consistent and unique for this element and <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document①②\">Document</a></code>, at least for the lifetime of <var>element</var>’s <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-node-document\" id=\"ref-for-concept-node-document③\">node document</a>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#document-active-view-transition\" id=\"ref-for-document-active-view-transition⑧\">active view transition</a>.</p>"
        }
      ]
    },
    {
      "name": "visibility change step additions",
      "html": "The next steps are appended to the tasks <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#view-transition-page-visibility-change-steps\" id=\"ref-for-view-transition-page-visibility-change-steps\">view transition page-visibility change steps</a> given <var>document</var>, after the current steps in the queued task:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Set <var>document</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#document-inbound-view-transition-params\" id=\"ref-for-document-inbound-view-transition-params\">inbound view transition params</a> to null.</p>"
        }
      ]
    },
    {
      "name": "resolve @view-transition rule",
      "href": "https://drafts.csswg.org/css-view-transitions-2/#resolve-view-transition-rule",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"resolve-view-transition-rule\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">resolve @view-transition rule</dfn> for a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document①⑤\">Document</a></code> <var>document</var>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <var>document</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/interaction.html#visibility-state\" id=\"ref-for-visibility-state\">visibility state</a> is \"<code>hidden</code>\",\nthen return \"<code>skip transition</code>\".</p>"
        },
        {
          "html": "<p>Let <var>matchingRule</var> be the last <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-view-transitions-2/#at-view-transition-rule\" id=\"ref-for-at-view-transition-rule①⑤\">@view-transition</a> rule in <var>document</var>.</p>"
        },
        {
          "html": "<p>If <var>matchingRule</var> is not found, then return \"<code>skip transition</code>\".</p>"
        },
        {
          "html": "<p>If <var>matchingRule</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#view-transition-navigation\" id=\"ref-for-view-transition-navigation②\">navigation</a> descriptor’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-cascade-5/#computed-value\" id=\"ref-for-computed-value①\">computed value</a> is <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-view-transitions-2/#valdef-view-transition-navigation-none\" id=\"ref-for-valdef-view-transition-navigation-none\">none</a>, then return \"<code>skip transition</code>\".</p>"
        },
        {
          "html": "<p class=\"assertion\">Assert: <var>matchingRule</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#view-transition-navigation\" id=\"ref-for-view-transition-navigation③\">navigation</a> descriptor’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-cascade-5/#computed-value\" id=\"ref-for-computed-value②\">computed value</a> is <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-view-transitions-2/#valdef-view-transition-navigation-auto\" id=\"ref-for-valdef-view-transition-navigation-auto①\">auto</a>.</p>"
        },
        {
          "html": "<p>Let <var>typesDescriptor</var> be <var>matchingRule</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#view-transition-types\" id=\"ref-for-view-transition-types④\">types</a> descriptor.</p>"
        },
        {
          "html": "<p>If <var>typesDescriptor</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-cascade-5/#computed-value\" id=\"ref-for-computed-value③\">computed value</a> is <span class=\"css\">none</span>, then return a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ordered-set\" id=\"ref-for-ordered-set②\">set</a> « ».</p>"
        },
        {
          "html": "<p>Return a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ordered-set\" id=\"ref-for-ordered-set③\">set</a> of strings corresponding to <var>typesDescriptor</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-cascade-5/#computed-value\" id=\"ref-for-computed-value④\">computed value</a>.</p>"
        }
      ]
    },
    {
      "name": "navigation can trigger a cross-document view-transition?",
      "href": "https://drafts.csswg.org/css-view-transitions-2/#navigation-can-trigger-a-cross-document-view-transition",
      "html": "To check if a <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-export=\"\" id=\"navigation-can-trigger-a-cross-document-view-transition\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">navigation can trigger a cross-document view-transition?</dfn> given\n\ta <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document①⑦\">Document</a></code> <var>oldDocument</var>, a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document①⑧\">Document</a></code> <var>newDocument</var>, a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#navigationtype\" id=\"ref-for-navigationtype①\">NavigationType</a></code> <var>navigationType</var>, and a boolean <var>isBrowserUINavigation</var>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If the user agent decides to display an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#implementation-defined\" id=\"ref-for-implementation-defined\">implementation-defined</a> navigation experience, e.g. a gesture-based transition for a back navigation,\nthe user agent may ignore the author-defined view transition. If that is the case, return false.</p>"
        },
        {
          "html": "<p>If <var>oldDocument</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#document-can-initiate-outbound-view-transition\" id=\"ref-for-document-can-initiate-outbound-view-transition\">can initiate outbound view transition</a> is false, then return false.</p>"
        },
        {
          "html": "<p>If <var>navigationType</var> is <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-reload\" id=\"ref-for-dom-navigationtype-reload①\">reload</a></code>, then return false.</p>"
        },
        {
          "html": "<p>If <var>oldDocument</var>’s <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-document-origin\" id=\"ref-for-concept-document-origin\">origin</a> is not <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#same-origin\" id=\"ref-for-same-origin②\">same origin</a> as <var>newDocument</var>’s <span id=\"ref-for-concept-document-origin①\">origin</span>, then return false.</p>"
        },
        {
          "html": "<p>If <var>newDocument</var> <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/dom.html#was-created-via-cross-origin-redirects\" id=\"ref-for-was-created-via-cross-origin-redirects\">was created via cross-origin redirects</a> and <var>newDocument</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsing-the-web.html#latest-entry\" id=\"ref-for-latest-entry\">latest entry</a> is null, then return false.</p>"
        },
        {
          "html": "<p>If <var>navigationType</var> is <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-navigationtype-traverse\" id=\"ref-for-dom-navigationtype-traverse②\">traverse</a></code>, then return true.</p>"
        },
        {
          "html": "<p>If <var>isBrowserUINavigation</var> is true, then return false.</p>"
        },
        {
          "html": "<p>Return true.</p>"
        }
      ]
    },
    {
      "name": "setup cross-document view-transition",
      "href": "https://drafts.csswg.org/css-view-transitions-2/#setup-cross-document-view-transition",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-export=\"\" id=\"setup-cross-document-view-transition\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">setup cross-document view-transition</dfn> given a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document①⑨\">Document</a></code> <var>oldDocument</var>,\n\ta <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document②⓪\">Document</a></code> <var>newDocument</var>, and <var>proceedWithNavigation</var>, which is an algorithm accepting nothing:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#assert\" id=\"ref-for-assert\">Assert</a>: These steps are running as part of a <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-task\" id=\"ref-for-concept-task\">task</a> queued on <var>oldDocument</var>.</p>"
        },
        {
          "html": "<p>If <var>oldDocument</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#document-can-initiate-outbound-view-transition\" id=\"ref-for-document-can-initiate-outbound-view-transition①\">can initiate outbound view transition</a> is false, then return null.</p>"
        },
        {
          "html": "<p>Let <var>transitionTypesFromRule</var> be the result of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#resolve-view-transition-rule\" id=\"ref-for-resolve-view-transition-rule\">resolving the @view-transition rule</a> for <var>oldDocument</var>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#assert\" id=\"ref-for-assert①\">Assert</a>: <var>transitionTypesFromRule</var> is not \"<code>skip transition</code>\".</p>"
        },
        {
          "html": "<p>If <var>oldDocument</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#document-active-view-transition\" id=\"ref-for-document-active-view-transition⑨\">active view transition</a> is not null,\nthen <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#skip-the-view-transition\" id=\"ref-for-skip-the-view-transition①\">skip</a> <var>oldDocument</var>’s <span id=\"ref-for-document-active-view-transition①⓪\">active view transition</span>\nwith an \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#aborterror\" id=\"ref-for-aborterror\">AbortError</a></code>\" <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException①\">DOMException</a></code> in <var>oldDocument</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\" id=\"ref-for-concept-relevant-realm①\">relevant Realm</a>.</p>"
        },
        {
          "html": "<p>Let <var>outboundTransition</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition\" id=\"ref-for-viewtransition①⑤\">ViewTransition</a></code> object in <var>oldDocument</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\" id=\"ref-for-concept-relevant-realm②\">relevant Realm</a>.</p>"
        },
        {
          "html": "<p>Set <var>outboundTransition</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#viewtransition-active-types\" id=\"ref-for-viewtransition-active-types⑦\">active types</a> to <var>transitionTypesFromRule</var>.</p>"
        },
        {
          "html": "Set <var>outboundTransition</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#viewtransition-outbound-post-capture-steps\" id=\"ref-for-viewtransition-outbound-post-capture-steps①\">outbound post-capture steps</a> to the following steps given a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#view-transition-params\" id=\"ref-for-view-transition-params②\">view transition params</a>-or-null <var>params</var>:",
          "rationale": "set",
          "steps": [
            {
              "html": "<p>Set <var>newDocument</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#document-inbound-view-transition-params\" id=\"ref-for-document-inbound-view-transition-params①\">inbound view transition params</a> to <var>params</var>.</p>"
            },
            {
              "html": "To skip the transition after a timeout, the user agent may perform the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel③\">in parallel</a>:",
              "rationale": "wait",
              "steps": [
                {
                  "html": "<p>Wait for an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#implementation-defined\" id=\"ref-for-implementation-defined①\">implementation-defined</a> <a data-link-type=\"dfn\" href=\"https://w3c.github.io/hr-time/#dfn-duration\" id=\"ref-for-dfn-duration\">duration</a>.</p>"
                },
                {
                  "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\" id=\"ref-for-queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source\" id=\"ref-for-dom-manipulation-task-source\">DOM manipulation task source</a> given <var>newDocument</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\" id=\"ref-for-concept-relevant-global\">relevant global object</a> to perform the following step:",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>If <var>newDocument</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#document-inbound-view-transition-params\" id=\"ref-for-document-inbound-view-transition-params②\">inbound view transition params</a> is <var>params</var>, then set <var>newDocument</var>’s <span id=\"ref-for-document-inbound-view-transition-params③\">inbound view transition params</span> to null.</p>"
                    }
                  ]
                }
              ]
            },
            {
              "html": "<p>Call <var>proceedWithNavigation</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Set <var>oldDocument</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#document-active-view-transition\" id=\"ref-for-document-active-view-transition①①\">active view transition</a> to <var>outboundTransition</var>.</p>"
        },
        {
          "html": "<p>The user agent should display the currently displayed frame until either:</p>\n     <ul>\n      <li data-md=\"\">\n       <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/indices.html#event-pagereveal\" id=\"ref-for-event-pagereveal⑤\">pagereveal</a></code> event is fired.</p>\n      </li><li data-md=\"\">\n       <p>its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#document-active-view-transition\" id=\"ref-for-document-active-view-transition①②\">active view transition</a>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition-phase\" id=\"ref-for-viewtransition-phase\">phase</a> is \"<code>done</code>\".</p>\n     </li></ul>"
        },
        {
          "html": "<p>Return <var>outboundTransition</var>.</p>"
        }
      ]
    },
    {
      "name": "update-opt-in-for-outbound",
      "href": "https://drafts.csswg.org/css-view-transitions-2/#update-the-opt-in-state-for-outbound-transitions",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"update-the-opt-in-state-for-outbound-transitions\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">update the opt-in state for outbound transitions</dfn> for a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document②①\">Document</a></code> <var>document</var>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <var>document</var> <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsing-the-web.html#has-been-revealed\" id=\"ref-for-has-been-revealed\">has been revealed</a>, and the result of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#resolve-view-transition-rule\" id=\"ref-for-resolve-view-transition-rule①\">resolving the @view-transition rule</a> is not \"<code>skip transition</code>\",\nthen set <var>document</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#document-can-initiate-outbound-view-transition\" id=\"ref-for-document-can-initiate-outbound-view-transition②\">can initiate outbound view transition</a> to true.</p>"
        },
        {
          "html": "<p>Otherwise, set <var>document</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#document-can-initiate-outbound-view-transition\" id=\"ref-for-document-can-initiate-outbound-view-transition③\">can initiate outbound view transition</a> to false.</p>"
        }
      ]
    },
    {
      "name": "additional skip steps",
      "html": "Append the following steps to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#skip-the-view-transition\" id=\"ref-for-skip-the-view-transition②\">skip the view transition</a> given a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition\" id=\"ref-for-viewtransition①⑦\">ViewTransition</a></code> <var>transition</var>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <var>transition</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#viewtransition-outbound-post-capture-steps\" id=\"ref-for-viewtransition-outbound-post-capture-steps②\">outbound post-capture steps</a> is not null, then run <var>transition</var>’s <span id=\"ref-for-viewtransition-outbound-post-capture-steps③\">outbound post-capture steps</span> with null.</p>"
        }
      ]
    },
    {
      "name": "additional transition operation",
      "html": "Prepend the following step to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#perform-pending-transition-operations\" id=\"ref-for-perform-pending-transition-operations①\">Perform pending transition operations</a> algorithm given a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document②②\">Document</a></code> <var>document</var>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "If <var>document</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#document-active-view-transition\" id=\"ref-for-document-active-view-transition①③\">active view transition</a> is not null and its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#viewtransition-outbound-post-capture-steps\" id=\"ref-for-viewtransition-outbound-post-capture-steps④\">outbound post-capture steps</a> is not null, then:",
          "rationale": "assert",
          "steps": [
            {
              "html": "<p class=\"assertion\">Assert: <var>document</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#document-active-view-transition\" id=\"ref-for-document-active-view-transition①④\">active view transition</a>’s  <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition-phase\" id=\"ref-for-viewtransition-phase①\">phase</a> is \"<code>pending-capture</code>\".</p>"
            },
            {
              "html": "<p>Let <var>viewTransitionParams</var> be null;</p>"
            },
            {
              "html": "<p>Set <var>document</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#document-rendering-suppression-for-view-transitions\" id=\"ref-for-document-rendering-suppression-for-view-transitions\">rendering suppression for view transitions</a> to true.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#capture-the-old-state\" id=\"ref-for-capture-the-old-state②\">Capture the old state</a> for <var>transition</var>.</p>"
            },
            {
              "html": "<p>If this succeeded, then set <var>viewTransitionParams</var> to a new <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#view-transition-params\" id=\"ref-for-view-transition-params③\">view transition params</a> whose\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#view-transition-params-named-elements\" id=\"ref-for-view-transition-params-named-elements\">named elements</a> is a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#map-clone\" id=\"ref-for-map-clone\">clone</a> of <var>transition</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition-named-elements\" id=\"ref-for-viewtransition-named-elements①\">named elements</a>,\nand whose <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#view-transition-params-initial-snapshot-containing-block-size\" id=\"ref-for-view-transition-params-initial-snapshot-containing-block-size\">initial snapshot containing block size</a> is <var>transition</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition-initial-snapshot-containing-block-size\" id=\"ref-for-viewtransition-initial-snapshot-containing-block-size\">initial snapshot containing block size</a>.</p>"
            },
            {
              "html": "<p>Set <var>document</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#document-rendering-suppression-for-view-transitions\" id=\"ref-for-document-rendering-suppression-for-view-transitions①\">rendering suppression for view transitions</a> to false.</p>"
            },
            {
              "html": "<p>Call <var>transition</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#viewtransition-outbound-post-capture-steps\" id=\"ref-for-viewtransition-outbound-post-capture-steps⑤\">outbound post-capture steps</a> given <var>viewTransitionParams</var>.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "resolve inbound cross-document view-transition",
      "href": "https://drafts.csswg.org/css-view-transitions-2/#resolve-inbound-cross-document-view-transition",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-export=\"\" id=\"resolve-inbound-cross-document-view-transition\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">resolve inbound cross-document view-transition</dfn> for <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document②④\">Document</a></code> <var>document</var>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#assert\" id=\"ref-for-assert②\">Assert</a>: <var>document</var> is <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/document-sequences.html#fully-active\" id=\"ref-for-fully-active\">fully active</a>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#assert\" id=\"ref-for-assert③\">Assert</a>: <var>document</var> <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsing-the-web.html#has-been-revealed\" id=\"ref-for-has-been-revealed①\">has been revealed</a> is true.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#update-the-opt-in-state-for-outbound-transitions\" id=\"ref-for-update-the-opt-in-state-for-outbound-transitions①\">Update the opt-in state for outbound transitions</a> for <var>document</var>.</p>"
        },
        {
          "html": "<p>Let <var>inboundViewTransitionParams</var> be <var>document</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#document-inbound-view-transition-params\" id=\"ref-for-document-inbound-view-transition-params④\">inbound view transition params</a>.</p>"
        },
        {
          "html": "<p>If <var>inboundViewTransitionParams</var> is null, then return null.</p>"
        },
        {
          "html": "<p>Set <var>document</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#document-inbound-view-transition-params\" id=\"ref-for-document-inbound-view-transition-params⑤\">inbound view transition params</a> to null.</p>"
        },
        {
          "html": "<p>If <var>document</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#document-active-view-transition\" id=\"ref-for-document-active-view-transition①⑤\">active view transition</a> is not null, then return null.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#resolve-view-transition-rule\" id=\"ref-for-resolve-view-transition-rule②\">Resolve @view-transition rule</a> for <var>document</var> and let <var>resolvedRule</var> be the result.</p>"
        },
        {
          "html": "<p>If <var>resolvedRule</var> is \"<code>skip transition</code>\", then return null.</p>"
        },
        {
          "html": "<p>Let <var>transition</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition\" id=\"ref-for-viewtransition①⑧\">ViewTransition</a></code> in <var>document</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\" id=\"ref-for-concept-relevant-realm③\">relevant Realm</a>,\nwhose <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition-named-elements\" id=\"ref-for-viewtransition-named-elements②\">named elements</a> is <var>inboundViewTransitionParams</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#view-transition-params-named-elements\" id=\"ref-for-view-transition-params-named-elements①\">named elements</a>,\nand <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition-initial-snapshot-containing-block-size\" id=\"ref-for-viewtransition-initial-snapshot-containing-block-size①\">initial snapshot containing block size</a> is <var>inboundViewTransitionParams</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#view-transition-params-initial-snapshot-containing-block-size\" id=\"ref-for-view-transition-params-initial-snapshot-containing-block-size①\">initial snapshot containing block size</a>.</p>"
        },
        {
          "html": "<p>Set <var>document</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#document-active-view-transition\" id=\"ref-for-document-active-view-transition①⑥\">active view transition</a> to <var>transition</var>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve\">Resolve</a> <var>transition</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition-update-callback-done-promise\" id=\"ref-for-viewtransition-update-callback-done-promise\">update callback done promise</a> with undefined.</p>"
        },
        {
          "html": "<p>Set <var>transition</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition-phase\" id=\"ref-for-viewtransition-phase②\">phase</a> to \"<code>update-callback-called</code>\".</p>"
        },
        {
          "html": "<p>Set <var>transition</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#viewtransition-active-types\" id=\"ref-for-viewtransition-active-types⑨\">active types</a> to <var>resolvedRule</var>.</p>"
        },
        {
          "html": "<p>Return <var>transition</var>.</p>"
        }
      ]
    },
    {
      "name": "additional capture steps",
      "html": "When capturing the old or new state for an element, perform the following steps given a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#captured-element\" id=\"ref-for-captured-element③\">captured element</a> <var>capture</var> and an <u class=\"link-error\" data-lt=\"element\" title=\"LINK ERROR: No 'dfn' refs found for 'element' with spec 'css22'.\">element</u> <var>element</var>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Set <var>capture</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#captured-element-class-list\" id=\"ref-for-captured-element-class-list①\">class list</a> to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-cascade-5/#computed-value\" id=\"ref-for-computed-value⑤\">computed value</a> of <var>element</var>’s <a class=\"property css\" data-link-type=\"property\" href=\"https://drafts.csswg.org/css-view-transitions-2/#propdef-view-transition-class\" id=\"ref-for-propdef-view-transition-class⑧\">view-transition-class</a>, if it is associated with <var>element</var>’s <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-node-document\" id=\"ref-for-concept-node-document④\">node document</a>.</p>"
        }
      ]
    },
    {
      "name": "resolve the document-scoped view-transition-group",
      "href": "https://drafts.csswg.org/css-view-transitions-2/#document-scoped-view-transition-group",
      "html": "To get the <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"document-scoped-view-transition-group\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">document-scoped view transition group</dfn> of an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#element\" id=\"ref-for-element\">Element</a></code> <var>element</var>, perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>computedGroup</var> be the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-cascade-5/#computed-value\" id=\"ref-for-computed-value⑥\">computed value</a> of element’s <a class=\"property css\" data-link-type=\"property\" href=\"https://drafts.csswg.org/css-view-transitions-2/#propdef-view-transition-group\" id=\"ref-for-propdef-view-transition-group⑦\">view-transition-group</a> property.</p>"
        },
        {
          "html": "<p>If <var>computedGroup</var> is associated with <var>element</var>’s <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-node-document\" id=\"ref-for-concept-node-document⑤\">node document</a>, return <var>computedGroup</var>.</p>"
        },
        {
          "html": "<p>Return <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-view-transitions-2/#valdef-view-transition-group-normal\" id=\"ref-for-valdef-view-transition-group-normal\">normal</a>.</p>"
        }
      ]
    },
    {
      "name": "resolve nearest containing group name",
      "href": "https://drafts.csswg.org/css-view-transitions-2/#nearest-containing-group-name",
      "html": "To resolve the <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"nearest-containing-group-name\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">nearest containing group name</dfn> of an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#element\" id=\"ref-for-element①\">Element</a></code> <var>element</var>, perform the following steps given a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition\" id=\"ref-for-viewtransition①⑨\">ViewTransition</a></code> <var>viewTransition</var>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p class=\"assertion\">Assert: <var>element</var> participates in <var>viewTransition</var>.</p>"
        },
        {
          "html": "<p>Let <var>ancestorGroup</var> be <var>element</var>’s nearest <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scoping-1/#flat-tree\" id=\"ref-for-flat-tree\">flat tree</a> <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-tree-ancestor\" id=\"ref-for-concept-tree-ancestor\">ancestor</a> who participates in <var>viewTransition</var> and whose <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#document-scoped-view-transition-group\" id=\"ref-for-document-scoped-view-transition-group\">document-scoped view transition group</a> is not <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-view-transitions-2/#valdef-view-transition-group-normal\" id=\"ref-for-valdef-view-transition-group-normal①\">normal</a>.</p>"
        },
        {
          "html": "<p>If <var>ancestorGroup</var> exists, return <var>ancestorGroup</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#document-scoped-view-transition-name\" id=\"ref-for-document-scoped-view-transition-name\">document-scoped view transition name</a>.</p>"
        },
        {
          "html": "<p>Return <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-view-transitions-1/#valdef-view-transition-name-none\" id=\"ref-for-valdef-view-transition-name-none①\">none</a>.</p>"
        }
      ]
    },
    {
      "name": "resolve used group name",
      "href": "https://drafts.csswg.org/css-view-transitions-2/#used-group-name",
      "html": "To resolve the <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"used-group-name\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">used group name</dfn> of an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#element\" id=\"ref-for-element②\">Element</a></code> <var>element</var>, perform the following steps given a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition\" id=\"ref-for-viewtransition②⓪\">ViewTransition</a></code> <var>transition</var>:\n\n\n   \n   <dl>\n    <dt data-md=\"\"><dfn class=\"dfn-paneled css has-dfn-panel\" data-dfn-for=\"view-transition-group\" data-dfn-type=\"value\" data-export=\"\" id=\"valdef-view-transition-group-normal\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">normal</dfn>\n    </dt><dt data-md=\"\"><dfn class=\"dfn-paneled css has-dfn-panel\" data-dfn-for=\"view-transition-group\" data-dfn-type=\"value\" data-export=\"\" id=\"valdef-view-transition-group-contain\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">contain</dfn>\n    </dt><dd data-md=\"\">\n     <p><var>containingGroupName</var>.</p>\n     \n    </dd><dt data-md=\"\"><dfn class=\"dfn-paneled css has-dfn-panel\" data-dfn-for=\"view-transition-group\" data-dfn-type=\"value\" data-export=\"\" id=\"valdef-view-transition-group-nearest\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">nearest</dfn>\n    </dt><dd data-md=\"\">\n     <p>The <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#document-scoped-view-transition-name\" id=\"ref-for-document-scoped-view-transition-name①\">document-scoped view transition name</a> of the element’s nearest <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scoping-1/#flat-tree\" id=\"ref-for-flat-tree①\">flat tree</a> ancestor which participates in the <var>transition</var>.</p>\n    </dd><dt data-md=\"\"><dfn class=\"dfn-paneled css has-dfn-panel\" data-dfn-for=\"view-transition-group\" data-dfn-type=\"value\" data-export=\"\" id=\"valdef-view-transition-group-custom-ident\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><a class=\"production css\" data-link-type=\"type\" href=\"https://drafts.csswg.org/css-values-4/#identifier-value\" id=\"ref-for-identifier-value①⑤\">&lt;custom-ident&gt;</a></dfn>\n    </dt><dd data-md=\"\">\n     <p><var>group</var> if the element has a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scoping-1/#flat-tree\" id=\"ref-for-flat-tree②\">flat tree</a> <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-tree-ancestor\" id=\"ref-for-concept-tree-ancestor①\">ancestor</a> whose <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#document-scoped-view-transition-name\" id=\"ref-for-document-scoped-view-transition-name②\">document-scoped view transition name</a> is <var>group</var> and participates in <var>transition</var>; Otherwise <var>containingGroupName</var>.</p>\n   </dd></dl>",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p class=\"assertion\">Assert: <var>element</var> participates in <var>transition</var>.</p>"
        },
        {
          "html": "<p>Let <var>group</var> be <var>element</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#document-scoped-view-transition-group\" id=\"ref-for-document-scoped-view-transition-group①\">document-scoped view transition group</a>.</p>"
        },
        {
          "html": "<p>Let <var>containingGroupName</var> be <var>element</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#nearest-containing-group-name\" id=\"ref-for-nearest-containing-group-name\">nearest containing group name</a> given <var>transition</var>.</p>"
        },
        {
          "html": "<p>Return the first matching statement, switching on <var>group</var>:</p>"
        }
      ]
    },
    {
      "name": "additional old capture steps (group)",
      "html": "When  <a href=\"https://drafts.csswg.org/css-view-transitions-1/#capture-old-state-algorithm\">capturing the old state for an element</a>, perform the following steps given a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#captured-element\" id=\"ref-for-captured-element④\">captured element</a> <var>capturedElement</var>, a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition\" id=\"ref-for-viewtransition②①\">ViewTransition</a></code> <var>transition</var>, and an <u class=\"link-error\" data-lt=\"element\" title=\"LINK ERROR: No 'dfn' refs found for 'element' with spec 'css22'.\">element</u> <var>element</var>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Set <var>capturedElement</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#captured-element-containing-group-name\" id=\"ref-for-captured-element-containing-group-name\">containing group name</a> to <var>element</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#used-group-name\" id=\"ref-for-used-group-name①\">used group name</a> given <var>transition</var>.</p>"
        },
        {
          "html": "<p>Set <var>capturedElement</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#captured-element-old-border-width\" id=\"ref-for-captured-element-old-border-width\">old border width</a> to <var>element</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-cascade-5/#used-value\" id=\"ref-for-used-value③\">used</a> <a class=\"property css\" data-link-type=\"property\" href=\"https://drafts.csswg.org/css-backgrounds-3/#propdef-border-width\" id=\"ref-for-propdef-border-width①\">border-width</a>.</p>"
        }
      ]
    },
    {
      "name": "additional new capture steps (group)",
      "html": "When <a href=\"https://drafts.csswg.org/css-view-transitions-1/#capture-new-state-algorithm\">capturing the new state for an element</a>, perform the following steps given a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#captured-element\" id=\"ref-for-captured-element⑤\">captured element</a> <var>capturedElement</var> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition\" id=\"ref-for-viewtransition②②\">ViewTransition</a></code> <var>transition</var>, and an <u class=\"link-error\" data-lt=\"element\" title=\"LINK ERROR: No 'dfn' refs found for 'element' with spec 'css22'.\">element</u> <var>element</var>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Set <var>capturedElement</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#captured-element-containing-group-name\" id=\"ref-for-captured-element-containing-group-name①\">containing group name</a> to <var>element</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#used-group-name\" id=\"ref-for-used-group-name②\">used group name</a> given <var>transition</var>.</p>"
        }
      ]
    },
    {
      "name": "additional pseudo-element setup steps (group)",
      "html": "When <a href=\"https://drafts.csswg.org/css-view-transitions-1/#setup-transition-pseudo-elements-algorithm\">setting up the transition pseudo-element</a> for a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#captured-element\" id=\"ref-for-captured-element⑥\">captured element</a> <var>capturedElement</var>, given a <var>transitionName</var> and a <var>transition</var>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>containingGroupName</var> be <var>capturedElement</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#captured-element-containing-group-name\" id=\"ref-for-captured-element-containing-group-name②\">containing group name</a>.</p>"
        },
        {
          "html": "<p>If <var>containingGroupName</var> is null, return.</p>"
        },
        {
          "html": "<p>Let <var>groupContainerElement</var> be <var>transition</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition-named-elements\" id=\"ref-for-viewtransition-named-elements③\">named elements</a>[<var>containingGroupName</var>].</p>"
        },
        {
          "html": "<p>Let <var>group</var> be the <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-view-transitions-1/#selectordef-view-transition-group\" id=\"ref-for-selectordef-view-transition-group⑨\">::view-transition-group()</a>,\nwhose <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#view-transition-name\" id=\"ref-for-view-transition-name\">view transition name</a> is set to <var>transitionName</var>.</p>"
        },
        {
          "html": "<p>Let <var>childrenContainerGroup</var> be the <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-view-transitions-2/#selectordef-view-transition-group-children\" id=\"ref-for-selectordef-view-transition-group-children④\">::view-transition-group-children()</a> whose <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#view-transition-name\" id=\"ref-for-view-transition-name①\">view transition name</a> is set to <var>containingGroupName</var>.</p>"
        },
        {
          "html": "<p>If <var>childrenContainerGroup</var> does not exist:\nGenerate it and append to the <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-view-transitions-1/#selectordef-view-transition-group\" id=\"ref-for-selectordef-view-transition-group①⓪\">::view-transition-group()</a>,\nwhose <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#view-transition-name\" id=\"ref-for-view-transition-name②\">view transition name</a> is set to <var>containingGroupName</var>.</p>"
        },
        {
          "html": "<p>Append <var>group</var> to <var>childrenContainerGroup</var>.</p>"
        },
        {
          "html": "<p>When setting the animation keyframes given <var>transform</var>, <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#adjust-nested-view-transition-group-transform\" id=\"ref-for-adjust-nested-view-transition-group-transform\">adjust</a> <var>transform</var> given <var>groupContainerElement</var>.</p>"
        }
      ]
    },
    {
      "name": "additional pseudo-element style update steps (group)",
      "href": "https://drafts.csswg.org/css-view-transitions-2/#adjust-nested-view-transition-group-transform",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"adjust-nested-view-transition-group-transform\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">adjust nested view transition group transform</dfn> given a <var>transform</var> and a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#captured-element\" id=\"ref-for-captured-element⑧\">captured element</a> <var>groupContainerElement</var>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>childrenTransform</var> be <var>transform</var>.</p>"
        },
        {
          "html": "<p>Set <var>capturedElement</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#captured-element-transform-from-snapshot-containing-block\" id=\"ref-for-captured-element-transform-from-snapshot-containing-block\">transform from snapshot containing block</a> to <var>transform</var>.</p>"
        },
        {
          "html": "If <var>capturedElement</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#captured-element-containing-group-name\" id=\"ref-for-captured-element-containing-group-name③\">containing group name</a> is not null, then:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>groupContainerElement</var> be <var>transition</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#viewtransition-named-elements\" id=\"ref-for-viewtransition-named-elements④\">named elements</a>[<var>capturedElement</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#captured-element-containing-group-name\" id=\"ref-for-captured-element-containing-group-name④\">containing group name</a>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#adjust-nested-view-transition-group-transform\" id=\"ref-for-adjust-nested-view-transition-group-transform①\">Adjust</a> <var>transform</var> given <var>groupContainerElement</var>.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "additional pseudo-element style update steps (group)",
      "href": "https://drafts.csswg.org/css-view-transitions-2/#adjust-nested-view-transition-group-transform",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"adjust-nested-view-transition-group-transform\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">adjust nested view transition group transform</dfn> given a <var>transform</var> and a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#captured-element\" id=\"ref-for-captured-element⑧\">captured element</a> <var>groupContainerElement</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>childrenTransform</var> be <var>groupContainerElement</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#captured-element-transform-from-snapshot-containing-block\" id=\"ref-for-captured-element-transform-from-snapshot-containing-block①\">transform from snapshot containing block</a>.</p>"
        },
        {
          "html": "<p>If <var>childrenTransform</var> is null, set it to <var>groupContainerElement</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-1/#captured-element-old-transform\" id=\"ref-for-captured-element-old-transform\">old transform</a>.</p>"
        },
        {
          "html": "<p>Translate <var>childrenTransform</var> by <var>groupContainerElement</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-view-transitions-2/#captured-element-old-border-width\" id=\"ref-for-captured-element-old-border-width①\">old border width</a>’s left and top components.</p>"
        },
        {
          "html": "<p>Multiply <var>transform</var> by the inverse matrix of <var>childrenTransform</var>.</p>"
        }
      ]
    }
  ]
}