{
  "spec": {
    "title": "WebXR Depth Sensing Module",
    "url": "https://immersive-web.github.io/depth-sensing/"
  },
  "algorithms": [
    {
      "name": "find-supported-configuration",
      "href": "https://immersive-web.github.io/depth-sensing/#find-supported-configuration-combination",
      "html": "In order to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"find-supported-configuration-combination\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">find supported configuration combination</dfn> for depth sensing API given <var>depthStateInit</var> dictionary, the user agent MUST run the following algorithm:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>depthTypeRequest</var> be the value contained by the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthstateinit-depthtyperequest\" id=\"ref-for-dom-xrdepthstateinit-depthtyperequest①\">depthTypeRequest</a></code> key in <var>depthStateInit</var> if it is set, and an empty sequence otherwise.</p>"
        },
        {
          "html": "<p>Let <var>selectedType</var> be <code>null</code></p>"
        },
        {
          "html": "<p>Let <var>usagePreference</var> be the value contained by the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthstateinit-usagepreference\" id=\"ref-for-dom-xrdepthstateinit-usagepreference①\">usagePreference</a></code> key in <var>depthStateInit</var></p>"
        },
        {
          "html": "<p>Let <var>selectedUsage</var> be <code>null</code>.</p>"
        },
        {
          "html": "<p>Let <var>dataFormatPreference</var> be the value contained by the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthstateinit-dataformatpreference\" id=\"ref-for-dom-xrdepthstateinit-dataformatpreference①\">dataFormatPreference</a></code> key in <var>depthStateInit</var></p>"
        },
        {
          "html": "<p>Let <var>selectedDataFormat</var> be <code>null</code>.</p>"
        },
        {
          "html": "<p>Let <var>processingOrder</var> be the sequence of (preferences, selection) pairs, where selection is a reference to one of the variables introduced in the previous steps: [(<var>depthTypeRequest</var>, <var>selectedType</var>), (<var>usagePreference</var>,<var>selectedUsage</var>),(<var>dataFormatPreference</var>,<var>selectedDataFormat</var>)]</p>"
        },
        {
          "html": "For each (<var>preferences</var>, <var>selection</var>) in <var>processingOrder</var> perform the following steps",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>preferences</var> contains only a single value, set <var>selection</var> to that value.</p>"
            }
          ]
        },
        {
          "html": "For each (<var>preferences</var>, <var>selection</var>) in <var>processingOrder</var> perform the following steps:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>selection</var> is not <code>null</code>, continue to the next entry.</p>"
            },
            {
              "html": "<p>If the <var>preferences</var> sequence is empty, continue to the next entry.</p>"
            },
            {
              "html": "<p>For each <var>preference</var> in <var>preferences</var>, preform the following steps:</p>"
            },
            {
              "html": "<p>If <var>preference</var> with the other values of <var>selectedType</var>,<var>selectedUsage</var>,<var>selectedDataFormat</var> is not considered a <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#support-the-depth-sensing-configuration\" id=\"ref-for-support-the-depth-sensing-configuration\">supported depth sensing configuration</a> by the <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#native-depth-sensing\" id=\"ref-for-native-depth-sensing①\">native depth sensing</a> capabilities of the device, continue to the next entry.</p>"
            },
            {
              "html": "<p>Set <var>selection</var> to <var>preference</var> and abort these nested steps.</p>"
            }
          ]
        },
        {
          "html": "For each (<var>preferences</var>, <var>selection</var>) in <var>processingOrder</var> perform the following steps:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>selection</var> is not <code>null</code>, continue to the next entry.</p>"
            },
            {
              "html": "<p>Set <var>selection</var> to the value determined by the <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#preferred-native-depth-sensing-capability\" id=\"ref-for-preferred-native-depth-sensing-capability\">preferred native depth sensing capability</a> with the other values of <var>selectedType</var>,<var>selectedUsage</var>,<var>selectedDataFormat</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>If any of <var>selectedType</var>,<var>selectedUsage</var>,<var>selectedDataFormat</var> are <code>null</code>, return <code>null</code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <var>selectedType</var>,<var>selectedUsage</var>,<var>selectedDataFormat</var> is considered a <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#support-the-depth-sensing-configuration\" id=\"ref-for-support-the-depth-sensing-configuration①\">supported depth sensing configuration</a> by the <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#native-depth-sensing\" id=\"ref-for-native-depth-sensing②\">native depth sensing</a> capabilities of the device return the <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#depth-sensing-configuration\" id=\"ref-for-depth-sensing-configuration\">depth sensing configuration</a> of <var>selectedType</var>,<var>selectedUsage</var>,<var>selectedDataFormat</var> and abort these steps.</p>"
        },
        {
          "html": "<p>If <var>depthTypeRequest</var> is not an empty list, set it to an empty list and repeat these steps.</p>"
        },
        {
          "html": "<p>Return <code>null</code> and abort these steps.</p>"
        }
      ]
    },
    {
      "name": "start-depth-sensing",
      "href": "https://immersive-web.github.io/depth-sensing/#xrdepthinformation",
      "html": "When <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrsession-pausedepthsensing\" id=\"ref-for-dom-xrsession-pausedepthsensing\">pauseDepthSensing()</a></code> is invoked on an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#xrsession-interface\" id=\"ref-for-xrsession-interface④\">XRSession</a></code> <var>session</var>, the User Agent MUST run the following steps: \n     \n     <h2 class=\"heading settled\" data-level=\"3\" id=\"obtaining-data\"><span class=\"secno\">3. </span><span class=\"content\">Obtaining depth data</span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#obtaining-data\"></a></h2>\n     <h3 class=\"heading settled\" data-level=\"3.1\" id=\"xr-depth-info-section\"><span class=\"secno\">3.1. </span><span class=\"content\">XRDepthInformation</span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#xr-depth-info-section\"></a></h3>\n<pre class=\"idl highlight def\">[<a class=\"idl-code\" data-link-type=\"extended-attribute\" href=\"https://webidl.spec.whatwg.org/#SecureContext\" id=\"ref-for-SecureContext\"><c- g=\"\">SecureContext</c-></a>, <a class=\"idl-code\" data-link-type=\"extended-attribute\" href=\"https://webidl.spec.whatwg.org/#Exposed\" id=\"ref-for-Exposed\"><c- g=\"\">Exposed</c-></a>=<c- n=\"\">Window</c->]\n<c- b=\"\">interface</c-> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-type=\"interface\" data-export=\"\" id=\"xrdepthinformation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">XRDepthInformation</c-></code></dfn> {\n  <c- b=\"\">readonly</c-> <c- b=\"\">attribute</c-> <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-unsigned-long\" id=\"ref-for-idl-unsigned-long\"><c- b=\"\">unsigned</c-> <c- b=\"\">long</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRDepthInformation\" data-dfn-type=\"attribute\" data-export=\"\" data-readonly=\"\" data-type=\"unsigned long\" id=\"dom-xrdepthinformation-width\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">width</c-></code></dfn>;\n  <c- b=\"\">readonly</c-> <c- b=\"\">attribute</c-> <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-unsigned-long\" id=\"ref-for-idl-unsigned-long①\"><c- b=\"\">unsigned</c-> <c- b=\"\">long</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRDepthInformation\" data-dfn-type=\"attribute\" data-export=\"\" data-readonly=\"\" data-type=\"unsigned long\" id=\"dom-xrdepthinformation-height\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">height</c-></code></dfn>;\n\n  [<a class=\"idl-code\" data-link-type=\"extended-attribute\" href=\"https://webidl.spec.whatwg.org/#SameObject\" id=\"ref-for-SameObject\"><c- g=\"\">SameObject</c-></a>] <c- b=\"\">readonly</c-> <c- b=\"\">attribute</c-> <a data-link-type=\"idl-name\" href=\"https://immersive-web.github.io/webxr/#xrrigidtransform\" id=\"ref-for-xrrigidtransform\"><c- n=\"\">XRRigidTransform</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRDepthInformation\" data-dfn-type=\"attribute\" data-export=\"\" data-readonly=\"\" data-type=\"XRRigidTransform\" id=\"dom-xrdepthinformation-normdepthbufferfromnormview\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">normDepthBufferFromNormView</c-></code></dfn>;\n  <c- b=\"\">readonly</c-> <c- b=\"\">attribute</c-> <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-float\" id=\"ref-for-idl-float\"><c- b=\"\">float</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRDepthInformation\" data-dfn-type=\"attribute\" data-export=\"\" data-readonly=\"\" data-type=\"float\" id=\"dom-xrdepthinformation-rawvaluetometers\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">rawValueToMeters</c-></code></dfn>;\n};\n\n<a data-link-type=\"idl-name\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation①\"><c- n=\"\">XRDepthInformation</c-></a> <c- b=\"\">includes</c-> <a data-link-type=\"idl-name\" href=\"https://www.w3.org/TR/webxr/#xrviewgeometry-mixin\" id=\"ref-for-xrviewgeometry-mixin\"><c- n=\"\">XRViewGeometry</c-></a>;\n</pre>\n     <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-width\" id=\"ref-for-dom-xrdepthinformation-width\">width</a></code> attribute contains width of the <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-depth-buffer\" id=\"ref-for-xrdepthinformation-depth-buffer\">depth buffer</a> (i.e. number of columns).</p>\n     <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-height\" id=\"ref-for-dom-xrdepthinformation-height\">height</a></code> attribute contains height of the <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-depth-buffer\" id=\"ref-for-xrdepthinformation-depth-buffer①\">depth buffer</a> (i.e. number of rows).</p>\n     <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-normdepthbufferfromnormview\" id=\"ref-for-dom-xrdepthinformation-normdepthbufferfromnormview\">normDepthBufferFromNormView</a></code> attribute contains a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#xrrigidtransform\" id=\"ref-for-xrrigidtransform①\">XRRigidTransform</a></code> that needs to be applied when indexing into the <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-depth-buffer\" id=\"ref-for-xrdepthinformation-depth-buffer②\">depth buffer</a>. The transformation that the matrix represents changes the coordinate system from normalized view coordinates to normalized depth buffer coordinates that can then be scaled by depth buffer’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-width\" id=\"ref-for-dom-xrdepthinformation-width①\">width</a></code> and <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-height\" id=\"ref-for-dom-xrdepthinformation-height①\">height</a></code> to obtain the absolute depth buffer coordinates.</p>\n     \n     <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-rawvaluetometers\" id=\"ref-for-dom-xrdepthinformation-rawvaluetometers\">rawValueToMeters</a></code> attribute contains the scale factor by which the raw depth values from a <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-depth-buffer\" id=\"ref-for-xrdepthinformation-depth-buffer③\">depth buffer</a> must be multiplied in order to get the depth in meters.</p>\n     <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#dom-xrviewgeometry-transform\" id=\"ref-for-dom-xrviewgeometry-transform\">transform</a></code> is given in the associated <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-view\" id=\"ref-for-xrdepthinformation-view②\">view</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#view-reference-space\" id=\"ref-for-view-reference-space\">reference space</a>.</p>\n     <p>If the <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-sensor\" id=\"ref-for-xrdepthinformation-sensor\">sensor</a> is aligned with the associated <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-view\" id=\"ref-for-xrdepthinformation-view③\">view</a>, then all values included from <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#xrviewgeometry-mixin\" id=\"ref-for-xrviewgeometry-mixin①\">XRViewGeometry</a></code> MUST return the same values as the associated <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-view\" id=\"ref-for-xrdepthinformation-view④\">view</a> does.</p>\n     <p>Each <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation②\">XRDepthInformation</a></code> has an associated <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"XRDepthInformation\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"xrdepthinformation-view\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">view</dfn> which is the closest <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#xrview\" id=\"ref-for-xrview①\">XRView</a></code> to the <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-sensor\" id=\"ref-for-xrdepthinformation-sensor①\">sensor</a>, and is used to retrieve the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation③\">XRDepthInformation</a></code>.</p>\n     <p>Each <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation④\">XRDepthInformation</a></code> has an associated <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"XRDepthInformation\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"xrdepthinformation-sensor\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">sensor</dfn> that is the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#view-geometry-containing-object\" id=\"ref-for-view-geometry-containing-object\">containing object</a> for the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#xrviewgeometry-mixin\" id=\"ref-for-xrviewgeometry-mixin②\">XRViewGeometry</a></code> from which the depth information was obtained.</p>\n     <p>Each <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation⑤\">XRDepthInformation</a></code> has an associated <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"XRDepthInformation\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"xrdepthinformation-depth-buffer\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">depth buffer</dfn> that contains depth buffer data. Different <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation⑥\">XRDepthInformation</a></code>s may store objects of different concrete types in the depth buffer.</p>\n     <div class=\"algorithm\" data-algorithm=\"accessing-depth-buffer-members\">\n      <p>When <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"attempting-to-access-the-depth-buffer\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">attempting to access the depth buffer</dfn> of <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation⑦\">XRDepthInformation</a></code> or any interface that inherits from it, the user agent MUST run the following steps:</p>\n      \n     </div>\n     <h3 class=\"heading settled\" data-level=\"3.2\" id=\"xr-cpu-depth-info-section\"><span class=\"secno\">3.2. </span><span class=\"content\">XRCPUDepthInformation</span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#xr-cpu-depth-info-section\"></a></h3>\n<pre class=\"idl highlight def\">[<a class=\"idl-code\" data-link-type=\"extended-attribute\" href=\"https://webidl.spec.whatwg.org/#Exposed\" id=\"ref-for-Exposed①\"><c- g=\"\">Exposed</c-></a>=<c- n=\"\">Window</c->]\n<c- b=\"\">interface</c-> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-type=\"interface\" data-export=\"\" id=\"xrcpudepthinformation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">XRCPUDepthInformation</c-></code></dfn> : <a data-link-type=\"idl-name\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation⑧\"><c- n=\"\">XRDepthInformation</c-></a> {\n  [<a class=\"idl-code\" data-link-type=\"extended-attribute\" href=\"https://webidl.spec.whatwg.org/#SameObject\" id=\"ref-for-SameObject①\"><c- g=\"\">SameObject</c-></a>] <c- b=\"\">readonly</c-> <c- b=\"\">attribute</c-> <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\" id=\"ref-for-idl-ArrayBuffer\"><c- b=\"\">ArrayBuffer</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRCPUDepthInformation\" data-dfn-type=\"attribute\" data-export=\"\" data-readonly=\"\" data-type=\"ArrayBuffer\" id=\"dom-xrcpudepthinformation-data\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">data</c-></code></dfn>;\n\n  <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-float\" id=\"ref-for-idl-float①\"><c- b=\"\">float</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRCPUDepthInformation\" data-dfn-type=\"method\" data-export=\"\" data-lt=\"getDepthInMeters(x, y)\" id=\"dom-xrcpudepthinformation-getdepthinmeters\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">getDepthInMeters</c-></code></dfn>(<a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-float\" id=\"ref-for-idl-float②\"><c- b=\"\">float</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRCPUDepthInformation/getDepthInMeters(x, y)\" data-dfn-type=\"argument\" data-export=\"\" id=\"dom-xrcpudepthinformation-getdepthinmeters-x-y-x\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">x</c-></code></dfn>, <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-float\" id=\"ref-for-idl-float③\"><c- b=\"\">float</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRCPUDepthInformation/getDepthInMeters(x, y)\" data-dfn-type=\"argument\" data-export=\"\" id=\"dom-xrcpudepthinformation-getdepthinmeters-x-y-y\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">y</c-></code></dfn>);\n};\n</pre>\n     <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrcpudepthinformation-data\" id=\"ref-for-dom-xrcpudepthinformation-data④\">data</a></code> attribute contains depth buffer information in raw format, suitable for uploading to a WebGL texture if needed. The data is stored in row-major format, without padding, with each entry corresponding to distance from the <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-sensor\" id=\"ref-for-xrdepthinformation-sensor②\">sensor</a>’s near plane to the users' environment, in unspecified units. The size of each data entry and the type is determined by <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrsession-depthdataformat\" id=\"ref-for-dom-xrsession-depthdataformat②\">depthDataFormat</a></code>. The values can be converted from unspecified units to meters by multiplying them by <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-rawvaluetometers\" id=\"ref-for-dom-xrdepthinformation-rawvaluetometers①\">rawValueToMeters</a></code>. The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-normdepthbufferfromnormview\" id=\"ref-for-dom-xrdepthinformation-normdepthbufferfromnormview①\">normDepthBufferFromNormView</a></code> can be used to transform from <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#normalized-view-coordinates\" id=\"ref-for-normalized-view-coordinates①\">normalized view coordinates</a> into depth buffer’s coordinate system. When accessed, the algorithm to <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#attempting-to-access-the-depth-buffer\" id=\"ref-for-attempting-to-access-the-depth-buffer\">access the depth buffer</a> MUST be run.</p>\n     \n     <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrcpudepthinformation-getdepthinmeters\" id=\"ref-for-dom-xrcpudepthinformation-getdepthinmeters①\">getDepthInMeters(x, y)</a></code> method can be used to <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#obtain-depth-at-coordinates\" id=\"ref-for-obtain-depth-at-coordinates\">obtain depth at coordinates</a>. When invoked, the algorithm to <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#attempting-to-access-the-depth-buffer\" id=\"ref-for-attempting-to-access-the-depth-buffer①\">access the depth buffer</a> MUST be run.</p>\n     <div class=\"algorithm\" data-algorithm=\"obtain-depth-at-coordinates\">\n      <p>When <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrcpudepthinformation-getdepthinmeters\" id=\"ref-for-dom-xrcpudepthinformation-getdepthinmeters②\">getDepthInMeters(x, y)</a></code> method is invoked on an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#xrcpudepthinformation\" id=\"ref-for-xrcpudepthinformation①\">XRCPUDepthInformation</a></code> <var>depthInformation</var> with <var>x</var>, <var>y</var>, the user agent MUST <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"obtain-depth-at-coordinates\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">obtain depth at coordinates</dfn> by running the following steps:</p>\n      \n     </div>\n<pre class=\"idl highlight def\"><c- b=\"\">partial</c-> <c- b=\"\">interface</c-> <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://www.w3.org/TR/webxr/#xrframe-interface\" id=\"ref-for-xrframe-interface\"><c- g=\"\">XRFrame</c-></a> {\n  <a data-link-type=\"idl-name\" href=\"https://immersive-web.github.io/depth-sensing/#xrcpudepthinformation\" id=\"ref-for-xrcpudepthinformation②\"><c- n=\"\">XRCPUDepthInformation</c-></a>? <a class=\"idl-code\" data-link-type=\"method\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrframe-getdepthinformation\" id=\"ref-for-dom-xrframe-getdepthinformation\"><c- g=\"\">getDepthInformation</c-></a>(<a data-link-type=\"idl-name\" href=\"https://immersive-web.github.io/webxr/#xrview\" id=\"ref-for-xrview②\"><c- n=\"\">XRView</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRFrame/getDepthInformation(view)\" data-dfn-type=\"argument\" data-export=\"\" id=\"dom-xrframe-getdepthinformation-view-view\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">view</c-></code></dfn>);\n};\n</pre>\n     <p>The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRFrame\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-xrframe-getdepthinformation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>getDepthInformation(view)</code></dfn> method, when invoked on an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#xrframe-interface\" id=\"ref-for-xrframe-interface①\">XRFrame</a></code>, signals that the application wants to <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#obtain-cpu-depth-information\" id=\"ref-for-obtain-cpu-depth-information\">obtain CPU depth information</a> relevant for the frame.</p>\n     <div class=\"algorithm\" data-algorithm=\"obtain-depth-information\">\n      <p>When <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrframe-getdepthinformation\" id=\"ref-for-dom-xrframe-getdepthinformation①\">getDepthInformation(view)</a></code> method is invoked on an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#xrframe-interface\" id=\"ref-for-xrframe-interface②\">XRFrame</a></code> <var>frame</var> with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#xrview\" id=\"ref-for-xrview③\">XRView</a></code> <var>view</var>, the user agent MUST <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"obtain-cpu-depth-information\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">obtain CPU depth information</dfn> by running the following steps:</p>\n      \n     </div>\n     <div class=\"algorithm\" data-algorithm=\"create-cpu-depth-information\">\n      <p>In order to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"create-a-cpu-depth-information-instance\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">create a CPU depth information instance</dfn> given <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#xrframe-interface\" id=\"ref-for-xrframe-interface③\">XRFrame</a></code> <var>frame</var> and <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#xrview\" id=\"ref-for-xrview④\">XRView</a></code> <var>view</var>, the user agent MUST run the following steps:</p>\n      \n     </div>\n     \n     <h3 class=\"heading settled\" data-level=\"3.3\" id=\"xr-gpu-depth-info-section\"><span class=\"secno\">3.3. </span><span class=\"content\">XRWebGLDepthInformation</span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#xr-gpu-depth-info-section\"></a></h3>\n<pre class=\"idl highlight def\">[<a class=\"idl-code\" data-link-type=\"extended-attribute\" href=\"https://webidl.spec.whatwg.org/#Exposed\" id=\"ref-for-Exposed②\"><c- g=\"\">Exposed</c-></a>=<c- n=\"\">Window</c->]\n<c- b=\"\">interface</c-> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-type=\"interface\" data-export=\"\" id=\"xrwebgldepthinformation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">XRWebGLDepthInformation</c-></code></dfn> : <a data-link-type=\"idl-name\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation⑨\"><c- n=\"\">XRDepthInformation</c-></a> {\n  [<a class=\"idl-code\" data-link-type=\"extended-attribute\" href=\"https://webidl.spec.whatwg.org/#SameObject\" id=\"ref-for-SameObject②\"><c- g=\"\">SameObject</c-></a>] <c- b=\"\">readonly</c-> <c- b=\"\">attribute</c-> <a data-link-type=\"idl-name\" href=\"https://www.khronos.org/registry/webgl/specs/latest/1.0/#5.9\" id=\"ref-for-5.9\"><c- n=\"\">WebGLTexture</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRWebGLDepthInformation\" data-dfn-type=\"attribute\" data-export=\"\" data-readonly=\"\" data-type=\"WebGLTexture\" id=\"dom-xrwebgldepthinformation-texture\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">texture</c-></code></dfn>;\n\n  <c- b=\"\">readonly</c-> <c- b=\"\">attribute</c-> <a data-link-type=\"idl-name\" href=\"https://immersive-web.github.io/layers/#enumdef-xrtexturetype\" id=\"ref-for-enumdef-xrtexturetype\"><c- n=\"\">XRTextureType</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRWebGLDepthInformation\" data-dfn-type=\"attribute\" data-export=\"\" data-readonly=\"\" data-type=\"XRTextureType\" id=\"dom-xrwebgldepthinformation-texturetype\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">textureType</c-></code></dfn>;\n  <c- b=\"\">readonly</c-> <c- b=\"\">attribute</c-> <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-unsigned-long\" id=\"ref-for-idl-unsigned-long②\"><c- b=\"\">unsigned</c-> <c- b=\"\">long</c-></a>? <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRWebGLDepthInformation\" data-dfn-type=\"attribute\" data-export=\"\" data-readonly=\"\" data-type=\"unsigned long?\" id=\"dom-xrwebgldepthinformation-imageindex\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">imageIndex</c-></code></dfn>;\n};\n</pre>\n     <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrwebgldepthinformation-texture\" id=\"ref-for-dom-xrwebgldepthinformation-texture①\">texture</a></code> attribute contains depth buffer information as an <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxrlayers-1/#opaque-texture\" id=\"ref-for-opaque-texture\">opaque texture</a>. Each texel corresponds to distance from the <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-sensor\" id=\"ref-for-xrdepthinformation-sensor④\">sensor</a>’s near plane to the users' environment, in unspecified units. The size of each data entry and the type is determined by <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrsession-depthdataformat\" id=\"ref-for-dom-xrsession-depthdataformat⑤\">depthDataFormat</a></code>. The values can be converted from unspecified units to meters by multiplying them by <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-rawvaluetometers\" id=\"ref-for-dom-xrdepthinformation-rawvaluetometers③\">rawValueToMeters</a></code>. The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-normdepthbufferfromnormview\" id=\"ref-for-dom-xrdepthinformation-normdepthbufferfromnormview④\">normDepthBufferFromNormView</a></code> can be used to transform from <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#normalized-view-coordinates\" id=\"ref-for-normalized-view-coordinates②\">normalized view coordinates</a> into depth buffer’s coordinate system. When accessed, the algorithm to <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#attempting-to-access-the-depth-buffer\" id=\"ref-for-attempting-to-access-the-depth-buffer②\">access the depth buffer</a> of <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation①⓪\">XRDepthInformation</a></code> MUST be run.</p>\n     <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrwebgldepthinformation-texturetype\" id=\"ref-for-dom-xrwebgldepthinformation-texturetype\">textureType</a></code> attribute describes if the texture is of type <code class=\"idl\"><a data-link-type=\"idl\" data-refhint-key=\"65e2856a\" href=\"https://www.khronos.org/registry/webgl/specs/latest/1.0/#5.14\" id=\"ref-for-5.14①\">TEXTURE_2D</a></code> or <code class=\"idl\"><a data-link-type=\"idl\" data-refhint-key=\"277d52e5\" href=\"https://www.khronos.org/registry/webgl/specs/latest/2.0/#3.7\" id=\"ref-for-3.7②\">TEXTURE_2D_ARRAY</a></code>.</p>\n     <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrwebgldepthinformation-imageindex\" id=\"ref-for-dom-xrwebgldepthinformation-imageindex\">imageIndex</a></code> attribute returns the offset into the texture array. It MUST be defined when <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrwebgldepthinformation-texturetype\" id=\"ref-for-dom-xrwebgldepthinformation-texturetype①\">textureType</a></code> is equal to <code class=\"idl\"><a data-link-type=\"idl\" data-refhint-key=\"277d52e5\" href=\"https://www.khronos.org/registry/webgl/specs/latest/2.0/#3.7\" id=\"ref-for-3.7③\">TEXTURE_2D_ARRAY</a></code> and MUST be undefined if it’s <code class=\"idl\"><a data-link-type=\"idl\" data-refhint-key=\"65e2856a\" href=\"https://www.khronos.org/registry/webgl/specs/latest/1.0/#5.14\" id=\"ref-for-5.14②\">TEXTURE_2D</a></code>.</p>\n<pre class=\"idl highlight def\"><c- b=\"\">partial</c-> <c- b=\"\">interface</c-> <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://immersive-web.github.io/layers/#xrwebglbinding\" id=\"ref-for-xrwebglbinding\"><c- g=\"\">XRWebGLBinding</c-></a> {\n  <a data-link-type=\"idl-name\" href=\"https://immersive-web.github.io/depth-sensing/#xrwebgldepthinformation\" id=\"ref-for-xrwebgldepthinformation①\"><c- n=\"\">XRWebGLDepthInformation</c-></a>? <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRWebGLBinding\" data-dfn-type=\"method\" data-export=\"\" data-lt=\"getDepthInformation(view)\" id=\"dom-xrwebglbinding-getdepthinformation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">getDepthInformation</c-></code></dfn>(<a data-link-type=\"idl-name\" href=\"https://immersive-web.github.io/webxr/#xrview\" id=\"ref-for-xrview⑤\"><c- n=\"\">XRView</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRWebGLBinding/getDepthInformation(view)\" data-dfn-type=\"argument\" data-export=\"\" id=\"dom-xrwebglbinding-getdepthinformation-view-view\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">view</c-></code></dfn>);\n};\n</pre>\n     <p>The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRWebGLDepthInformation\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-xrwebgldepthinformation-getdepthinformation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>getDepthInformation(view)</code></dfn> method, when invoked on an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/layers/#xrwebglbinding\" id=\"ref-for-xrwebglbinding①\">XRWebGLBinding</a></code>, signals that the application wants to <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#obtain-webgl-depth-information\" id=\"ref-for-obtain-webgl-depth-information\">obtain WebGL depth information</a> relevant for the frame.</p>\n     <div class=\"algorithm\" data-algorithm=\"obtain-webgl-depth-information\">\n      <p>When <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrwebglbinding-getdepthinformation\" id=\"ref-for-dom-xrwebglbinding-getdepthinformation\">getDepthInformation(view)</a></code> method is invoked on a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/layers/#xrwebglbinding\" id=\"ref-for-xrwebglbinding②\">XRWebGLBinding</a></code> <var>binding</var> with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#xrview\" id=\"ref-for-xrview⑥\">XRView</a></code> <var>view</var>, the user agent MUST <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"obtain-webgl-depth-information\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">obtain WebGL depth information</dfn> by running the following steps:</p>\n      \n     </div>\n     <div class=\"algorithm\" data-algorithm=\"create-webgl-depth-information\">\n      <p>In order to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"create-a-webgl-depth-information-instance\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">create a WebGL depth information instance</dfn> given <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#xrframe-interface\" id=\"ref-for-xrframe-interface④\">XRFrame</a></code> <var>frame</var> and <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#xrview\" id=\"ref-for-xrview⑦\">XRView</a></code> <var>view</var>, the user agent MUST run the following steps:</p>\n      \n     </div>\n     \n     <h2 class=\"heading settled\" data-level=\"4\" id=\"results-interpretation\"><span class=\"secno\">4. </span><span class=\"content\">Interpreting the results</span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#results-interpretation\"></a></h2>\n     <p>If a given pixel is determined to have <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"invalid-depth-data\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">invalid depth data</dfn> or the depth data cannot otherwise be determined, the user agent MUST return a depth value of 0.</p>\n     \n     <h2 class=\"heading settled\" data-level=\"5\" id=\"native-device-concepts\"><span class=\"secno\">5. </span><span class=\"content\">Native device concepts</span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#native-device-concepts\"></a></h2>\n     <h3 class=\"heading settled\" data-level=\"5.1\" id=\"native-depth-sensing-section\"><span class=\"secno\">5.1. </span><span class=\"content\">Native depth sensing</span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#native-depth-sensing-section\"></a></h3>\n     \n     <h2 class=\"heading settled\" data-level=\"6\" id=\"privacy-security\"><span class=\"secno\">6. </span><span class=\"content\">Privacy &amp; Security Considerations</span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#privacy-security\"></a></h2>\n     \n     <h2 class=\"no-num heading settled\" id=\"changes\"><span class=\"content\"> Changes</span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#changes\"></a></h2>\n     <h3 class=\"no-num heading settled\" id=\"changes-from-20210831\"><span class=\"content\"> Changes from the <a href=\"https://www.w3.org/TR/2021/WD-webxr-depth-sensing-1-20210831/\">First Public Working Draft 31 August 2021</a></span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#changes-from-20210831\"></a></h3>\n     <h2 class=\"heading settled\" data-level=\"7\" id=\"ack\"><span class=\"secno\">7. </span><span class=\"content\">Acknowledgements</span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#ack\"></a></h2>\n     <p>The following individuals have contributed to the design of the WebXR Depth Sensing specification:</p>",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <var>session</var>’s <a data-link-type=\"dfn\">ended</a> value is <code>true</code>, throw an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror④\">InvalidStateError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>Let <var>frame</var> be <var>session</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrsession-animation-frame\" id=\"ref-for-xrsession-animation-frame\">animation frame</a>.</p>"
        },
        {
          "html": "<p>If <var>frame</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrframe-active\" id=\"ref-for-xrframe-active\">active</a> boolean is <code>false</code>, throw an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror⑤\">InvalidStateError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#depth-sensing\" id=\"ref-for-depth-sensing①\">depth-sensing</a> feature descriptor is not <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-contain\" id=\"ref-for-list-contain\">contained</a> in the <var>session</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrsession-xr-device\" id=\"ref-for-xrsession-xr-device\">XR device</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#dom-xrsession-enabledfeatures\" id=\"ref-for-dom-xrsession-enabledfeatures\">list of enabled features</a> for <var>session</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrsession-mode\" id=\"ref-for-xrsession-mode\">mode</a>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw\">throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\" id=\"ref-for-notsupportederror②\">NotSupportedError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#depth-sensing-active-state\" id=\"ref-for-depth-sensing-active-state①\">depth sensing active state</a> is <code>true</code>, abort these steps.</p>"
        },
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#depth-sensing-active-state\" id=\"ref-for-depth-sensing-active-state②\">depth sensing active state</a> to <code>true</code>.</p>"
        }
      ]
    },
    {
      "name": "start-depth-sensing",
      "href": "https://immersive-web.github.io/depth-sensing/#xrdepthinformation",
      "html": "When <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrsession-pausedepthsensing\" id=\"ref-for-dom-xrsession-pausedepthsensing\">pauseDepthSensing()</a></code> is invoked on an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#xrsession-interface\" id=\"ref-for-xrsession-interface④\">XRSession</a></code> <var>session</var>, the User Agent MUST run the following steps: \n     \n     <h2 class=\"heading settled\" data-level=\"3\" id=\"obtaining-data\"><span class=\"secno\">3. </span><span class=\"content\">Obtaining depth data</span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#obtaining-data\"></a></h2>\n     <h3 class=\"heading settled\" data-level=\"3.1\" id=\"xr-depth-info-section\"><span class=\"secno\">3.1. </span><span class=\"content\">XRDepthInformation</span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#xr-depth-info-section\"></a></h3>\n<pre class=\"idl highlight def\">[<a class=\"idl-code\" data-link-type=\"extended-attribute\" href=\"https://webidl.spec.whatwg.org/#SecureContext\" id=\"ref-for-SecureContext\"><c- g=\"\">SecureContext</c-></a>, <a class=\"idl-code\" data-link-type=\"extended-attribute\" href=\"https://webidl.spec.whatwg.org/#Exposed\" id=\"ref-for-Exposed\"><c- g=\"\">Exposed</c-></a>=<c- n=\"\">Window</c->]\n<c- b=\"\">interface</c-> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-type=\"interface\" data-export=\"\" id=\"xrdepthinformation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">XRDepthInformation</c-></code></dfn> {\n  <c- b=\"\">readonly</c-> <c- b=\"\">attribute</c-> <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-unsigned-long\" id=\"ref-for-idl-unsigned-long\"><c- b=\"\">unsigned</c-> <c- b=\"\">long</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRDepthInformation\" data-dfn-type=\"attribute\" data-export=\"\" data-readonly=\"\" data-type=\"unsigned long\" id=\"dom-xrdepthinformation-width\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">width</c-></code></dfn>;\n  <c- b=\"\">readonly</c-> <c- b=\"\">attribute</c-> <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-unsigned-long\" id=\"ref-for-idl-unsigned-long①\"><c- b=\"\">unsigned</c-> <c- b=\"\">long</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRDepthInformation\" data-dfn-type=\"attribute\" data-export=\"\" data-readonly=\"\" data-type=\"unsigned long\" id=\"dom-xrdepthinformation-height\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">height</c-></code></dfn>;\n\n  [<a class=\"idl-code\" data-link-type=\"extended-attribute\" href=\"https://webidl.spec.whatwg.org/#SameObject\" id=\"ref-for-SameObject\"><c- g=\"\">SameObject</c-></a>] <c- b=\"\">readonly</c-> <c- b=\"\">attribute</c-> <a data-link-type=\"idl-name\" href=\"https://immersive-web.github.io/webxr/#xrrigidtransform\" id=\"ref-for-xrrigidtransform\"><c- n=\"\">XRRigidTransform</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRDepthInformation\" data-dfn-type=\"attribute\" data-export=\"\" data-readonly=\"\" data-type=\"XRRigidTransform\" id=\"dom-xrdepthinformation-normdepthbufferfromnormview\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">normDepthBufferFromNormView</c-></code></dfn>;\n  <c- b=\"\">readonly</c-> <c- b=\"\">attribute</c-> <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-float\" id=\"ref-for-idl-float\"><c- b=\"\">float</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRDepthInformation\" data-dfn-type=\"attribute\" data-export=\"\" data-readonly=\"\" data-type=\"float\" id=\"dom-xrdepthinformation-rawvaluetometers\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">rawValueToMeters</c-></code></dfn>;\n};\n\n<a data-link-type=\"idl-name\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation①\"><c- n=\"\">XRDepthInformation</c-></a> <c- b=\"\">includes</c-> <a data-link-type=\"idl-name\" href=\"https://www.w3.org/TR/webxr/#xrviewgeometry-mixin\" id=\"ref-for-xrviewgeometry-mixin\"><c- n=\"\">XRViewGeometry</c-></a>;\n</pre>\n     <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-width\" id=\"ref-for-dom-xrdepthinformation-width\">width</a></code> attribute contains width of the <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-depth-buffer\" id=\"ref-for-xrdepthinformation-depth-buffer\">depth buffer</a> (i.e. number of columns).</p>\n     <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-height\" id=\"ref-for-dom-xrdepthinformation-height\">height</a></code> attribute contains height of the <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-depth-buffer\" id=\"ref-for-xrdepthinformation-depth-buffer①\">depth buffer</a> (i.e. number of rows).</p>\n     <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-normdepthbufferfromnormview\" id=\"ref-for-dom-xrdepthinformation-normdepthbufferfromnormview\">normDepthBufferFromNormView</a></code> attribute contains a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#xrrigidtransform\" id=\"ref-for-xrrigidtransform①\">XRRigidTransform</a></code> that needs to be applied when indexing into the <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-depth-buffer\" id=\"ref-for-xrdepthinformation-depth-buffer②\">depth buffer</a>. The transformation that the matrix represents changes the coordinate system from normalized view coordinates to normalized depth buffer coordinates that can then be scaled by depth buffer’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-width\" id=\"ref-for-dom-xrdepthinformation-width①\">width</a></code> and <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-height\" id=\"ref-for-dom-xrdepthinformation-height①\">height</a></code> to obtain the absolute depth buffer coordinates.</p>\n     \n     <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-rawvaluetometers\" id=\"ref-for-dom-xrdepthinformation-rawvaluetometers\">rawValueToMeters</a></code> attribute contains the scale factor by which the raw depth values from a <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-depth-buffer\" id=\"ref-for-xrdepthinformation-depth-buffer③\">depth buffer</a> must be multiplied in order to get the depth in meters.</p>\n     <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#dom-xrviewgeometry-transform\" id=\"ref-for-dom-xrviewgeometry-transform\">transform</a></code> is given in the associated <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-view\" id=\"ref-for-xrdepthinformation-view②\">view</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#view-reference-space\" id=\"ref-for-view-reference-space\">reference space</a>.</p>\n     <p>If the <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-sensor\" id=\"ref-for-xrdepthinformation-sensor\">sensor</a> is aligned with the associated <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-view\" id=\"ref-for-xrdepthinformation-view③\">view</a>, then all values included from <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#xrviewgeometry-mixin\" id=\"ref-for-xrviewgeometry-mixin①\">XRViewGeometry</a></code> MUST return the same values as the associated <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-view\" id=\"ref-for-xrdepthinformation-view④\">view</a> does.</p>\n     <p>Each <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation②\">XRDepthInformation</a></code> has an associated <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"XRDepthInformation\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"xrdepthinformation-view\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">view</dfn> which is the closest <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#xrview\" id=\"ref-for-xrview①\">XRView</a></code> to the <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-sensor\" id=\"ref-for-xrdepthinformation-sensor①\">sensor</a>, and is used to retrieve the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation③\">XRDepthInformation</a></code>.</p>\n     <p>Each <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation④\">XRDepthInformation</a></code> has an associated <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"XRDepthInformation\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"xrdepthinformation-sensor\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">sensor</dfn> that is the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#view-geometry-containing-object\" id=\"ref-for-view-geometry-containing-object\">containing object</a> for the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#xrviewgeometry-mixin\" id=\"ref-for-xrviewgeometry-mixin②\">XRViewGeometry</a></code> from which the depth information was obtained.</p>\n     <p>Each <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation⑤\">XRDepthInformation</a></code> has an associated <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"XRDepthInformation\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"xrdepthinformation-depth-buffer\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">depth buffer</dfn> that contains depth buffer data. Different <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation⑥\">XRDepthInformation</a></code>s may store objects of different concrete types in the depth buffer.</p>\n     <div class=\"algorithm\" data-algorithm=\"accessing-depth-buffer-members\">\n      <p>When <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"attempting-to-access-the-depth-buffer\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">attempting to access the depth buffer</dfn> of <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation⑦\">XRDepthInformation</a></code> or any interface that inherits from it, the user agent MUST run the following steps:</p>\n      \n     </div>\n     <h3 class=\"heading settled\" data-level=\"3.2\" id=\"xr-cpu-depth-info-section\"><span class=\"secno\">3.2. </span><span class=\"content\">XRCPUDepthInformation</span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#xr-cpu-depth-info-section\"></a></h3>\n<pre class=\"idl highlight def\">[<a class=\"idl-code\" data-link-type=\"extended-attribute\" href=\"https://webidl.spec.whatwg.org/#Exposed\" id=\"ref-for-Exposed①\"><c- g=\"\">Exposed</c-></a>=<c- n=\"\">Window</c->]\n<c- b=\"\">interface</c-> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-type=\"interface\" data-export=\"\" id=\"xrcpudepthinformation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">XRCPUDepthInformation</c-></code></dfn> : <a data-link-type=\"idl-name\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation⑧\"><c- n=\"\">XRDepthInformation</c-></a> {\n  [<a class=\"idl-code\" data-link-type=\"extended-attribute\" href=\"https://webidl.spec.whatwg.org/#SameObject\" id=\"ref-for-SameObject①\"><c- g=\"\">SameObject</c-></a>] <c- b=\"\">readonly</c-> <c- b=\"\">attribute</c-> <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\" id=\"ref-for-idl-ArrayBuffer\"><c- b=\"\">ArrayBuffer</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRCPUDepthInformation\" data-dfn-type=\"attribute\" data-export=\"\" data-readonly=\"\" data-type=\"ArrayBuffer\" id=\"dom-xrcpudepthinformation-data\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">data</c-></code></dfn>;\n\n  <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-float\" id=\"ref-for-idl-float①\"><c- b=\"\">float</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRCPUDepthInformation\" data-dfn-type=\"method\" data-export=\"\" data-lt=\"getDepthInMeters(x, y)\" id=\"dom-xrcpudepthinformation-getdepthinmeters\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">getDepthInMeters</c-></code></dfn>(<a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-float\" id=\"ref-for-idl-float②\"><c- b=\"\">float</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRCPUDepthInformation/getDepthInMeters(x, y)\" data-dfn-type=\"argument\" data-export=\"\" id=\"dom-xrcpudepthinformation-getdepthinmeters-x-y-x\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">x</c-></code></dfn>, <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-float\" id=\"ref-for-idl-float③\"><c- b=\"\">float</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRCPUDepthInformation/getDepthInMeters(x, y)\" data-dfn-type=\"argument\" data-export=\"\" id=\"dom-xrcpudepthinformation-getdepthinmeters-x-y-y\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">y</c-></code></dfn>);\n};\n</pre>\n     <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrcpudepthinformation-data\" id=\"ref-for-dom-xrcpudepthinformation-data④\">data</a></code> attribute contains depth buffer information in raw format, suitable for uploading to a WebGL texture if needed. The data is stored in row-major format, without padding, with each entry corresponding to distance from the <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-sensor\" id=\"ref-for-xrdepthinformation-sensor②\">sensor</a>’s near plane to the users' environment, in unspecified units. The size of each data entry and the type is determined by <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrsession-depthdataformat\" id=\"ref-for-dom-xrsession-depthdataformat②\">depthDataFormat</a></code>. The values can be converted from unspecified units to meters by multiplying them by <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-rawvaluetometers\" id=\"ref-for-dom-xrdepthinformation-rawvaluetometers①\">rawValueToMeters</a></code>. The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-normdepthbufferfromnormview\" id=\"ref-for-dom-xrdepthinformation-normdepthbufferfromnormview①\">normDepthBufferFromNormView</a></code> can be used to transform from <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#normalized-view-coordinates\" id=\"ref-for-normalized-view-coordinates①\">normalized view coordinates</a> into depth buffer’s coordinate system. When accessed, the algorithm to <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#attempting-to-access-the-depth-buffer\" id=\"ref-for-attempting-to-access-the-depth-buffer\">access the depth buffer</a> MUST be run.</p>\n     \n     <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrcpudepthinformation-getdepthinmeters\" id=\"ref-for-dom-xrcpudepthinformation-getdepthinmeters①\">getDepthInMeters(x, y)</a></code> method can be used to <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#obtain-depth-at-coordinates\" id=\"ref-for-obtain-depth-at-coordinates\">obtain depth at coordinates</a>. When invoked, the algorithm to <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#attempting-to-access-the-depth-buffer\" id=\"ref-for-attempting-to-access-the-depth-buffer①\">access the depth buffer</a> MUST be run.</p>\n     <div class=\"algorithm\" data-algorithm=\"obtain-depth-at-coordinates\">\n      <p>When <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrcpudepthinformation-getdepthinmeters\" id=\"ref-for-dom-xrcpudepthinformation-getdepthinmeters②\">getDepthInMeters(x, y)</a></code> method is invoked on an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#xrcpudepthinformation\" id=\"ref-for-xrcpudepthinformation①\">XRCPUDepthInformation</a></code> <var>depthInformation</var> with <var>x</var>, <var>y</var>, the user agent MUST <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"obtain-depth-at-coordinates\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">obtain depth at coordinates</dfn> by running the following steps:</p>\n      \n     </div>\n<pre class=\"idl highlight def\"><c- b=\"\">partial</c-> <c- b=\"\">interface</c-> <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://www.w3.org/TR/webxr/#xrframe-interface\" id=\"ref-for-xrframe-interface\"><c- g=\"\">XRFrame</c-></a> {\n  <a data-link-type=\"idl-name\" href=\"https://immersive-web.github.io/depth-sensing/#xrcpudepthinformation\" id=\"ref-for-xrcpudepthinformation②\"><c- n=\"\">XRCPUDepthInformation</c-></a>? <a class=\"idl-code\" data-link-type=\"method\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrframe-getdepthinformation\" id=\"ref-for-dom-xrframe-getdepthinformation\"><c- g=\"\">getDepthInformation</c-></a>(<a data-link-type=\"idl-name\" href=\"https://immersive-web.github.io/webxr/#xrview\" id=\"ref-for-xrview②\"><c- n=\"\">XRView</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRFrame/getDepthInformation(view)\" data-dfn-type=\"argument\" data-export=\"\" id=\"dom-xrframe-getdepthinformation-view-view\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">view</c-></code></dfn>);\n};\n</pre>\n     <p>The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRFrame\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-xrframe-getdepthinformation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>getDepthInformation(view)</code></dfn> method, when invoked on an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#xrframe-interface\" id=\"ref-for-xrframe-interface①\">XRFrame</a></code>, signals that the application wants to <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#obtain-cpu-depth-information\" id=\"ref-for-obtain-cpu-depth-information\">obtain CPU depth information</a> relevant for the frame.</p>\n     <div class=\"algorithm\" data-algorithm=\"obtain-depth-information\">\n      <p>When <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrframe-getdepthinformation\" id=\"ref-for-dom-xrframe-getdepthinformation①\">getDepthInformation(view)</a></code> method is invoked on an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#xrframe-interface\" id=\"ref-for-xrframe-interface②\">XRFrame</a></code> <var>frame</var> with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#xrview\" id=\"ref-for-xrview③\">XRView</a></code> <var>view</var>, the user agent MUST <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"obtain-cpu-depth-information\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">obtain CPU depth information</dfn> by running the following steps:</p>\n      \n     </div>\n     <div class=\"algorithm\" data-algorithm=\"create-cpu-depth-information\">\n      <p>In order to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"create-a-cpu-depth-information-instance\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">create a CPU depth information instance</dfn> given <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#xrframe-interface\" id=\"ref-for-xrframe-interface③\">XRFrame</a></code> <var>frame</var> and <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#xrview\" id=\"ref-for-xrview④\">XRView</a></code> <var>view</var>, the user agent MUST run the following steps:</p>\n      \n     </div>\n     \n     <h3 class=\"heading settled\" data-level=\"3.3\" id=\"xr-gpu-depth-info-section\"><span class=\"secno\">3.3. </span><span class=\"content\">XRWebGLDepthInformation</span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#xr-gpu-depth-info-section\"></a></h3>\n<pre class=\"idl highlight def\">[<a class=\"idl-code\" data-link-type=\"extended-attribute\" href=\"https://webidl.spec.whatwg.org/#Exposed\" id=\"ref-for-Exposed②\"><c- g=\"\">Exposed</c-></a>=<c- n=\"\">Window</c->]\n<c- b=\"\">interface</c-> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-type=\"interface\" data-export=\"\" id=\"xrwebgldepthinformation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">XRWebGLDepthInformation</c-></code></dfn> : <a data-link-type=\"idl-name\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation⑨\"><c- n=\"\">XRDepthInformation</c-></a> {\n  [<a class=\"idl-code\" data-link-type=\"extended-attribute\" href=\"https://webidl.spec.whatwg.org/#SameObject\" id=\"ref-for-SameObject②\"><c- g=\"\">SameObject</c-></a>] <c- b=\"\">readonly</c-> <c- b=\"\">attribute</c-> <a data-link-type=\"idl-name\" href=\"https://www.khronos.org/registry/webgl/specs/latest/1.0/#5.9\" id=\"ref-for-5.9\"><c- n=\"\">WebGLTexture</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRWebGLDepthInformation\" data-dfn-type=\"attribute\" data-export=\"\" data-readonly=\"\" data-type=\"WebGLTexture\" id=\"dom-xrwebgldepthinformation-texture\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">texture</c-></code></dfn>;\n\n  <c- b=\"\">readonly</c-> <c- b=\"\">attribute</c-> <a data-link-type=\"idl-name\" href=\"https://immersive-web.github.io/layers/#enumdef-xrtexturetype\" id=\"ref-for-enumdef-xrtexturetype\"><c- n=\"\">XRTextureType</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRWebGLDepthInformation\" data-dfn-type=\"attribute\" data-export=\"\" data-readonly=\"\" data-type=\"XRTextureType\" id=\"dom-xrwebgldepthinformation-texturetype\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">textureType</c-></code></dfn>;\n  <c- b=\"\">readonly</c-> <c- b=\"\">attribute</c-> <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-unsigned-long\" id=\"ref-for-idl-unsigned-long②\"><c- b=\"\">unsigned</c-> <c- b=\"\">long</c-></a>? <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRWebGLDepthInformation\" data-dfn-type=\"attribute\" data-export=\"\" data-readonly=\"\" data-type=\"unsigned long?\" id=\"dom-xrwebgldepthinformation-imageindex\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">imageIndex</c-></code></dfn>;\n};\n</pre>\n     <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrwebgldepthinformation-texture\" id=\"ref-for-dom-xrwebgldepthinformation-texture①\">texture</a></code> attribute contains depth buffer information as an <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxrlayers-1/#opaque-texture\" id=\"ref-for-opaque-texture\">opaque texture</a>. Each texel corresponds to distance from the <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-sensor\" id=\"ref-for-xrdepthinformation-sensor④\">sensor</a>’s near plane to the users' environment, in unspecified units. The size of each data entry and the type is determined by <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrsession-depthdataformat\" id=\"ref-for-dom-xrsession-depthdataformat⑤\">depthDataFormat</a></code>. The values can be converted from unspecified units to meters by multiplying them by <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-rawvaluetometers\" id=\"ref-for-dom-xrdepthinformation-rawvaluetometers③\">rawValueToMeters</a></code>. The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-normdepthbufferfromnormview\" id=\"ref-for-dom-xrdepthinformation-normdepthbufferfromnormview④\">normDepthBufferFromNormView</a></code> can be used to transform from <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#normalized-view-coordinates\" id=\"ref-for-normalized-view-coordinates②\">normalized view coordinates</a> into depth buffer’s coordinate system. When accessed, the algorithm to <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#attempting-to-access-the-depth-buffer\" id=\"ref-for-attempting-to-access-the-depth-buffer②\">access the depth buffer</a> of <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation①⓪\">XRDepthInformation</a></code> MUST be run.</p>\n     <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrwebgldepthinformation-texturetype\" id=\"ref-for-dom-xrwebgldepthinformation-texturetype\">textureType</a></code> attribute describes if the texture is of type <code class=\"idl\"><a data-link-type=\"idl\" data-refhint-key=\"65e2856a\" href=\"https://www.khronos.org/registry/webgl/specs/latest/1.0/#5.14\" id=\"ref-for-5.14①\">TEXTURE_2D</a></code> or <code class=\"idl\"><a data-link-type=\"idl\" data-refhint-key=\"277d52e5\" href=\"https://www.khronos.org/registry/webgl/specs/latest/2.0/#3.7\" id=\"ref-for-3.7②\">TEXTURE_2D_ARRAY</a></code>.</p>\n     <p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrwebgldepthinformation-imageindex\" id=\"ref-for-dom-xrwebgldepthinformation-imageindex\">imageIndex</a></code> attribute returns the offset into the texture array. It MUST be defined when <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrwebgldepthinformation-texturetype\" id=\"ref-for-dom-xrwebgldepthinformation-texturetype①\">textureType</a></code> is equal to <code class=\"idl\"><a data-link-type=\"idl\" data-refhint-key=\"277d52e5\" href=\"https://www.khronos.org/registry/webgl/specs/latest/2.0/#3.7\" id=\"ref-for-3.7③\">TEXTURE_2D_ARRAY</a></code> and MUST be undefined if it’s <code class=\"idl\"><a data-link-type=\"idl\" data-refhint-key=\"65e2856a\" href=\"https://www.khronos.org/registry/webgl/specs/latest/1.0/#5.14\" id=\"ref-for-5.14②\">TEXTURE_2D</a></code>.</p>\n<pre class=\"idl highlight def\"><c- b=\"\">partial</c-> <c- b=\"\">interface</c-> <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://immersive-web.github.io/layers/#xrwebglbinding\" id=\"ref-for-xrwebglbinding\"><c- g=\"\">XRWebGLBinding</c-></a> {\n  <a data-link-type=\"idl-name\" href=\"https://immersive-web.github.io/depth-sensing/#xrwebgldepthinformation\" id=\"ref-for-xrwebgldepthinformation①\"><c- n=\"\">XRWebGLDepthInformation</c-></a>? <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRWebGLBinding\" data-dfn-type=\"method\" data-export=\"\" data-lt=\"getDepthInformation(view)\" id=\"dom-xrwebglbinding-getdepthinformation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">getDepthInformation</c-></code></dfn>(<a data-link-type=\"idl-name\" href=\"https://immersive-web.github.io/webxr/#xrview\" id=\"ref-for-xrview⑤\"><c- n=\"\">XRView</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRWebGLBinding/getDepthInformation(view)\" data-dfn-type=\"argument\" data-export=\"\" id=\"dom-xrwebglbinding-getdepthinformation-view-view\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">view</c-></code></dfn>);\n};\n</pre>\n     <p>The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"XRWebGLDepthInformation\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-xrwebgldepthinformation-getdepthinformation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>getDepthInformation(view)</code></dfn> method, when invoked on an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/layers/#xrwebglbinding\" id=\"ref-for-xrwebglbinding①\">XRWebGLBinding</a></code>, signals that the application wants to <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#obtain-webgl-depth-information\" id=\"ref-for-obtain-webgl-depth-information\">obtain WebGL depth information</a> relevant for the frame.</p>\n     <div class=\"algorithm\" data-algorithm=\"obtain-webgl-depth-information\">\n      <p>When <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrwebglbinding-getdepthinformation\" id=\"ref-for-dom-xrwebglbinding-getdepthinformation\">getDepthInformation(view)</a></code> method is invoked on a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/layers/#xrwebglbinding\" id=\"ref-for-xrwebglbinding②\">XRWebGLBinding</a></code> <var>binding</var> with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#xrview\" id=\"ref-for-xrview⑥\">XRView</a></code> <var>view</var>, the user agent MUST <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"obtain-webgl-depth-information\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">obtain WebGL depth information</dfn> by running the following steps:</p>\n      \n     </div>\n     <div class=\"algorithm\" data-algorithm=\"create-webgl-depth-information\">\n      <p>In order to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"create-a-webgl-depth-information-instance\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">create a WebGL depth information instance</dfn> given <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#xrframe-interface\" id=\"ref-for-xrframe-interface④\">XRFrame</a></code> <var>frame</var> and <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#xrview\" id=\"ref-for-xrview⑦\">XRView</a></code> <var>view</var>, the user agent MUST run the following steps:</p>\n      \n     </div>\n     \n     <h2 class=\"heading settled\" data-level=\"4\" id=\"results-interpretation\"><span class=\"secno\">4. </span><span class=\"content\">Interpreting the results</span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#results-interpretation\"></a></h2>\n     <p>If a given pixel is determined to have <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"invalid-depth-data\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">invalid depth data</dfn> or the depth data cannot otherwise be determined, the user agent MUST return a depth value of 0.</p>\n     \n     <h2 class=\"heading settled\" data-level=\"5\" id=\"native-device-concepts\"><span class=\"secno\">5. </span><span class=\"content\">Native device concepts</span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#native-device-concepts\"></a></h2>\n     <h3 class=\"heading settled\" data-level=\"5.1\" id=\"native-depth-sensing-section\"><span class=\"secno\">5.1. </span><span class=\"content\">Native depth sensing</span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#native-depth-sensing-section\"></a></h3>\n     \n     <h2 class=\"heading settled\" data-level=\"6\" id=\"privacy-security\"><span class=\"secno\">6. </span><span class=\"content\">Privacy &amp; Security Considerations</span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#privacy-security\"></a></h2>\n     \n     <h2 class=\"no-num heading settled\" id=\"changes\"><span class=\"content\"> Changes</span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#changes\"></a></h2>\n     <h3 class=\"no-num heading settled\" id=\"changes-from-20210831\"><span class=\"content\"> Changes from the <a href=\"https://www.w3.org/TR/2021/WD-webxr-depth-sensing-1-20210831/\">First Public Working Draft 31 August 2021</a></span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#changes-from-20210831\"></a></h3>\n     <h2 class=\"heading settled\" data-level=\"7\" id=\"ack\"><span class=\"secno\">7. </span><span class=\"content\">Acknowledgements</span><a class=\"self-link\" href=\"https://immersive-web.github.io/depth-sensing/#ack\"></a></h2>\n     <p>The following individuals have contributed to the design of the WebXR Depth Sensing specification:</p>",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <var>session</var>’s <a data-link-type=\"dfn\">ended</a> value is <code>true</code>, throw an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror⑥\">InvalidStateError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>Let <var>frame</var> be <var>session</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrsession-animation-frame\" id=\"ref-for-xrsession-animation-frame①\">animation frame</a>.</p>"
        },
        {
          "html": "<p>If <var>frame</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrframe-active\" id=\"ref-for-xrframe-active①\">active</a> boolean is <code>false</code>, throw an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror⑦\">InvalidStateError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#depth-sensing\" id=\"ref-for-depth-sensing②\">depth-sensing</a> feature descriptor is not <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-contain\" id=\"ref-for-list-contain①\">contained</a> in the <var>session</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrsession-xr-device\" id=\"ref-for-xrsession-xr-device①\">XR device</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#dom-xrsession-enabledfeatures\" id=\"ref-for-dom-xrsession-enabledfeatures①\">list of enabled features</a> for <var>session</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrsession-mode\" id=\"ref-for-xrsession-mode①\">mode</a>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw①\">throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\" id=\"ref-for-notsupportederror③\">NotSupportedError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#depth-sensing-active-state\" id=\"ref-for-depth-sensing-active-state③\">depth sensing active state</a> is <code>false</code>, abort these steps.</p>"
        },
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#depth-sensing-active-state\" id=\"ref-for-depth-sensing-active-state④\">depth sensing active state</a> to <code>false</code>.</p>"
        }
      ]
    },
    {
      "name": "start-depth-sensing",
      "href": "https://immersive-web.github.io/depth-sensing/#xrdepthinformation",
      "html": "When <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"attempting-to-access-the-depth-buffer\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">attempting to access the depth buffer</dfn> of <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation\" id=\"ref-for-xrdepthinformation⑦\">XRDepthInformation</a></code> or any interface that inherits from it, the user agent MUST run the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>depthInformation</var> be the instance whose member is accessed.</p>"
        },
        {
          "html": "<p>Let <var>view</var> be the <var>depthInformation</var>’s <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-view\" id=\"ref-for-xrdepthinformation-view⑤\">view</a>.</p>"
        },
        {
          "html": "<p>Let <var>frame</var> be the <var>view</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrview-frame\" id=\"ref-for-xrview-frame\">frame</a>.</p>"
        },
        {
          "html": "<p>If <var>frame</var> is not <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrframe-active\" id=\"ref-for-xrframe-active②\">active</a>, throw <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror⑧\">InvalidStateError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <var>frame</var> is not an <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrframe-animationframe\" id=\"ref-for-xrframe-animationframe\">animationFrame</a>, throw <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror⑨\">InvalidStateError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>Proceed with normal steps required to access the member of <var>depthInformation</var>.</p>"
        }
      ]
    },
    {
      "name": "start-depth-sensing",
      "href": "https://immersive-web.github.io/depth-sensing/#xrdepthinformation",
      "html": "When <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrcpudepthinformation-getdepthinmeters\" id=\"ref-for-dom-xrcpudepthinformation-getdepthinmeters②\">getDepthInMeters(x, y)</a></code> method is invoked on an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#xrcpudepthinformation\" id=\"ref-for-xrcpudepthinformation①\">XRCPUDepthInformation</a></code> <var>depthInformation</var> with <var>x</var>, <var>y</var>, the user agent MUST <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"obtain-depth-at-coordinates\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">obtain depth at coordinates</dfn> by running the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>view</var> be the <var>depthInformation</var>’s <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-view\" id=\"ref-for-xrdepthinformation-view⑥\">view</a>, <var>frame</var> be <var>view</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrview-frame\" id=\"ref-for-xrview-frame①\">frame</a>, and <var>session</var> be the <var>frame</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#dom-xrframe-session\" id=\"ref-for-dom-xrframe-session\">session</a></code>.</p>"
        },
        {
          "html": "<p>If <var>x</var> is greater than <code>1.0</code> or less than <code>0.0</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw②\">throw</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-rangeerror\" id=\"ref-for-exceptiondef-rangeerror\">RangeError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <var>y</var> is greater than <code>1.0</code> or less than <code>0.0</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw③\">throw</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-rangeerror\" id=\"ref-for-exceptiondef-rangeerror①\">RangeError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>Let <var>normalizedViewCoordinates</var> be a vector representing 3-dimensional point in space, with <code>x</code> coordinate set to <var>x</var>, <code>y</code> coordinate set to <var>y</var>, <code>z</code> coordinate set to <code>0.0</code>, and <code>w</code> coordinate set to <code>1.0</code>.</p>"
        },
        {
          "html": "<p>Let <var>normalizedDepthCoordinates</var> be a result of premultiplying <var>normalizedViewCoordinates</var> vector from the left by <var>depthInformation</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-normdepthbufferfromnormview\" id=\"ref-for-dom-xrdepthinformation-normdepthbufferfromnormview②\">normDepthBufferFromNormView</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>depthCoordinates</var> be a result of scaling <var>normalizedDepthCoordinates</var>, with <code>x</code> coordinate multiplied by <var>depthInformation</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-width\" id=\"ref-for-dom-xrdepthinformation-width②\">width</a></code> and <code>y</code> coordinate multiplied by <var>depthInformation</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-height\" id=\"ref-for-dom-xrdepthinformation-height②\">height</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>column</var> be the value of <var>depthCoordinates</var>’ <code>x</code> coordinate, truncated to an integer, and clamped to <code>[0, width-1]</code> integer range.</p>"
        },
        {
          "html": "<p>Let <var>row</var> be the value of <var>depthCoordinates</var>’ <code>y</code> coordinate, truncated to an integer, and clamped to <code>[0, height-1]</code> integer range.</p>"
        },
        {
          "html": "<p>Let <var>index</var> be equal to <var>row</var> multiplied by <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-width\" id=\"ref-for-dom-xrdepthinformation-width③\">width</a></code> &amp; added to <var>column</var>.</p>"
        },
        {
          "html": "<p>Let <var>byteIndex</var> be equal to <var>index</var> multiplied by the size of the depth data format.</p>"
        },
        {
          "html": "<p>Let <var>rawDepth</var> be equal to a value found at index <var>byteIndex</var> in <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrcpudepthinformation-data\" id=\"ref-for-dom-xrcpudepthinformation-data⑥\">data</a></code>, interpreted as a number accordingly to <var>session</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrsession-depthdataformat\" id=\"ref-for-dom-xrsession-depthdataformat③\">depthDataFormat</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>rawValueToMeters</var> be equal to <var>depthInformation</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-rawvaluetometers\" id=\"ref-for-dom-xrdepthinformation-rawvaluetometers②\">rawValueToMeters</a></code>.</p>"
        },
        {
          "html": "<p>Return <var>rawDepth</var> multiplied by <var>rawValueToMeters</var>.</p>"
        }
      ]
    },
    {
      "name": "start-depth-sensing",
      "href": "https://immersive-web.github.io/depth-sensing/#xrdepthinformation",
      "html": "When <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrframe-getdepthinformation\" id=\"ref-for-dom-xrframe-getdepthinformation①\">getDepthInformation(view)</a></code> method is invoked on an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#xrframe-interface\" id=\"ref-for-xrframe-interface②\">XRFrame</a></code> <var>frame</var> with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#xrview\" id=\"ref-for-xrview③\">XRView</a></code> <var>view</var>, the user agent MUST <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"obtain-cpu-depth-information\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">obtain CPU depth information</dfn> by running the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>session</var> be <var>frame</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#dom-xrframe-session\" id=\"ref-for-dom-xrframe-session①\">session</a></code>.</p>"
        },
        {
          "html": "<p>If <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#depth-sensing\" id=\"ref-for-depth-sensing③\">depth-sensing</a> feature descriptor is not <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-contain\" id=\"ref-for-list-contain②\">contained</a> in the <var>session</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrsession-xr-device\" id=\"ref-for-xrsession-xr-device②\">XR device</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#dom-xrsession-enabledfeatures\" id=\"ref-for-dom-xrsession-enabledfeatures②\">list of enabled features</a> for <var>session</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrsession-mode\" id=\"ref-for-xrsession-mode②\">mode</a>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw④\">throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\" id=\"ref-for-notsupportederror④\">NotSupportedError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <var>frame</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrframe-active\" id=\"ref-for-xrframe-active③\">active</a> boolean is <code>false</code>, throw an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror①⓪\">InvalidStateError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <var>frame</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrframe-animationframe\" id=\"ref-for-xrframe-animationframe①\">animationFrame</a> boolean is <code>false</code>, throw an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror①①\">InvalidStateError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <var>frame</var> does not match <var>view</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrview-frame\" id=\"ref-for-xrview-frame②\">frame</a>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw⑤\">throw</a> an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror①②\">InvalidStateError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If the <var>session</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrsession-depthusage\" id=\"ref-for-dom-xrsession-depthusage②\">depthUsage</a></code> is not <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthusage-cpu-optimized\" id=\"ref-for-dom-xrdepthusage-cpu-optimized①\">\"cpu-optimized\"</a></code>, throw an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror①③\">InvalidStateError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>Let <var>depthInformation</var> be a result of <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#create-a-cpu-depth-information-instance\" id=\"ref-for-create-a-cpu-depth-information-instance\">creating a CPU depth information instance</a> given <var>frame</var> and <var>view</var>.</p>"
        },
        {
          "html": "<p>Return <var>depthInformation</var>.</p>"
        }
      ]
    },
    {
      "name": "start-depth-sensing",
      "href": "https://immersive-web.github.io/depth-sensing/#xrdepthinformation",
      "html": "In order to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"create-a-cpu-depth-information-instance\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">create a CPU depth information instance</dfn> given <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#xrframe-interface\" id=\"ref-for-xrframe-interface③\">XRFrame</a></code> <var>frame</var> and <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#xrview\" id=\"ref-for-xrview④\">XRView</a></code> <var>view</var>, the user agent MUST run the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>result</var> be a new instance of <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#xrcpudepthinformation\" id=\"ref-for-xrcpudepthinformation③\">XRCPUDepthInformation</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>time</var> be <var>frame</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrframe-time\" id=\"ref-for-xrframe-time\">time</a>.</p>"
        },
        {
          "html": "<p>Let <var>session</var> be <var>frame</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#dom-xrframe-session\" id=\"ref-for-dom-xrframe-session②\">session</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>device</var> be the <var>session</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrsession-xr-device\" id=\"ref-for-xrsession-xr-device③\">XR device</a>.</p>"
        },
        {
          "html": "<p>If <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrsession-depthactive\" id=\"ref-for-dom-xrsession-depthactive②\">depthActive</a></code> is <code>false</code>, return <code>null</code> and abort these steps.</p>"
        },
        {
          "html": "<p>Let <var>nativeDepthInformation</var> be a result of querying <var>device</var> for the depth information valid as of <var>time</var>, for specified <var>view</var>, taking into account <var>session</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrsession-depthtype\" id=\"ref-for-dom-xrsession-depthtype②\">depthType</a></code>, <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrsession-depthusage\" id=\"ref-for-dom-xrsession-depthusage③\">depthUsage</a></code>, and <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrsession-depthdataformat\" id=\"ref-for-dom-xrsession-depthdataformat④\">depthDataFormat</a></code>.</p>"
        },
        {
          "html": "<p>If <var>nativeDepthInformation</var> is <code>null</code>, return <code>null</code> and abort these steps.</p>"
        },
        {
          "html": "<p>If the depth buffer present in <var>nativeDepthInformation</var> meets user agent’s criteria to <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#block-access\" id=\"ref-for-block-access\">block access</a> to the depth data, return <code>null</code> and abort these steps.</p>"
        },
        {
          "html": "<p>If the depth buffer present in <var>nativeDepthInformation</var> meets user agent’s criteria to <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#limit-the-amount-of-information\" id=\"ref-for-limit-the-amount-of-information\">limit the amount of information</a> available in depth buffer, adjust the depth buffer accordingly.</p>"
        },
        {
          "html": "<p>Initialize <var>result</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-width\" id=\"ref-for-dom-xrdepthinformation-width④\">width</a></code> to the width of the depth buffer returned in <var>nativeDepthInformation</var>.</p>"
        },
        {
          "html": "<p>Initialize <var>result</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-height\" id=\"ref-for-dom-xrdepthinformation-height③\">height</a></code> to the height of the depth buffer returned in <var>nativeDepthInformation</var>.</p>"
        },
        {
          "html": "<p>Initialize <var>result</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-normdepthbufferfromnormview\" id=\"ref-for-dom-xrdepthinformation-normdepthbufferfromnormview③\">normDepthBufferFromNormView</a></code> to a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#xrrigidtransform\" id=\"ref-for-xrrigidtransform②\">XRRigidTransform</a></code>, based on <var>nativeDepthInformation</var>’s <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#depth-coordinates-transformation-matrix\" id=\"ref-for-depth-coordinates-transformation-matrix\">depth coordinates transformation matrix</a>.</p>"
        },
        {
          "html": "<p>Initialize <var>result</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrcpudepthinformation-data\" id=\"ref-for-dom-xrcpudepthinformation-data⑦\">data</a></code> to the raw depth buffer returned in <var>nativeDepthInformation</var>.</p>"
        },
        {
          "html": "<p>Initialize <var>result</var>’s <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-view\" id=\"ref-for-xrdepthinformation-view⑦\">view</a> to <var>view</var>.</p>"
        },
        {
          "html": "<p>Initialize <var>result</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#dom-xrviewgeometry-transform\" id=\"ref-for-dom-xrviewgeometry-transform①\">transform</a></code> to the <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-sensor\" id=\"ref-for-xrdepthinformation-sensor③\">sensor</a>’s pose at <var>time</var> in <var>view</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#view-reference-space\" id=\"ref-for-view-reference-space①\">reference space</a>.</p>"
        },
        {
          "html": "<p>Return <var>result</var>.</p>"
        }
      ]
    },
    {
      "name": "start-depth-sensing",
      "href": "https://immersive-web.github.io/depth-sensing/#xrdepthinformation",
      "html": "When <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrwebglbinding-getdepthinformation\" id=\"ref-for-dom-xrwebglbinding-getdepthinformation\">getDepthInformation(view)</a></code> method is invoked on a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/layers/#xrwebglbinding\" id=\"ref-for-xrwebglbinding②\">XRWebGLBinding</a></code> <var>binding</var> with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#xrview\" id=\"ref-for-xrview⑥\">XRView</a></code> <var>view</var>, the user agent MUST <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"obtain-webgl-depth-information\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">obtain WebGL depth information</dfn> by running the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>session</var> be <var>binding</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxrlayers-1/#xrwebglbinding-session\" id=\"ref-for-xrwebglbinding-session\">session</a>.</p>"
        },
        {
          "html": "<p>Let <var>frame</var> be <var>view</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrview-frame\" id=\"ref-for-xrview-frame③\">frame</a>.</p>"
        },
        {
          "html": "<p>If <var>session</var> does not match <var>frame</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#dom-xrframe-session\" id=\"ref-for-dom-xrframe-session③\">session</a></code>, throw an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror①④\">InvalidStateError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#depth-sensing\" id=\"ref-for-depth-sensing④\">depth-sensing</a> feature descriptor is not <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-contain\" id=\"ref-for-list-contain③\">contained</a> in the <var>session</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrsession-xr-device\" id=\"ref-for-xrsession-xr-device④\">XR device</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#dom-xrsession-enabledfeatures\" id=\"ref-for-dom-xrsession-enabledfeatures③\">list of enabled features</a> for <var>session</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrsession-mode\" id=\"ref-for-xrsession-mode③\">mode</a>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw⑥\">throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\" id=\"ref-for-notsupportederror⑤\">NotSupportedError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If the <var>session</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrsession-depthusage\" id=\"ref-for-dom-xrsession-depthusage④\">depthUsage</a></code> is not <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthusage-gpu-optimized\" id=\"ref-for-dom-xrdepthusage-gpu-optimized①\">\"gpu-optimized\"</a></code>, throw an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror①⑤\">InvalidStateError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <var>frame</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrframe-active\" id=\"ref-for-xrframe-active④\">active</a> boolean is <code>false</code>, throw an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror①⑥\">InvalidStateError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <var>frame</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrframe-animationframe\" id=\"ref-for-xrframe-animationframe②\">animationFrame</a> boolean is <code>false</code>, throw an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror①⑦\">InvalidStateError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>Let <var>depthInformation</var> be a result of <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#create-a-webgl-depth-information-instance\" id=\"ref-for-create-a-webgl-depth-information-instance\">creating a WebGL depth information instance</a> given <var>frame</var> and <var>view</var>.</p>"
        },
        {
          "html": "<p>Return <var>depthInformation</var>.</p>"
        }
      ]
    },
    {
      "name": "start-depth-sensing",
      "href": "https://immersive-web.github.io/depth-sensing/#xrdepthinformation",
      "html": "In order to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"create-a-webgl-depth-information-instance\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">create a WebGL depth information instance</dfn> given <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#xrframe-interface\" id=\"ref-for-xrframe-interface④\">XRFrame</a></code> <var>frame</var> and <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#xrview\" id=\"ref-for-xrview⑦\">XRView</a></code> <var>view</var>, the user agent MUST run the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>result</var> be a new instance of <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#xrwebgldepthinformation\" id=\"ref-for-xrwebgldepthinformation②\">XRWebGLDepthInformation</a></code>.</p>"
        },
        {
          "html": "Initialize <var>time</var> as follows:",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the XRSession was created with matchDepthView set to true:",
                  "html": "Let <var>time</var> be <var>frame</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrframe-time\" id=\"ref-for-xrframe-time①\">time</a>."
                },
                {
                  "case": "Otherwise",
                  "html": "Let <var>time</var> be time that the <var>device</var> captured the depth information."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Let <var>session</var> be <var>frame</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#dom-xrframe-session\" id=\"ref-for-dom-xrframe-session④\">session</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>device</var> be the <var>session</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#xrsession-xr-device\" id=\"ref-for-xrsession-xr-device⑤\">XR device</a>.</p>"
        },
        {
          "html": "<p>If <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrsession-depthactive\" id=\"ref-for-dom-xrsession-depthactive③\">depthActive</a></code> is <code>false</code>, return <code>null</code> and abort these steps.</p>"
        },
        {
          "html": "<p>Let <var>nativeDepthInformation</var> be a result of querying <var>device</var>’s <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#native-depth-sensing\" id=\"ref-for-native-depth-sensing③\">native depth sensing</a> for the depth information valid as of <var>time</var>, for specified <var>view</var>, taking into account <var>session</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrsession-depthtype\" id=\"ref-for-dom-xrsession-depthtype③\">depthType</a></code>, <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrsession-depthusage\" id=\"ref-for-dom-xrsession-depthusage⑤\">depthUsage</a></code>, and <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrsession-depthdataformat\" id=\"ref-for-dom-xrsession-depthdataformat⑥\">depthDataFormat</a></code>.</p>"
        },
        {
          "html": "<p>If <var>nativeDepthInformation</var> is <code>null</code>, return <code>null</code> and abort these steps.</p>"
        },
        {
          "html": "<p>If the depth buffer present in <var>nativeDepthInformation</var> meets user agent’s criteria to <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#block-access\" id=\"ref-for-block-access①\">block access</a> to the depth data, return <code>null</code> and abort these steps.</p>"
        },
        {
          "html": "<p>If the depth buffer present in <var>nativeDepthInformation</var> meets user agent’s criteria to <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#limit-the-amount-of-information\" id=\"ref-for-limit-the-amount-of-information①\">limit the amount of information</a> available in depth buffer, adjust the depth buffer accordingly.</p>"
        },
        {
          "html": "<p>Initialize <var>result</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-width\" id=\"ref-for-dom-xrdepthinformation-width⑤\">width</a></code> to the width of the depth buffer returned in <var>nativeDepthInformation</var>.</p>"
        },
        {
          "html": "<p>Initialize <var>result</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-height\" id=\"ref-for-dom-xrdepthinformation-height④\">height</a></code> to the height of the depth buffer returned in <var>nativeDepthInformation</var>.</p>"
        },
        {
          "html": "<p>Initialize <var>result</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrdepthinformation-normdepthbufferfromnormview\" id=\"ref-for-dom-xrdepthinformation-normdepthbufferfromnormview⑤\">normDepthBufferFromNormView</a></code> to a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/webxr/#xrrigidtransform\" id=\"ref-for-xrrigidtransform③\">XRRigidTransform</a></code>, based on <var>nativeDepthInformation</var>’s <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#depth-coordinates-transformation-matrix\" id=\"ref-for-depth-coordinates-transformation-matrix①\">depth coordinates transformation matrix</a>.</p>"
        },
        {
          "html": "<p>Initialize <var>result</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrwebgldepthinformation-texture\" id=\"ref-for-dom-xrwebgldepthinformation-texture②\">texture</a></code> to an <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxrlayers-1/#opaque-texture\" id=\"ref-for-opaque-texture①\">opaque texture</a> containing the depth buffer returned in <var>nativeDepthInformation</var>.</p>"
        },
        {
          "html": "<p>Initialize <var>result</var>’s <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-view\" id=\"ref-for-xrdepthinformation-view⑧\">view</a> to <var>view</var>.</p>"
        },
        {
          "html": "<p>Initialize <var>result</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webxr/#dom-xrviewgeometry-transform\" id=\"ref-for-dom-xrviewgeometry-transform②\">transform</a></code> to the <a data-link-type=\"dfn\" href=\"https://immersive-web.github.io/depth-sensing/#xrdepthinformation-sensor\" id=\"ref-for-xrdepthinformation-sensor⑤\">sensor</a>’s pose at <var>time</var> in <var>view</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxr/#view-reference-space\" id=\"ref-for-view-reference-space②\">reference space</a>.</p>"
        },
        {
          "html": "Initialize <var>result</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrwebgldepthinformation-texturetype\" id=\"ref-for-dom-xrwebgldepthinformation-texturetype②\">textureType</a></code> as follows:",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the result’s texture was created with a textureType of texture-array:",
                  "html": "Initialize <var>result</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrwebgldepthinformation-texturetype\" id=\"ref-for-dom-xrwebgldepthinformation-texturetype③\">textureType</a></code> to \"<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxrlayers-1/#dom-xrtexturetype-texture-array\" id=\"ref-for-dom-xrtexturetype-texture-array①\">texture-array</a>\"."
                },
                {
                  "case": "Otherwise",
                  "html": "Initialize <var>result</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrwebgldepthinformation-texturetype\" id=\"ref-for-dom-xrwebgldepthinformation-texturetype④\">textureType</a></code> to \"<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webxrlayers-1/#dom-xrtexturetype-texture\" id=\"ref-for-dom-xrtexturetype-texture\">texture</a>\"."
                }
              ]
            }
          ]
        },
        {
          "html": "Initialize <var>result</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrwebgldepthinformation-imageindex\" id=\"ref-for-dom-xrwebgldepthinformation-imageindex①\">imageIndex</a></code> as follows:",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If textureType is texture",
                  "html": "Initialize <var>result</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrwebgldepthinformation-imageindex\" id=\"ref-for-dom-xrwebgldepthinformation-imageindex②\">imageIndex</a></code> to <code>null</code>."
                },
                {
                  "case": "Else if view’s eye is \"right\"",
                  "html": "Initialize <var>result</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrwebgldepthinformation-imageindex\" id=\"ref-for-dom-xrwebgldepthinformation-imageindex③\">imageIndex</a></code> to <code>1</code>."
                },
                {
                  "case": "Otherwise",
                  "html": "Initialize <var>result</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://immersive-web.github.io/depth-sensing/#dom-xrwebgldepthinformation-imageindex\" id=\"ref-for-dom-xrwebgldepthinformation-imageindex④\">imageIndex</a></code> to <code>0</code>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <var>result</var>.</p>"
        }
      ]
    }
  ]
}