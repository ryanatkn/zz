{
  "spec": {
    "title": "Web Cryptography API Level 2",
    "url": "https://w3c.github.io/webcrypto/"
  },
  "algorithms": [
    {
      "name": "parse an ASN.1 structure",
      "href": "https://w3c.github.io/webcrypto/#concept-parse-an-asn1-structure",
      "html": "When this specification says to <dfn id=\"concept-parse-an-asn1-structure\" tabindex=\"0\" aria-haspopup=\"dialog\" data-dfn-type=\"dfn\">parse an ASN.1\n          structure</dfn>, the user agent must perform the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n              Let <var>data</var> be a sequence of bytes to be parsed.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>structure</var> be the ASN.1 structure to be parsed.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>exactData</var> be an optional boolean value. If it is not supplied,\n              let it be initialized to <code>true</code>.\n            </p>"
        },
        {
          "html": "<p>\n              Parse <var>data</var> according to the Distinguished Encoding Rules of\n              [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-x690\" title=\"Information technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)\">X690</a></cite>], using <var>structure</var> as the ASN.1 structure\n              to be decoded.\n            </p>"
        },
        {
          "html": "<p>\n              If <var>exactData</var> was specified, and all of the bytes of <var>data</var> were\n              not consumed during the parsing phase, then\n              <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n              <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Return the parsed ASN.1 structure.\n            </p>"
        }
      ]
    },
    {
      "name": "parse a JWK",
      "href": "https://w3c.github.io/webcrypto/#concept-parse-a-jwk",
      "html": "When this specification says to <dfn id=\"concept-parse-a-jwk\" tabindex=\"0\" aria-haspopup=\"dialog\" data-dfn-type=\"dfn\">parse a JWK</dfn>, the user\n          agent must run the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n              Let <var>data</var> be the sequence of bytes to be parsed.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>json</var> be the Unicode string that results from interpreting\n              <var>data</var> according to UTF-8.\n            </p>"
        },
        {
          "html": "<p>\n              Convert <var>json</var> to UTF-16.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>result</var> be the object literal that results from executing the\n              <code>JSON.parse</code> internal function in the context of a new global object,\n              with <code>text</code> argument set to a JavaScript String containing <var>json</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>key</var> be the result of converting <var>result</var> to the IDL dictionary\n              type of <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-1\"><code>JsonWebKey</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-kty\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-kty-1\"><code>kty</code></a> field of <var>key</var> is not defined, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>key</var>.\n            </p>"
        }
      ]
    },
    {
      "name": "cached ECMAScript object",
      "href": "https://w3c.github.io/webcrypto/#concept-cached-object",
      "html": "When this specification refers to the <dfn id=\"concept-cached-object\" tabindex=\"0\" aria-haspopup=\"dialog\" data-dfn-type=\"dfn\">cached ECMAScript\n          object</dfn> associated with an internal slot [[<var>slot</var>]] of <var>object</var>,\n          the user agent must run the following steps:",
      "rationale": "if",
      "steps": [
        {
          "html": "<dl class=\"switch\">\n              <dt>\n                If the [[<var>slot</var>_cached]] internal slot of <var>object</var> is undefined:\n              </dt>\n              <dd>\n                Set the [[<var>slot</var>_cached]] internal slot of <var>object</var> to the result\n                of performing type conversion to an ECMAScript object as defined in\n                [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>] to the contents of the [[<var>slot</var>]]\n                internal slot of <var>object</var>.\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the [[slot_cached]] internal slot of object is undefined:",
                  "html": "Set the [[<var>slot</var>_cached]] internal slot of <var>object</var> to the result\n                of performing type conversion to an ECMAScript object as defined in\n                [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>] to the contents of the [[<var>slot</var>]]\n                internal slot of <var>object</var>."
                }
              ]
            }
          ]
        },
        {
          "html": "Return the contents of the [[<var>slot</var>_cached]] internal slot of <var>object</var>."
        }
      ]
    },
    {
      "name": "Crypto/getRandomValues()",
      "href": "https://w3c.github.io/webcrypto/#dfn-Crypto-method-getRandomValues",
      "html": "The <dfn id=\"dfn-Crypto-method-getRandomValues\" data-dfn-for=\"Crypto\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"getRandomValues\" data-type=\"ArrayBufferView\" data-lt=\"getRandomValues()|getRandomValues(array)\" data-local-lt=\"Crypto.getRandomValues|Crypto.getRandomValues()|getRandomValues\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>getRandomValues</code></dfn>\n              method generates cryptographically strong random values. It must act as follows:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>array</var> is not an <a data-link-type=\"interface\" data-lt=\"Int8Array\" href=\"https://webidl.spec.whatwg.org/#idl-Int8Array\"><code>Int8Array</code></a>, <a data-link-type=\"interface\" data-lt=\"Uint8Array\" href=\"https://webidl.spec.whatwg.org/#idl-Uint8Array\"><code>Uint8Array</code></a>, <a data-link-type=\"interface\" data-lt=\"Uint8ClampedArray\" href=\"https://webidl.spec.whatwg.org/#idl-Uint8ClampedArray\"><code>Uint8ClampedArray</code></a>,\n                  <a data-link-type=\"interface\" data-lt=\"Int16Array\" href=\"https://webidl.spec.whatwg.org/#idl-Int16Array\"><code>Int16Array</code></a>, <a data-link-type=\"interface\" data-lt=\"Uint16Array\" href=\"https://webidl.spec.whatwg.org/#idl-Uint16Array\"><code>Uint16Array</code></a>, <a data-link-type=\"interface\" data-lt=\"Int32Array\" href=\"https://webidl.spec.whatwg.org/#idl-Int32Array\"><code>Int32Array</code></a>, <a data-link-type=\"interface\" data-lt=\"Uint32Array\" href=\"https://webidl.spec.whatwg.org/#idl-Uint32Array\"><code>Uint32Array</code></a>,\n                  <a data-link-type=\"interface\" data-lt=\"BigInt64Array\" href=\"https://webidl.spec.whatwg.org/#idl-BigInt64Array\"><code>BigInt64Array</code></a>, or <a data-link-type=\"interface\" data-lt=\"BigUint64Array\" href=\"https://webidl.spec.whatwg.org/#idl-BigUint64Array\"><code>BigUint64Array</code></a>, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"TypeMismatchError\" href=\"https://webidl.spec.whatwg.org/#typemismatcherror\"><code>TypeMismatchError</code></a> and\n                  <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#terminate-the-algorithm\" class=\"internalDFN\" id=\"ref-for-terminate-the-algorithm-1\">terminate the algorithm</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>byteLength</var> be the <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#buffersource-byte-length\">byte length</a> of <var>array</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  If <var>byteLength</var> is greater than 65536, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"interface\" data-lt=\"QuotaExceededError\" href=\"https://webidl.spec.whatwg.org/#quotaexceedederror\"><code>QuotaExceededError</code></a> and\n                  <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#terminate-the-algorithm\" class=\"internalDFN\" id=\"ref-for-terminate-the-algorithm-2\">terminate the algorithm</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>bytes</var> be a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> of length <var>byteLength</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Fill <var>bytes</var> with cryptographically secure random bytes.\n                </p>"
        },
        {
          "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#arraybufferview-write\">Write</a> <var>bytes</var> into <var>array</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>array</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "Crypto/randomUUID()",
      "href": "https://w3c.github.io/webcrypto/#dfn-Crypto-method-randomUUID",
      "html": "The <dfn id=\"dfn-Crypto-method-randomUUID\" data-dfn-for=\"Crypto\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"randomUUID\" data-type=\"DOMString\" data-lt=\"randomUUID()\" data-local-lt=\"Crypto.randomUUID|Crypto.randomUUID()|randomUUID\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>randomUUID</code></dfn>\n              method generates a new <a href=\"https://www.rfc-editor.org/rfc/rfc4122#section-4.4\">version 4 UUID</a>\n              and returns its <a href=\"https://www.rfc-editor.org/rfc/rfc2141#section-2.2\">namespace specific string representation</a>\n              as described in <a href=\"https://www.rfc-editor.org/rfc/rfc4122#section-3\">section 3</a> of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc4122\" title=\"A Universally Unique IDentifier (UUID) URN Namespace\">RFC4122</a></cite>].\n              To <dfn data-export=\"\" id=\"dfn-generate-a-random-uuid\" tabindex=\"0\" aria-haspopup=\"dialog\" data-dfn-type=\"dfn\">generate a random UUID</dfn>:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var>bytes</var> be a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> of length 16."
        },
        {
          "html": "Fill <var>bytes</var> with cryptographically secure random bytes."
        },
        {
          "html": "Set the 4 most significant bits of <var>bytes</var>[6], which represent the\n                UUID <a href=\"https://www.rfc-editor.org/rfc/rfc4122#section-4.1.3\">version</a>, to <code>0100</code>."
        },
        {
          "html": "Set the 2 most significant bits of <var>bytes</var>[8], which represent the\n                UUID <a href=\"https://www.rfc-editor.org/rfc/rfc4122#section-4.1.1\">variant</a>, to <code>10</code>."
        },
        {
          "html": "<p>\n                  Return the <a data-link-type=\"dfn\" data-lt=\"concatenate\" href=\"https://infra.spec.whatwg.org/#string-concatenate\">string concatenation</a> of «\n                </p>\n                \n                <p>\n                  ».\n                </p>",
          "ignored": [
            "hexadecimal representation of bytes[0], hexadecimal representation of bytes[1], hexadecimal representation of bytes[2], hexadecimal representation of bytes[3], \"-\", hexadecimal representation of bytes[4], hexadecimal representation of bytes[5], \"-\", hexadecimal representation of bytes[6], hexadecimal representation of bytes[7], \"-\", hexadecimal representation of bytes[8], hexadecimal representation of bytes[9], \"-\", hexadecimal representation of bytes[10], hexadecimal representation of bytes[11], hexadecimal representation of bytes[12], hexadecimal representation of bytes[13], hexadecimal representation of bytes[14], hexadecimal representation of bytes[15]"
          ]
        }
      ]
    },
    {
      "html": "<a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-19\"><code>CryptoKey</code></a> objects are <a href=\"https://w3c.github.io/webcrypto/#dfn-serializable-objects\" class=\"internalDFN\" data-link-type=\"dfn\" id=\"ref-for-dfn-serializable-objects-3\">serializable objects</a>. Their <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/structured-data.html#serialization-steps\">serialization steps</a>,\n            given <var>value</var> and <var>serialized</var>, are:",
      "rationale": "set",
      "steps": [
        {
          "html": "Set <var>serialized</var>.[[Type]] to the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-2\"><code>[[type]]</code></a> internal slot of <var>value</var>."
        },
        {
          "html": "Set <var>serialized</var>.[[Extractable]] to the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-2\"><code>[[extractable]]</code></a> internal slot of <var>value</var>."
        },
        {
          "html": "Set <var>serialized</var>.[[Algorithm]] to the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/structured-data.html#sub-serialization\">sub-serialization</a> of the\n              <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-3\"><code>[[algorithm]]</code></a> internal slot of <var>value</var>."
        },
        {
          "html": "Set <var>serialized</var>.[[Usages]] to the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/structured-data.html#sub-serialization\">sub-serialization</a> of the\n              <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-3\"><code>[[usages]]</code></a> internal slot of <var>value</var>."
        },
        {
          "html": "Set <var>serialized</var>.[[Handle]] to the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-4\"><code>[[handle]]</code></a> internal slot of <var>value</var>."
        }
      ]
    },
    {
      "html": "Their <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/structured-data.html#deserialization-steps\">deserialization steps</a>, given <var>serialized</var> and <var>value</var>, are:",
      "rationale": "initialize",
      "steps": [
        {
          "html": "Initialize the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-3\"><code>[[type]]</code></a> internal slot of <var>value</var> to <var>serialized</var>.[[Type]]."
        },
        {
          "html": "Initialize the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-3\"><code>[[extractable]]</code></a> internal slot of <var>value</var> to <var>serialized</var>.[[Extractable]]."
        },
        {
          "html": "Initialize the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-4\"><code>[[algorithm]]</code></a> internal slot of <var>value</var> to the\n              <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/structured-data.html#sub-deserialization\">sub-deserialization</a> of <var>serialized</var>.[[Algorithm]]."
        },
        {
          "html": "Initialize the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-4\"><code>[[usages]]</code></a> internal slot of <var>value</var> to the\n              <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/structured-data.html#sub-deserialization\">sub-deserialization</a> of <var>serialized</var>.[[Usages]]."
        },
        {
          "html": "Initialize the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-5\"><code>[[handle]]</code></a> internal slot of <var>value</var> to <var>serialized</var>.[[Handle]]."
        }
      ]
    },
    {
      "name": "SubtleCrypto/encrypt()",
      "href": "https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-encrypt",
      "html": "The <dfn id=\"dfn-SubtleCrypto-method-encrypt\" data-dfn-for=\"SubtleCrypto\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"encrypt\" data-type=\"Promise\" data-lt=\"encrypt()|encrypt(algorithm, key, data)\" data-local-lt=\"SubtleCrypto.encrypt|SubtleCrypto.encrypt()|encrypt\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>encrypt</code></dfn>\n              method returns a new Promise object that will encrypt data using\n              the specified\n              <a data-link-type=\"idl\" data-lt=\"AlgorithmIdentifier\" href=\"https://w3c.github.io/webcrypto/#dom-algorithmidentifier\" class=\"internalDFN\" id=\"ref-for-dom-algorithmidentifier-15\"><code>AlgorithmIdentifier</code></a> with\n              the supplied <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-35\"><code>CryptoKey</code></a>. It must act\n              as follows:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>algorithm</var> and <var>key</var> be the\n                  <code>algorithm</code> and <code>key</code> parameters\n                  passed to the <a data-link-type=\"idl\" data-lt=\"encrypt()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-encrypt\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-encrypt-2\"><code>encrypt</code></a><code>()</code> method,\n                  respectively.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>data</var> be the result of\n                  <a data-link-type=\"dfn\" data-lt=\"get a copy of the buffer source\" href=\"https://webidl.spec.whatwg.org/#dfn-get-buffer-source-copy\">getting a copy of the bytes held by</a> the <code>data</code> parameter passed to the\n                  <a data-link-type=\"idl\" data-lt=\"encrypt()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-encrypt\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-encrypt-3\"><code>encrypt</code></a><code>()</code> method.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-1\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  \"<code>encrypt</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>realm</var> be the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\">relevant realm</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and perform the remaining steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an error,\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-1\">crypto task source</a>,\n                  given <var>realm</var>'s global object,\n                  to reject <var>promise</var> with the returned error;\n                  and then <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#terminate-the-algorithm\" class=\"internalDFN\" id=\"ref-for-terminate-the-algorithm-3\">terminate the algorithm</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-algorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-algorithm-name-2\"><code>name</code></a> member of\n                  <var>normalizedAlgorithm</var> is not equal to the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-2\"><code>name</code></a> attribute of the\n                  <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-5\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var> then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-5\"><code>[[usages]]</code></a> internal slot of\n                  <var>key</var> does not contain an entry that is \"<code>encrypt</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>ciphertext</var> be the result of performing the encrypt\n                  operation specified by <var>normalizedAlgorithm</var> using <var>algorithm</var>\n                  and <var>key</var> and with <var>data</var> as <var>plaintext</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-2\">crypto task source</a>,\n                  given <var>realm</var>'s global object, to perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of <a data-link-type=\"dfn\" data-lt=\"create\" href=\"https://webidl.spec.whatwg.org/#arraybuffer-create\">creating</a> an <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a>\n                  in <var>realm</var>, containing <var>ciphertext</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "SubtleCrypto/decrypt()",
      "href": "https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-decrypt",
      "html": "The <dfn id=\"dfn-SubtleCrypto-method-decrypt\" data-dfn-for=\"SubtleCrypto\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"decrypt\" data-type=\"Promise\" data-lt=\"decrypt()|decrypt(algorithm, key, data)\" data-local-lt=\"SubtleCrypto.decrypt|SubtleCrypto.decrypt()|decrypt\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>decrypt</code></dfn>\n              method returns a new Promise object that will decrypt data using the specified\n              <a data-link-type=\"idl\" data-lt=\"AlgorithmIdentifier\" href=\"https://w3c.github.io/webcrypto/#dom-algorithmidentifier\" class=\"internalDFN\" id=\"ref-for-dom-algorithmidentifier-16\"><code>AlgorithmIdentifier</code></a> with\n              the supplied <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-36\"><code>CryptoKey</code></a>. It must act\n              as follows:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>algorithm</var> and <var>key</var> be the\n                  <code>algorithm</code> and <code>key</code> parameters\n                  passed to the <a data-link-type=\"idl\" data-lt=\"decrypt()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-decrypt\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-decrypt-2\"><code>decrypt</code></a><code>()</code> method,\n                  respectively.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>data</var> be the result of\n                  <a data-link-type=\"dfn\" data-lt=\"get a copy of the buffer source\" href=\"https://webidl.spec.whatwg.org/#dfn-get-buffer-source-copy\">getting a copy of the bytes held by</a> the <code>data</code> parameter passed to the\n                  <a data-link-type=\"idl\" data-lt=\"decrypt()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-decrypt\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-decrypt-3\"><code>decrypt</code></a><code>()</code> method.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-2\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  \"<code>decrypt</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>realm</var> be the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\">relevant realm</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and perform the remaining steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an error,\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-3\">crypto task source</a>,\n                  given <var>realm</var>'s global object,\n                  to reject <var>promise</var> with the returned error;\n                  and then <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#terminate-the-algorithm\" class=\"internalDFN\" id=\"ref-for-terminate-the-algorithm-4\">terminate the algorithm</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-algorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-algorithm-name-3\"><code>name</code></a> member of\n                  <var>normalizedAlgorithm</var> is not equal to the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-3\"><code>name</code></a> attribute of the\n                  <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-6\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var> then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-6\"><code>[[usages]]</code></a> internal slot of\n                  <var>key</var> does not contain an entry that is \"<code>decrypt</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>plaintext</var> be the result of performing the decrypt\n                  operation specified by <var>normalizedAlgorithm</var> using <var>key</var>\n                  and <var>algorithm</var>\n                  and with <var>data</var> as <var>ciphertext</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-4\">crypto task source</a>,\n                  given <var>realm</var>'s global object, to perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of <a data-link-type=\"dfn\" data-lt=\"create\" href=\"https://webidl.spec.whatwg.org/#arraybuffer-create\">creating</a> an <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a>\n                  in <var>realm</var>, containing <var>plaintext</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "SubtleCrypto/sign()",
      "href": "https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-sign",
      "html": "The <dfn id=\"dfn-SubtleCrypto-method-sign\" data-dfn-for=\"SubtleCrypto\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"sign\" data-type=\"Promise\" data-lt=\"sign()|sign(algorithm, key, data)\" data-local-lt=\"SubtleCrypto.sign|SubtleCrypto.sign()|sign\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>sign</code></dfn> method returns a\n              new Promise object that will sign data using the specified <a data-link-type=\"idl\" data-lt=\"AlgorithmIdentifier\" href=\"https://w3c.github.io/webcrypto/#dom-algorithmidentifier\" class=\"internalDFN\" id=\"ref-for-dom-algorithmidentifier-17\"><code>AlgorithmIdentifier</code></a> with the supplied\n              <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-37\"><code>CryptoKey</code></a>. It must act as follows:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>algorithm</var> and <var>key</var> be the\n                  <code>algorithm</code> and <code>key</code> parameters\n                  passed to the <a data-link-type=\"idl\" data-lt=\"sign()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-sign\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-sign-2\"><code>sign</code></a><code>()</code> method,\n                  respectively.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>data</var> be the result of\n                  <a data-link-type=\"dfn\" data-lt=\"get a copy of the buffer source\" href=\"https://webidl.spec.whatwg.org/#dfn-get-buffer-source-copy\">getting a copy of the bytes held by</a> the <code>data</code> parameter passed to the\n                  <a data-link-type=\"idl\" data-lt=\"sign()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-sign\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-sign-3\"><code>sign</code></a><code>()</code> method.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-3\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  \"<code>sign</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>realm</var> be the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\">relevant realm</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and perform the remaining steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an error,\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-5\">crypto task source</a>,\n                  given <var>realm</var>'s global object,\n                  to reject <var>promise</var> with the returned error;\n                  and then <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#terminate-the-algorithm\" class=\"internalDFN\" id=\"ref-for-terminate-the-algorithm-5\">terminate the algorithm</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-algorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-algorithm-name-4\"><code>name</code></a> member of\n                  <var>normalizedAlgorithm</var> is not equal to the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-4\"><code>name</code></a> attribute of the\n                  <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-7\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var> then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-7\"><code>[[usages]]</code></a> internal slot of\n                  <var>key</var> does not contain an entry that is \"<code>sign</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>signature</var> be the result of performing the sign operation\n                  specified by <var>normalizedAlgorithm</var> using <var>key</var> and\n                  <var>algorithm</var> and with <var>data</var> as <var>message</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-6\">crypto task source</a>,\n                  given <var>realm</var>'s global object, to perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of <a data-link-type=\"dfn\" data-lt=\"create\" href=\"https://webidl.spec.whatwg.org/#arraybuffer-create\">creating</a> an <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a>\n                  in <var>realm</var>, containing <var>signature</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "SubtleCrypto/verify()",
      "href": "https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-verify",
      "html": "The <dfn id=\"dfn-SubtleCrypto-method-verify\" data-dfn-for=\"SubtleCrypto\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"verify\" data-type=\"Promise\" data-lt=\"verify()|verify(algorithm, key, signature, data)\" data-local-lt=\"SubtleCrypto.verify|SubtleCrypto.verify()|verify\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>verify</code></dfn> method returns\n              a new Promise object that will verify data using the specified <a data-link-type=\"idl\" data-lt=\"AlgorithmIdentifier\" href=\"https://w3c.github.io/webcrypto/#dom-algorithmidentifier\" class=\"internalDFN\" id=\"ref-for-dom-algorithmidentifier-18\"><code>AlgorithmIdentifier</code></a> with the supplied\n              <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-38\"><code>CryptoKey</code></a>. It must act as follows:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>algorithm</var> and <var>key</var>\n                  be the <code>algorithm</code> and <code>key</code> parameters passed to the\n                  <a data-link-type=\"idl\" data-lt=\"verify()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-verify\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-verify-2\"><code>verify</code></a><code>()</code> method, respectively.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>signature</var> be the result of\n                  <a data-link-type=\"dfn\" data-lt=\"get a copy of the buffer source\" href=\"https://webidl.spec.whatwg.org/#dfn-get-buffer-source-copy\">getting a copy of the bytes held by</a> the <code>signature</code> parameter passed to the\n                  <a data-link-type=\"idl\" data-lt=\"verify()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-verify\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-verify-3\"><code>verify</code></a><code>()</code> method.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>data</var> be the result of\n                  <a data-link-type=\"dfn\" data-lt=\"get a copy of the buffer source\" href=\"https://webidl.spec.whatwg.org/#dfn-get-buffer-source-copy\">getting a copy of the bytes held by</a> the <code>data</code> parameter passed to the\n                  <a data-link-type=\"idl\" data-lt=\"verify()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-verify\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-verify-4\"><code>verify</code></a><code>()</code> method.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-4\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  \"<code>verify</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>realm</var> be the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\">relevant realm</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and perform the remaining steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an error,\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-7\">crypto task source</a>,\n                  given <var>realm</var>'s global object,\n                  to reject <var>promise</var> with the returned error;\n                  and then <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#terminate-the-algorithm\" class=\"internalDFN\" id=\"ref-for-terminate-the-algorithm-6\">terminate the algorithm</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-algorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-algorithm-name-5\"><code>name</code></a> member of\n                  <var>normalizedAlgorithm</var> is not equal to the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-5\"><code>name</code></a> attribute of the\n                  <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-8\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var> then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-8\"><code>[[usages]]</code></a> internal slot of\n                  <var>key</var> does not contain an entry that is \"<code>verify</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of performing the verify operation\n                  specified by <var>normalizedAlgorithm</var> using <var>key</var>,\n                  <var>algorithm</var> and\n                  <var>signature</var> and with <var>data</var> as <var>message</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-8\">crypto task source</a>,\n                  given <var>realm</var>'s global object, to perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "SubtleCrypto/digest()",
      "href": "https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-digest",
      "html": "The <dfn id=\"dfn-SubtleCrypto-method-digest\" data-dfn-for=\"SubtleCrypto\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"digest\" data-type=\"Promise\" data-lt=\"digest()|digest(algorithm, data)\" data-local-lt=\"SubtleCrypto.digest|SubtleCrypto.digest()|digest\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>digest</code></dfn> method returns\n              a new Promise object that will digest data using the specified\n              <a data-link-type=\"idl\" data-lt=\"AlgorithmIdentifier\" href=\"https://w3c.github.io/webcrypto/#dom-algorithmidentifier\" class=\"internalDFN\" id=\"ref-for-dom-algorithmidentifier-19\"><code>AlgorithmIdentifier</code></a>.\n              It must act as follows:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>algorithm</var> be the <code>algorithm</code> parameter passed to the\n                  <a data-link-type=\"idl\" data-lt=\"digest()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-digest\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-digest-2\"><code>digest</code></a><code>()</code> method.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>data</var> be the result of\n                  <a data-link-type=\"dfn\" data-lt=\"get a copy of the buffer source\" href=\"https://webidl.spec.whatwg.org/#dfn-get-buffer-source-copy\">getting a copy of the bytes held by</a> the <code>data</code> parameter passed to the\n                  <a data-link-type=\"idl\" data-lt=\"digest()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-digest\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-digest-3\"><code>digest</code></a><code>()</code> method.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-5\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  \"<code>digest</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>realm</var> be the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\">relevant realm</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and perform the remaining steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an error,\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-9\">crypto task source</a>,\n                  given <var>realm</var>'s global object,\n                  to reject <var>promise</var> with the returned error;\n                  and then <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#terminate-the-algorithm\" class=\"internalDFN\" id=\"ref-for-terminate-the-algorithm-7\">terminate the algorithm</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>digest</var> be the result of performing the digest\n                  operation specified by <var>normalizedAlgorithm</var> using\n                  <var>algorithm</var>, with <var>data</var>\n                  as <var>message</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-10\">crypto task source</a>,\n                  given <var>realm</var>'s global object, to perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of <a data-link-type=\"dfn\" data-lt=\"create\" href=\"https://webidl.spec.whatwg.org/#arraybuffer-create\">creating</a> an <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a>\n                  in <var>realm</var>, containing <var>digest</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "SubtleCrypto/generateKey()",
      "href": "https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-generateKey",
      "html": "When invoked, <dfn id=\"dfn-SubtleCrypto-method-generateKey\" data-dfn-for=\"SubtleCrypto\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"generateKey\" data-type=\"Promise\" data-lt=\"generateKey()|generateKey(algorithm, extractable, keyUsages)\" data-local-lt=\"SubtleCrypto.generateKey|SubtleCrypto.generateKey()|generateKey\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>generateKey</code></dfn> <em class=\"rfc2119\">MUST</em> perform the\n              following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>algorithm</var>, <var>extractable</var> and <var>usages</var>\n                  be the <code>algorithm</code>, <code>extractable</code> and <code>keyUsages</code>\n                  parameters passed to the\n                  <a data-link-type=\"idl\" data-lt=\"generateKey()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-generateKey\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-generateKey-3\"><code>generateKey</code></a><code>()</code> method,\n                  respectively.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-6\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  \"<code>generateKey</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>realm</var> be the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\">relevant realm</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and perform the remaining steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an error,\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-11\">crypto task source</a>,\n                  given <var>realm</var>'s global object,\n                  to reject <var>promise</var> with the returned error;\n                  and then <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#terminate-the-algorithm\" class=\"internalDFN\" id=\"ref-for-terminate-the-algorithm-8\">terminate the algorithm</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of performing the generate key operation\n                  specified by <var>normalizedAlgorithm</var> using\n                  <var>algorithm</var>, <var>extractable</var> and <var>usages</var>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>result</var> is a <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-39\"><code>CryptoKey</code></a> object:</dt>\n                  <dd>\n                    <p>\n                      If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-4\"><code>[[type]]</code></a> internal slot of\n                      <var>result</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-secret\" class=\"internalDFN\" id=\"ref-for-dom-keytype-secret-2\"><code>secret</code></a>\" or \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-2\"><code>private</code></a>\" and\n                      <var>usages</var> is empty, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                    </p>\n                  </dd>\n                  <dt>If <var>result</var> is a <a data-link-type=\"idl\" data-lt=\"CryptoKeyPair\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-2\"><code>CryptoKeyPair</code></a> object:</dt>\n                  <dd>\n                    <p>\n                      If the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-9\"><code>[[usages]]</code></a> internal slot of the\n                      <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair-privateKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-privateKey-1\"><code>privateKey</code></a> attribute of\n                      <var>result</var> is the empty sequence, then\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If result is a CryptoKey object:",
                  "html": "<p>\n                      If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-4\"><code>[[type]]</code></a> internal slot of\n                      <var>result</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-secret\" class=\"internalDFN\" id=\"ref-for-dom-keytype-secret-2\"><code>secret</code></a>\" or \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-2\"><code>private</code></a>\" and\n                      <var>usages</var> is empty, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                    </p>"
                },
                {
                  "case": "If result is a CryptoKeyPair object:",
                  "html": "<p>\n                      If the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-9\"><code>[[usages]]</code></a> internal slot of the\n                      <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair-privateKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-privateKey-1\"><code>privateKey</code></a> attribute of\n                      <var>result</var> is the empty sequence, then\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-12\">crypto task source</a>,\n                  given <var>realm</var>'s global object, to perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of converting <var>result</var> to an ECMAScript Object in <var>realm</var>,\n                  as defined by [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>].\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "SubtleCrypto/deriveKey()",
      "href": "https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-deriveKey",
      "html": "When invoked, <dfn id=\"dfn-SubtleCrypto-method-deriveKey\" data-dfn-for=\"SubtleCrypto\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"deriveKey\" data-type=\"Promise\" data-lt=\"deriveKey()|deriveKey(algorithm, baseKey, derivedKeyType, extractable, keyUsages)\" data-local-lt=\"SubtleCrypto.deriveKey|SubtleCrypto.deriveKey()|deriveKey\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>deriveKey</code></dfn>\n              <em class=\"rfc2119\">MUST</em> perform the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>algorithm</var>, <var>baseKey</var>, <var>derivedKeyType</var>,\n                  <var>extractable</var> and <var>usages</var> be the <code>algorithm</code>,\n                  <code>baseKey</code>, <code>derivedKeyType</code>, <code>extractable</code> and\n                  <code>keyUsages</code> parameters passed to the <a data-link-type=\"idl\" data-lt=\"deriveKey()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-deriveKey\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-deriveKey-2\"><code>deriveKey</code></a><code>()</code> method, respectively.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-7\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  \"<code>deriveBits</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedDerivedKeyAlgorithmImport</var> be the result of\n                  <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-8\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>derivedKeyType</var> and <code>op</code> set to\n                  \"<code>importKey</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedDerivedKeyAlgorithmImport</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedDerivedKeyAlgorithmLength</var> be the result of\n                  <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-9\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>derivedKeyType</var> and <code>op</code> set to\n                  \"<code>get key length</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedDerivedKeyAlgorithmLength</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>realm</var> be the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\">relevant realm</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and perform the remaining steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an error,\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-13\">crypto task source</a>,\n                  given <var>realm</var>'s global object,\n                  to reject <var>promise</var> with the returned error;\n                  and then <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#terminate-the-algorithm\" class=\"internalDFN\" id=\"ref-for-terminate-the-algorithm-9\">terminate the algorithm</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-algorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-algorithm-name-6\"><code>name</code></a> member of\n                  <var>normalizedAlgorithm</var> is not equal to the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-6\"><code>name</code></a> attribute of the\n                  <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-9\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>baseKey</var> then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-10\"><code>[[usages]]</code></a> internal slot of\n                  <var>baseKey</var> does not contain an entry that is \"<code>deriveKey</code>\",\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>length</var> be the result of performing the get key length\n                  algorithm specified by <var>normalizedDerivedKeyAlgorithmLength</var> using\n                  <var>derivedKeyType</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>secret</var> be the result of performing the derive bits operation\n                  specified by <var>normalizedAlgorithm</var> using\n                  <var>key</var>, <var>algorithm</var> and <var>length</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of performing the import key operation\n                  specified by <var>normalizedDerivedKeyAlgorithmImport</var> using \"<code>raw</code>\" as\n                  <var>format</var>, <var>secret</var> as <var>keyData</var>,\n                  <var>derivedKeyType</var> as <var>algorithm</var> and using\n                  <var>extractable</var> and <var>usages</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-5\"><code>[[type]]</code></a> internal slot of\n                  <var>result</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-secret\" class=\"internalDFN\" id=\"ref-for-dom-keytype-secret-3\"><code>secret</code></a>\" or \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-3\"><code>private</code></a>\" and\n                  <var>usages</var> is empty, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-5\"><code>[[extractable]]</code></a> internal\n                  slot of <var>result</var> to <var>extractable</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-11\"><code>[[usages]]</code></a> internal\n                  slot of <var>result</var> to the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-normalized-usages\" class=\"internalDFN\" id=\"ref-for-concept-normalized-usages-1\">normalized value</a> of <var>usages</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-14\">crypto task source</a>,\n                  given <var>realm</var>'s global object, to perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of converting <var>result</var> to an ECMAScript Object in <var>realm</var>,\n                  as defined by [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>].\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "SubtleCrypto/deriveBits()",
      "href": "https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-deriveBits",
      "html": "When invoked, <dfn id=\"dfn-SubtleCrypto-method-deriveBits\" data-dfn-for=\"SubtleCrypto\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"deriveBits\" data-type=\"Promise\" data-lt=\"deriveBits()|deriveBits(algorithm, baseKey)|deriveBits(algorithm, baseKey, length)\" data-local-lt=\"SubtleCrypto.deriveBits|SubtleCrypto.deriveBits()|deriveBits\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>deriveBits</code></dfn>\n              <em class=\"rfc2119\">MUST</em> perform the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>algorithm</var>, <var>baseKey</var> and <var>length</var>,\n                  be the <code>algorithm</code>,\n                  <code>baseKey</code> and <code>length</code>\n                  parameters passed to the\n                  <a data-link-type=\"idl\" data-lt=\"deriveBits()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-deriveBits\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-deriveBits-2\"><code>deriveBits</code></a><code>()</code> method,\n                  respectively.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-10\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  \"<code>deriveBits</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>realm</var> be the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\">relevant realm</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and perform the remaining steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an error,\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-15\">crypto task source</a>,\n                  given <var>realm</var>'s global object,\n                  to reject <var>promise</var> with the returned error;\n                  and then <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#terminate-the-algorithm\" class=\"internalDFN\" id=\"ref-for-terminate-the-algorithm-10\">terminate the algorithm</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-algorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-algorithm-name-7\"><code>name</code></a> member of\n                  <var>normalizedAlgorithm</var> is not equal to the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-7\"><code>name</code></a> attribute of the\n                  <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-10\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>baseKey</var> then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-12\"><code>[[usages]]</code></a> internal slot of\n                  <var>baseKey</var> does not contain an entry that is \"<code>deriveBits</code>\",\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>bits</var> be the result of performing the derive bits operation\n                  specified by <var>normalizedAlgorithm</var> using <var>baseKey</var>,\n                  <var>algorithm</var> and <var>length</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-16\">crypto task source</a>,\n                  given <var>realm</var>'s global object, to perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of <a data-link-type=\"dfn\" data-lt=\"create\" href=\"https://webidl.spec.whatwg.org/#arraybuffer-create\">creating</a> an <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a>\n                  in <var>realm</var>, containing <var>bits</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "SubtleCrypto/importKey()",
      "href": "https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-importKey",
      "html": "When invoked, the <dfn id=\"dfn-SubtleCrypto-method-importKey\" data-dfn-for=\"SubtleCrypto\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"importKey\" data-type=\"Promise\" data-lt=\"importKey()|importKey(format, keyData, algorithm, extractable, keyUsages)\" data-local-lt=\"SubtleCrypto.importKey|SubtleCrypto.importKey()|importKey\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>importKey</code></dfn> method <em class=\"rfc2119\">MUST</em> perform the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>format</var>, <var>algorithm</var>, <var>extractable</var> and\n                  <var>usages</var>, be the <code>format</code>, <code>algorithm</code>,\n                  <code>extractable</code> and <code>keyUsages</code> parameters passed to the <a data-link-type=\"idl\" data-lt=\"importKey()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-importKey\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-importKey-2\"><code>importKey</code></a><code>()</code> method, respectively.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>\n                    If <var>format</var> is equal to the string \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-2\"><code>raw</code></a>\",\n                    \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-2\"><code>pkcs8</code></a>\", or \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-2\"><code>spki</code></a>\":\n                  </dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>\n                    If <var>format</var> is equal to the string \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-2\"><code>jwk</code></a>\":\n                  </dt>\n                  <dd>\n                    \n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is equal to the string \"raw\", \"pkcs8\", or \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <code>keyData</code> parameter passed to the\n                          <a data-link-type=\"idl\" data-lt=\"importKey()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-importKey\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-importKey-3\"><code>importKey</code></a><code>()</code> method is a\n                          <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-5\"><code>JsonWebKey</code></a> dictionary, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"TypeError\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\"><code>TypeError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>keyData</var> be the result of\n                          <a data-link-type=\"dfn\" data-lt=\"get a copy of the buffer source\" href=\"https://webidl.spec.whatwg.org/#dfn-get-buffer-source-copy\">getting a copy of the bytes held by</a> the\n                          <code>keyData</code> parameter passed to the\n                          <a data-link-type=\"idl\" data-lt=\"importKey()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-importKey\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-importKey-4\"><code>importKey</code></a><code>()</code> method.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is equal to the string \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <code>keyData</code> parameter passed to the\n                          <a data-link-type=\"idl\" data-lt=\"importKey()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-importKey\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-importKey-5\"><code>importKey</code></a><code>()</code> method is not a\n                          <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-6\"><code>JsonWebKey</code></a> dictionary, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"TypeError\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\"><code>TypeError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>keyData</var> be the <code>keyData</code> parameter passed to the\n                          <a data-link-type=\"idl\" data-lt=\"importKey()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-importKey\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-importKey-6\"><code>importKey</code></a><code>()</code> method.\n                        </p>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-11\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  \"<code>importKey</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>realm</var> be the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\">relevant realm</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and perform the remaining steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an error,\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-17\">crypto task source</a>,\n                  given <var>realm</var>'s global object,\n                  to reject <var>promise</var> with the returned error;\n                  and then <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#terminate-the-algorithm\" class=\"internalDFN\" id=\"ref-for-terminate-the-algorithm-11\">terminate the algorithm</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-40\"><code>CryptoKey</code></a> object that\n                  results from performing the import key operation specified by\n                  <var>normalizedAlgorithm</var> using <var>keyData</var>,\n                  <var>algorithm</var>,\n                  <var>format</var>, <var>extractable</var> and <var>usages</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-6\"><code>[[type]]</code></a> internal slot of\n                  <var>result</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-secret\" class=\"internalDFN\" id=\"ref-for-dom-keytype-secret-4\"><code>secret</code></a>\" or \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-4\"><code>private</code></a>\" and\n                  <var>usages</var> is empty, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-6\"><code>[[extractable]]</code></a> internal\n                  slot of <var>result</var> to <var>extractable</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-13\"><code>[[usages]]</code></a> internal\n                  slot of <var>result</var> to the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-normalized-usages\" class=\"internalDFN\" id=\"ref-for-concept-normalized-usages-2\">normalized value</a> of <var>usages</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-18\">crypto task source</a>,\n                  given <var>realm</var>'s global object, to perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of converting <var>result</var> to an ECMAScript Object in <var>realm</var>,\n                  as defined by [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>].\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "SubtleCrypto/exportKey()",
      "href": "https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-exportKey",
      "html": "When invoked, the <dfn id=\"dfn-SubtleCrypto-method-exportKey\" data-dfn-for=\"SubtleCrypto\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"exportKey\" data-type=\"Promise\" data-lt=\"exportKey()|exportKey(format, key)\" data-local-lt=\"SubtleCrypto.exportKey|SubtleCrypto.exportKey()|exportKey\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>exportKey</code></dfn> method <em class=\"rfc2119\">MUST</em> perform the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>format</var> and <var>key</var> be the <code>format</code> and\n                  <code>key</code> parameters passed to the <a data-link-type=\"idl\" data-lt=\"exportKey()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-exportKey\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-exportKey-3\"><code>exportKey</code></a><code>()</code> method, respectively.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>realm</var> be the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\">relevant realm</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and perform the remaining steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an error,\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-19\">crypto task source</a>,\n                  given <var>realm</var>'s global object,\n                  to reject <var>promise</var> with the returned error;\n                  and then <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#terminate-the-algorithm\" class=\"internalDFN\" id=\"ref-for-terminate-the-algorithm-12\">terminate the algorithm</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-algorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-algorithm-name-8\"><code>name</code></a> member of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-11\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var> does not identify a <a href=\"https://w3c.github.io/webcrypto/#algorithms\">registered algorithm</a>\n                  that supports the export key operation, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-7\"><code>[[extractable]]</code></a> internal slot\n                  of <var>key</var> is false, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of performing the export key operation\n                  specified by the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-12\"><code>[[algorithm]]</code></a>\n                  internal slot of <var>key</var> using <var>key</var> and <var>format</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-20\">crypto task source</a>,\n                  given <var>realm</var>'s global object, to perform the remaining steps.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>\n                    If <var>format</var> is equal to the strings \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-4\"><code>raw</code></a>\",\n                    \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-4\"><code>pkcs8</code></a>\", or \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-4\"><code>spki</code></a>\":\n                  </dt>\n                  <dd>\n                    Let <var>result</var> be the result of <a data-link-type=\"dfn\" data-lt=\"create\" href=\"https://webidl.spec.whatwg.org/#arraybuffer-create\">creating</a> an <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a>\n                    in <var>realm</var>, containing <var>result</var>.\n                  </dd>\n                  <dt>\n                    If <var>format</var> is equal to the string \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-4\"><code>jwk</code></a>\":\n                  </dt>\n                  <dd>\n                    Let <var>result</var> be the result of converting <var>result</var> to an ECMAScript Object in <var>realm</var>,\n                    as defined by [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>].\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is equal to the strings \"raw\", \"pkcs8\", or \"spki\":",
                  "html": "Let <var>result</var> be the result of <a data-link-type=\"dfn\" data-lt=\"create\" href=\"https://webidl.spec.whatwg.org/#arraybuffer-create\">creating</a> an <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a>\n                    in <var>realm</var>, containing <var>result</var>."
                },
                {
                  "case": "If format is equal to the string \"jwk\":",
                  "html": "Let <var>result</var> be the result of converting <var>result</var> to an ECMAScript Object in <var>realm</var>,\n                    as defined by [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>]."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "SubtleCrypto/wrapKey()",
      "href": "https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-wrapKey",
      "html": "When invoked, the <dfn id=\"dfn-SubtleCrypto-method-wrapKey\" data-dfn-for=\"SubtleCrypto\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"wrapKey\" data-type=\"Promise\" data-lt=\"wrapKey()|wrapKey(format, key, wrappingKey, wrapAlgorithm)\" data-local-lt=\"SubtleCrypto.wrapKey|SubtleCrypto.wrapKey()|wrapKey\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>wrapKey</code></dfn> method <em class=\"rfc2119\">MUST</em> perform the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>format</var>, <var>key</var>, <var>wrappingKey</var> and\n                  <var>algorithm</var> be the <code>format</code>, <code>key</code>,\n                  <code>wrappingKey</code> and <code>wrapAlgorithm</code> parameters passed to the\n                  <a data-link-type=\"idl\" data-lt=\"wrapKey()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-wrapKey\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-wrapKey-3\"><code>wrapKey</code></a><code>()</code> method,\n                  respectively.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-12\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  \"<code>wrapKey</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-13\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  \"<code>encrypt</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>realm</var> be the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\">relevant realm</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and perform the remaining steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an error,\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-21\">crypto task source</a>,\n                  given <var>realm</var>'s global object,\n                  to reject <var>promise</var> with the returned error;\n                  and then <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#terminate-the-algorithm\" class=\"internalDFN\" id=\"ref-for-terminate-the-algorithm-13\">terminate the algorithm</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-algorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-algorithm-name-9\"><code>name</code></a> member of\n                  <var>normalizedAlgorithm</var> is not equal to the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-8\"><code>name</code></a> attribute of the\n                  <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-13\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>wrappingKey</var> then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-14\"><code>[[usages]]</code></a> internal slot of\n                  <var>wrappingKey</var> does not contain an entry that is \"<code>wrapKey</code>\",\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the algorithm identified by the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-14\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var> does not support the export key operation, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a  <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-8\"><code>[[extractable]]</code></a> internal slot\n                  of <var>key</var> is false, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>exportedKey</var> be the result of performing the export key operation specified by\n                  the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-15\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var> using <var>key</var> and <var>format</var>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>\n                    If <var>format</var> is equal to the strings \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-6\"><code>raw</code></a>\",\n                    \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-5\"><code>pkcs8</code></a>\", or \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-5\"><code>spki</code></a>\":\n                  </dt>\n                  <dd>\n                    Let <var>bytes</var> be <var>exportedKey</var>.\n                  </dd>\n                  <dt>\n                    If <var>format</var> is equal to the string \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-5\"><code>jwk</code></a>\":\n                  </dt>\n                  <dd>\n                    \n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is equal to the strings \"raw\", \"pkcs8\", or \"spki\":",
                  "html": "Let <var>bytes</var> be <var>exportedKey</var>."
                },
                {
                  "case": "If format is equal to the string \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>json</var> be the result of representing <var>exportedKey</var> as a\n                          UTF-16 string conforming to the JSON grammar; for example, by executing\n                          the <code>JSON.stringify</code> algorithm specified in\n                          [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-ecma-262\" title=\"ECMAScript Language Specification\">ECMA-262</a></cite>] in the context of a new global object.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>bytes</var> be the result of <a data-link-type=\"dfn\" data-lt=\"UTF-8 encode\" href=\"https://encoding.spec.whatwg.org/#utf-8-encode\">UTF-8 encoding</a> <var>json</var>.\n                        </p>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>normalizedAlgorithm</var> supports the wrap key operation:</dt>\n                  <dd>\n                    <p>\n                      Let <var>result</var> be the result of performing the wrap key operation\n                      specified by <var>normalizedAlgorithm</var> using <var>algorithm</var>,\n                      <var>wrappingKey</var> as <var>key</var> and <var>bytes</var> as\n                      <var>plaintext</var>.\n                    </p>\n                  </dd>\n                  <dt>Otherwise, if <var>normalizedAlgorithm</var> supports the encrypt operation:</dt>\n                  <dd>\n                    <p>\n                      Let <var>result</var> be the result of performing the encrypt operation\n                      specified by <var>normalizedAlgorithm</var> using <var>algorithm</var>,\n                      <var>wrappingKey</var> as <var>key</var> and <var>bytes</var> as\n                      <var>plaintext</var>.\n                    </p>\n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If normalizedAlgorithm supports the wrap key operation:",
                  "html": "<p>\n                      Let <var>result</var> be the result of performing the wrap key operation\n                      specified by <var>normalizedAlgorithm</var> using <var>algorithm</var>,\n                      <var>wrappingKey</var> as <var>key</var> and <var>bytes</var> as\n                      <var>plaintext</var>.\n                    </p>"
                },
                {
                  "case": "Otherwise, if normalizedAlgorithm supports the encrypt operation:",
                  "html": "<p>\n                      Let <var>result</var> be the result of performing the encrypt operation\n                      specified by <var>normalizedAlgorithm</var> using <var>algorithm</var>,\n                      <var>wrappingKey</var> as <var>key</var> and <var>bytes</var> as\n                      <var>plaintext</var>.\n                    </p>"
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-22\">crypto task source</a>,\n                  given <var>realm</var>'s global object, to perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of <a data-link-type=\"dfn\" data-lt=\"create\" href=\"https://webidl.spec.whatwg.org/#arraybuffer-create\">creating</a> an <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a>\n                  in <var>realm</var>, containing <var>result</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "name": "SubtleCrypto/unwrapKey()",
      "href": "https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-unwrapKey",
      "html": "When invoked, the <dfn id=\"dfn-SubtleCrypto-method-unwrapKey\" data-dfn-for=\"SubtleCrypto\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"unwrapKey\" data-type=\"Promise\" data-lt=\"unwrapKey()|unwrapKey(format, wrappedKey, unwrappingKey, unwrapAlgorithm, unwrappedKeyAlgorithm, extractable, keyUsages)\" data-local-lt=\"SubtleCrypto.unwrapKey|SubtleCrypto.unwrapKey()|unwrapKey\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>unwrapKey</code></dfn> method\n              <em class=\"rfc2119\">MUST</em> perform the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>format</var>, <var>unwrappingKey</var>,\n                  <var>algorithm</var>, <var>unwrappedKeyAlgorithm</var>,\n                  <var>extractable</var> and <var>usages</var>,\n                  be the <code>format</code>, <code>unwrappingKey</code>,\n                  <code>unwrapAlgorithm</code>, <code>unwrappedKeyAlgorithm</code>,\n                  <code>extractable</code> and <code>keyUsages</code>\n                  parameters passed to the\n                  <a data-link-type=\"idl\" data-lt=\"unwrapKey()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-unwrapKey\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-unwrapKey-2\"><code>unwrapKey</code></a><code>()</code> method,\n                  respectively.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>wrappedKey</var> be the result of\n                  <a data-link-type=\"dfn\" data-lt=\"get a copy of the buffer source\" href=\"https://webidl.spec.whatwg.org/#dfn-get-buffer-source-copy\">getting a copy of the bytes held by</a> the\n                  <code>wrappedKey</code> parameter passed to the\n                  <a data-link-type=\"idl\" data-lt=\"unwrapKey()\" href=\"https://w3c.github.io/webcrypto/#dfn-SubtleCrypto-method-unwrapKey\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-unwrapKey-3\"><code>unwrapKey</code></a><code>()</code> method.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-14\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  \"<code>unwrapKey</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, let <var>normalizedAlgorithm</var> be the result of\n                  <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-15\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>algorithm</var> and <code>op</code> set to\n                  \"<code>decrypt</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>normalizedKeyAlgorithm</var> be the result of <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-16\">normalizing an algorithm</a>, with\n                  <code>alg</code> set to <var>unwrappedKeyAlgorithm</var> and <code>op</code> set\n                  to \"<code>importKey</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  If an error occurred, return a Promise rejected with\n                  <var>normalizedKeyAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>realm</var> be the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\">relevant realm</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>promise</var> be a new Promise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>promise</var> and perform the remaining steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the following steps or referenced procedures say to\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an error,\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-23\">crypto task source</a>,\n                  given <var>realm</var>'s global object,\n                  to reject <var>promise</var> with the returned error;\n                  and then <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#terminate-the-algorithm\" class=\"internalDFN\" id=\"ref-for-terminate-the-algorithm-14\">terminate the algorithm</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-algorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-algorithm-name-10\"><code>name</code></a> member of\n                  <var>normalizedAlgorithm</var> is not equal to the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-9\"><code>name</code></a> attribute of the\n                  <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-16\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>unwrappingKey</var> then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-15\"><code>[[usages]]</code></a> internal slot of\n                  <var>unwrappingKey</var> does not contain an entry that is\n                  \"<code>unwrapKey</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>normalizedAlgorithm</var> supports an unwrap key operation:</dt>\n                  <dd>\n                    Let <var>bytes</var> be the result of performing the unwrap key operation\n                    specified by <var>normalizedAlgorithm</var> using <var>algorithm</var>,\n                    <var>unwrappingKey</var> as <var>key</var> and <var>wrappedKey</var> as\n                    <var>ciphertext</var>.\n                  </dd>\n                  <dt>\n                    Otherwise, if <var>normalizedAlgorithm</var> supports a decrypt\n                    operation:\n                  </dt>\n                  <dd>\n                    Let <var>bytes</var> be the result of performing the decrypt operation specified\n                    by <var>normalizedAlgorithm</var> using <var>algorithm</var>,\n                    <var>unwrappingKey</var> as <var>key</var> and <var>wrappedKey</var> as\n                    <var>ciphertext</var>.\n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If normalizedAlgorithm supports an unwrap key operation:",
                  "html": "Let <var>bytes</var> be the result of performing the unwrap key operation\n                    specified by <var>normalizedAlgorithm</var> using <var>algorithm</var>,\n                    <var>unwrappingKey</var> as <var>key</var> and <var>wrappedKey</var> as\n                    <var>ciphertext</var>."
                },
                {
                  "case": "Otherwise, if normalizedAlgorithm supports a decrypt operation:",
                  "html": "Let <var>bytes</var> be the result of performing the decrypt operation specified\n                    by <var>normalizedAlgorithm</var> using <var>algorithm</var>,\n                    <var>unwrappingKey</var> as <var>key</var> and <var>wrappedKey</var> as\n                    <var>ciphertext</var>."
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>\n                    If <var>format</var> is equal to the strings \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-8\"><code>raw</code></a>\",\n                    \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-6\"><code>pkcs8</code></a>\", or \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-6\"><code>spki</code></a>\":\n                  </dt>\n                  <dd>\n                    Let <var>key</var> be <var>bytes</var>.\n                  </dd>\n                  <dt>\n                    If <var>format</var> is equal to the string \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-6\"><code>jwk</code></a>\":\n                  </dt>\n                  <dd>\n                    Let <var>key</var> be the result of executing the\n                    <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-a-jwk\" class=\"internalDFN\" id=\"ref-for-concept-parse-a-jwk-1\">parse a JWK</a> algorithm, with <var>bytes</var>\n                    as the <code>data</code> to be parsed.\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is equal to the strings \"raw\", \"pkcs8\", or \"spki\":",
                  "html": "Let <var>key</var> be <var>bytes</var>."
                },
                {
                  "case": "If format is equal to the string \"jwk\":",
                  "html": "Let <var>key</var> be the result of executing the\n                    <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-a-jwk\" class=\"internalDFN\" id=\"ref-for-concept-parse-a-jwk-1\">parse a JWK</a> algorithm, with <var>bytes</var>\n                    as the <code>data</code> to be parsed."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of performing the import key operation\n                  specified by <var>normalizedKeyAlgorithm</var> using\n                  <var>unwrappedKeyAlgorithm</var> as <var>algorithm</var>, <var>format</var>,\n                  <var>usages</var>\n                  and <var>extractable</var> and with\n                  <var>key</var> as <var>keyData</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-7\"><code>[[type]]</code></a> internal slot of\n                  <var>result</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-secret\" class=\"internalDFN\" id=\"ref-for-dom-keytype-secret-5\"><code>secret</code></a>\" or \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-5\"><code>private</code></a>\" and\n                  <var>usages</var> is empty, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-9\"><code>[[extractable]]</code></a> internal\n                  slot of <var>result</var> to <var>extractable</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-16\"><code>[[usages]]</code></a> internal\n                  slot of <var>result</var> to the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-normalized-usages\" class=\"internalDFN\" id=\"ref-for-concept-normalized-usages-3\">normalized value</a> of <var>usages</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-crypto-task-source-0\" class=\"internalDFN\" id=\"ref-for-dfn-crypto-task-source-0-24\">crypto task source</a>,\n                  given <var>realm</var>'s global object, to perform the remaining steps.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of converting <var>result</var> to an ECMAScript Object in <var>realm</var>,\n                  as defined by [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>].\n                </p>"
        },
        {
          "html": "<p>\n                  Resolve <var>promise</var> with\n                  <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "html": "The initial contents of this internal object are as follows:",
      "rationale": "for",
      "steps": [
        {
          "html": "<p>\n                  For each value, <var>v</var> in the List of <a href=\"https://w3c.github.io/webcrypto/#supported-operation\" id=\"ref-for-supported-operation-4\">supported operations</a>, set the <var>v</var> key of\n                   the internal object <a data-link-type=\"idl\" data-lt=\"supportedAlgorithms\" href=\"https://w3c.github.io/webcrypto/#dfn-supportedAlgorithms\" class=\"internalDFN\" id=\"ref-for-dfn-supportedAlgorithms-1\"><code>supportedAlgorithms</code></a>\n                   to a new associative container.\n                </p>"
        }
      ]
    },
    {
      "name": "define an algorithm",
      "href": "https://w3c.github.io/webcrypto/#concept-define-an-algorithm",
      "html": "The <dfn id=\"concept-define-an-algorithm\" tabindex=\"0\" aria-haspopup=\"dialog\" data-dfn-type=\"dfn\">define an algorithm</dfn> algorithm is used\n              by specification authors to indicate how a user agent should normalize arguments for a\n              particular algorithm. Its input is an algorithm name <var>alg</var>, represented as a\n              DOMString, operation name <var>op</var>, represented as a DOMString, and desired IDL\n              dictionary type <var>type</var>. The algorithm behaves as follows:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var>registeredAlgorithms</var> be the associative container stored at the\n                <var>op</var> key of <a data-link-type=\"idl\" data-lt=\"supportedAlgorithms\" href=\"https://w3c.github.io/webcrypto/#dfn-supportedAlgorithms\" class=\"internalDFN\" id=\"ref-for-dfn-supportedAlgorithms-2\"><code>supportedAlgorithms</code></a>."
        },
        {
          "html": "Set the <var>alg</var> key of <var>registeredAlgorithms</var> to the IDL dictionary\n                type <var>type</var>."
        }
      ]
    },
    {
      "name": "normalize an algorithm",
      "href": "https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm",
      "html": "The <dfn id=\"dfn-normalize-an-algorithm\" tabindex=\"0\" aria-haspopup=\"dialog\" data-dfn-type=\"dfn\">normalize an algorithm</dfn> algorithm defines\n              a process for coercing inputs to a targeted IDL dictionary type, after Web IDL\n              conversion has occurred. It is designed to be extensible, to allow future specifications\n              to define additional algorithms, as well as safe for use with Promises. Its input is an\n              operation name <var>op</var> and an <a data-link-type=\"idl\" data-lt=\"AlgorithmIdentifier\" href=\"https://w3c.github.io/webcrypto/#dom-algorithmidentifier\" class=\"internalDFN\" id=\"ref-for-dom-algorithmidentifier-22\"><code>AlgorithmIdentifier</code></a> <var>alg</var>. Its output is\n              either an IDL dictionary type or an error. It behaves as follows:",
      "rationale": ".switch",
      "steps": [
        {
          "operation": "switch",
          "steps": [
            {
              "case": "If alg is an instance of a DOMString:",
              "html": "<p>\n                  Return the result of running the <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-17\">normalize an algorithm</a> algorithm, with\n                  the <code>alg</code> set to a new <a data-link-type=\"idl\" data-lt=\"Algorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-Algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-Algorithm-4\"><code>Algorithm</code></a>\n                  dictionary whose <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-10\"><code>name</code></a> attribute is\n                  <var>alg</var>, and with the <code>op</code> set to <var>op</var>.\n                </p>"
            },
            {
              "case": "If alg is an object:",
              "html": "",
              "rationale": "let",
              "steps": [
                {
                  "html": "Let <var>registeredAlgorithms</var> be the associative container stored at the\n                    <code>op</code> key of <a data-link-type=\"idl\" data-lt=\"supportedAlgorithms\" href=\"https://w3c.github.io/webcrypto/#dfn-supportedAlgorithms\" class=\"internalDFN\" id=\"ref-for-dfn-supportedAlgorithms-3\"><code>supportedAlgorithms</code></a>."
                },
                {
                  "html": "Let <var>initialAlg</var> be the result of converting the ECMAScript object\n                    represented by <var>alg</var> to the IDL dictionary type <a data-link-type=\"idl\" data-lt=\"Algorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-Algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-Algorithm-5\"><code>Algorithm</code></a>, as defined by [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>]."
                },
                {
                  "html": "If an error occurred, return the error and terminate this algorithm."
                },
                {
                  "html": "Let <var>algName</var> be the value of the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-algorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-algorithm-name-11\"><code>name</code></a>\n                    attribute of <var>initialAlg</var>."
                },
                {
                  "html": "<dl class=\"switch\">\n                      <dt>\n                        If <var>registeredAlgorithms</var> contains a key that is a\n                        <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#case-insensitive\" class=\"internalDFN\" id=\"ref-for-case-insensitive-1\">case-insensitive</a> string match for\n                        <var>algName</var>:\n                      </dt>\n                      <dd>\n                        \n                      </dd>\n                      <dt>Otherwise:</dt>\n                      <dd>\n                        Return a new <code>NotSupportedError</code> and terminate this algorithm.\n                      </dd>\n                    </dl>",
                  "rationale": ".switch",
                  "steps": [
                    {
                      "operation": "switch",
                      "steps": [
                        {
                          "case": "If registeredAlgorithms contains a key that is a case-insensitive string match for algName:",
                          "html": "",
                          "rationale": "set",
                          "steps": [
                            {
                              "html": "<p>\n                              Set <var>algName</var> to the value of the matching key.\n                            </p>"
                            },
                            {
                              "html": "<p>\n                              Let <var>desiredType</var> be the IDL dictionary type stored at\n                              <var>algName</var> in <var>registeredAlgorithms</var>.\n                            </p>"
                            }
                          ]
                        },
                        {
                          "case": "Otherwise:",
                          "html": "Return a new <code>NotSupportedError</code> and terminate this algorithm."
                        }
                      ]
                    }
                  ]
                },
                {
                  "html": "Let <var>normalizedAlgorithm</var> be the result of converting the ECMAScript\n                    object represented by <var>alg</var> to the IDL dictionary type\n                    <var>desiredType</var>, as defined by [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>]."
                },
                {
                  "html": "Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-algorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-algorithm-name-12\"><code>name</code></a> attribute of\n                    <var>normalizedAlgorithm</var> to <var>algName</var>."
                },
                {
                  "html": "If an error occurred, return the error and terminate this algorithm."
                },
                {
                  "html": "Let <var>dictionaries</var> be a list consisting of the IDL dictionary type\n                    <var>desiredType</var> and all of <var>desiredType</var>'s inherited dictionaries,\n                    in order from least to most derived."
                },
                {
                  "html": "For each dictionary <var>dictionary</var> in <var>dictionaries</var>:",
                  "rationale": "for",
                  "steps": [
                    {
                      "html": "For each dictionary member <var>member</var> declared on\n                          <var>dictionary</var>, in order:",
                      "rationale": "let",
                      "steps": [
                        {
                          "html": "Let <var>key</var> be the identifier of <var>member</var>."
                        },
                        {
                          "html": "Let <var>idlValue</var> be the value of the dictionary member with\n                            key name of <var>key</var> on <var>normalizedAlgorithm</var>."
                        },
                        {
                          "html": "<dl class=\"switch\">\n                              <dt>\n                                If <var>member</var> is of the type\n                                <a data-link-type=\"typedef\" data-lt=\"BufferSource\" href=\"https://webidl.spec.whatwg.org/#BufferSource\"><code>BufferSource</code></a> and is\n                                present:\n                              </dt>\n                              <dd>\n                                Set the dictionary member on <var>normalizedAlgorithm</var> with key\n                                name <var>key</var> to the result of\n                                <a data-link-type=\"dfn\" data-lt=\"get a copy of the buffer source\" href=\"https://webidl.spec.whatwg.org/#dfn-get-buffer-source-copy\">getting a copy of the bytes held by</a>\n                                <var>idlValue</var>, replacing the current value.\n                              </dd>\n                              <dt>\n                                If <var>member</var> is of the type\n                                <a data-link-type=\"idl\" data-lt=\"HashAlgorithmIdentifier\" href=\"https://w3c.github.io/webcrypto/#dom-hashalgorithmidentifier\" class=\"internalDFN\" id=\"ref-for-dom-hashalgorithmidentifier-1\"><code>HashAlgorithmIdentifier</code></a>:\n                              </dt>\n                              <dd>\n                                Set the dictionary member on <var>normalizedAlgorithm</var> with key\n                                name <var>key</var> to the result of\n                                <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-18\">normalizing an algorithm</a>,\n                                with the <code>alg</code> set to <var>idlValue</var> and the\n                                <code>op</code> set to \"<code>digest</code>\".\n                              </dd>\n                              <dt>\n                                If <var>member</var> is of the type\n                                <a data-link-type=\"idl\" data-lt=\"AlgorithmIdentifier\" href=\"https://w3c.github.io/webcrypto/#dom-algorithmidentifier\" class=\"internalDFN\" id=\"ref-for-dom-algorithmidentifier-23\"><code>AlgorithmIdentifier</code></a>:\n                              </dt>\n                              <dd>\n                                Set the dictionary member on <var>normalizedAlgorithm</var> with key\n                                name <var>key</var> to the result of\n                                <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-19\">normalizing an algorithm</a>,\n                                with the <code>alg</code> set to <var>idlValue</var> and the\n                                <code>op</code> set to the operation defined by the specification\n                                that defines the algorithm identified by <var>algName</var>.\n                              </dd>\n                            </dl>",
                          "rationale": ".switch",
                          "steps": [
                            {
                              "operation": "switch",
                              "steps": [
                                {
                                  "case": "If member is of the type BufferSource and is present:",
                                  "html": "Set the dictionary member on <var>normalizedAlgorithm</var> with key\n                                name <var>key</var> to the result of\n                                <a data-link-type=\"dfn\" data-lt=\"get a copy of the buffer source\" href=\"https://webidl.spec.whatwg.org/#dfn-get-buffer-source-copy\">getting a copy of the bytes held by</a>\n                                <var>idlValue</var>, replacing the current value."
                                },
                                {
                                  "case": "If member is of the type HashAlgorithmIdentifier:",
                                  "html": "Set the dictionary member on <var>normalizedAlgorithm</var> with key\n                                name <var>key</var> to the result of\n                                <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-18\">normalizing an algorithm</a>,\n                                with the <code>alg</code> set to <var>idlValue</var> and the\n                                <code>op</code> set to \"<code>digest</code>\"."
                                },
                                {
                                  "case": "If member is of the type AlgorithmIdentifier:",
                                  "html": "Set the dictionary member on <var>normalizedAlgorithm</var> with key\n                                name <var>key</var> to the result of\n                                <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-19\">normalizing an algorithm</a>,\n                                with the <code>alg</code> set to <var>idlValue</var> and the\n                                <code>op</code> set to the operation defined by the specification\n                                that defines the algorithm identified by <var>algName</var>."
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "html": "If an error occurred, return the error and terminate this algorithm."
                        }
                      ]
                    }
                  ]
                },
                {
                  "html": "Return <var>normalizedAlgorithm</var>."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-8\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> is not \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-6\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Perform the signature generation operation defined in Section 8.2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>] with the key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-6\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n                  as the signer's private key and <var>message</var> as\n                  <var>M</var> and using the hash function specified in the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-hash-2\"><code>hash</code></a> attribute of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-17\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var> as the Hash option for the EMSA-PKCS1-v1_5 encoding method.\n                </p>"
        },
        {
          "html": "<p>\n                  If performing the operation results in an error,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>signature</var> be the value <var>S</var> that results from\n                  performing the operation.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>signature</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-9\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Perform the signature verification operation defined in Section 8.2 of\n                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>] with the key represented by the\n                  <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-7\"><code>[[handle]]</code></a> internal slot of\n                  <var>key</var> as the signer's RSA public key and <var>message</var> as\n                  <var>M</var> and\n                  <var>signature</var> as <var>S</var> and using the hash function specified\n                  in the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-hash-3\"><code>hash</code></a> attribute of the\n                  <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-18\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var> as the Hash option for the EMSA-PKCS1-v1_5 encoding method.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be a boolean with value true if the\n                  result of the operation was \"valid signature\" and the value\n                  false otherwise.\n                </p>"
        },
        {
          "html": "<p>Return <var>result</var>.</p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>usages</var> contains an entry which is not\n                   \"<code>sign</code>\" or \"<code>verify</code>\",\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Generate an RSA key pair, as defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>], with RSA modulus length equal to the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyGenParams-modulusLength\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyGenParams-modulusLength-2\"><code>modulusLength</code></a> attribute of\n                  <var>normalizedAlgorithm</var> and RSA public exponent equal to the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyGenParams-publicExponent\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyGenParams-publicExponent-2\"><code>publicExponent</code></a> attribute of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  If generation of the key pair fails,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"RsaHashedKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-2\"><code>RsaHashedKeyAlgorithm</code></a>\n                  dictionary.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-11\"><code>name</code></a> attribute of\n                  <var>algorithm</var> to \"<code>RSASSA-PKCS1-v1_5</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyAlgorithm-modulusLength\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyAlgorithm-modulusLength-2\"><code>modulusLength</code></a>\n                  attribute of <var>algorithm</var> to equal the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyGenParams-modulusLength\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyGenParams-modulusLength-3\"><code>modulusLength</code></a>\n                  attribute of <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyAlgorithm-publicExponent\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyAlgorithm-publicExponent-2\"><code>publicExponent</code></a>\n                  attribute of <var>algorithm</var> to equal the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyGenParams-publicExponent\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyGenParams-publicExponent-3\"><code>publicExponent</code></a>\n                  attribute of <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-hash-4\"><code>hash</code></a> attribute\n                  of <var>algorithm</var> to equal the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyGenParams-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyGenParams-hash-2\"><code>hash</code></a> member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>publicKey</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-44\"><code>CryptoKey</code></a>\n                  representing the public key of the generated key pair.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-10\"><code>[[type]]</code></a> internal slot of\n                  <var>publicKey</var> to \"<code>public</code>\"\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-19\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>publicKey</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-10\"><code>[[extractable]]</code></a> internal\n                  slot of <var>publicKey</var> to true.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-17\"><code>[[usages]]</code></a> internal slot of\n                  <var>publicKey</var> to be the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-usage-intersection\" class=\"internalDFN\" id=\"ref-for-concept-usage-intersection-2\">usage intersection</a> of <var>usages</var> and <code>[ \"verify\" ]</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>privateKey</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-45\"><code>CryptoKey</code></a>\n                  representing the private key of the generated key pair.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-11\"><code>[[type]]</code></a> internal slot of\n                  <var>privateKey</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-7\"><code>private</code></a>\"\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-20\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>privateKey</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-11\"><code>[[extractable]]</code></a> internal\n                  slot of <var>privateKey</var> to <var>extractable</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-18\"><code>[[usages]]</code></a> internal slot of\n                  <var>privateKey</var> to be the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-usage-intersection\" class=\"internalDFN\" id=\"ref-for-concept-usage-intersection-3\">usage intersection</a> of <var>usages</var> and <code>[ \"sign\" ]</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKeyPair\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-5\"><code>CryptoKeyPair</code></a>\n                  dictionary.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair-publicKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-publicKey-2\"><code>publicKey</code></a> attribute\n                  of <var>result</var> to be <var>publicKey</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair-privateKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-privateKey-3\"><code>privateKey</code></a> attribute\n                  of <var>result</var> to be <var>privateKey</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-7\"><code>spki</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-7\"><code>pkcs8</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-7\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If <var>usages</var> contains an entry which is not\n                          \"<code>verify</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>spki</var> be the result of running the\n                          <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-a-spki\" class=\"internalDFN\" id=\"ref-for-concept-parse-a-spki-1\">parse a subjectPublicKeyInfo</a>\n                          algorithm over <var>keyData</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurred while parsing,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>algorithm</code> object identifier field of the\n                          <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is\n                          not equal to the <code>rsaEncryption</code>\n                          object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>publicKey</var> be the result of performing the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-an-asn1-structure\" class=\"internalDFN\" id=\"ref-for-concept-parse-an-asn1-structure-3\">parse an ASN.1 structure</a>\n                          algorithm, with <var>data</var> as the\n                          <code>subjectPublicKeyInfo</code> field of <var>spki</var>,\n                          <var>structure</var> as the <code>RSAPublicKey</code> structure\n                          specified in Section A.1.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>], and\n                          <var>exactData</var> set to true.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurred while parsing, or it can be determined that <var>publicKey</var>\n                          is not a valid public key according to [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-46\"><code>CryptoKey</code></a>\n                          that represents the RSA public key identified by\n                          <var>publicKey</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-12\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> to \"<code>public</code>\"\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If <var>usages</var> contains an entry which is not\n                           \"<code>sign</code>\"\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>privateKeyInfo</var> be the result of running the\n                          <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-a-privateKeyInfo\" class=\"internalDFN\" id=\"ref-for-concept-parse-a-privateKeyInfo-1\">parse a privateKeyInfo</a>\n                          algorithm over <var>keyData</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurred while parsing,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>algorithm</code> object identifier field of the\n                          <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of\n                          <var>privateKeyInfo</var> is not equal to the\n                          <code>rsaEncryption</code> object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>rsaPrivateKey</var> be the result of performing the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-an-asn1-structure\" class=\"internalDFN\" id=\"ref-for-concept-parse-an-asn1-structure-4\">parse an ASN.1 structure</a>\n                          algorithm, with <var>data</var> as the\n                          <code>privateKey</code> field of <var>privateKeyInfo</var>,\n                          <var>structure</var> as the <code>RSAPrivateKey</code> structure\n                          specified in Section A.1.2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>], and\n                          <var>exactData</var> set to true.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurred while parsing, or if <var>rsaPrivateKey</var> is not\n                          a valid RSA private key according to [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-47\"><code>CryptoKey</code></a>\n                          that represents the RSA private key identified by\n                          <var>rsaPrivateKey</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-13\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-8\"><code>private</code></a>\"\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If <var>keyData</var> is a <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-8\"><code>JsonWebKey</code></a> dictionary:</dt>\n                          <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                          <dt>Otherwise:</dt>\n                          <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-1\"><code>d</code></a> field of <var>jwk</var> is present and\n                          <var>usages</var> contains an entry which is not\n                          \"<code>sign</code>\", or, if the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-2\"><code>d</code></a> field of <var>jwk</var>\n                          is not present and\n                          <var>usages</var> contains an entry which is not\n                          \"<code>verify</code>\"\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-kty\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-kty-2\"><code>kty</code></a> field of <var>jwk</var> is not a\n                          case-sensitive string match to \"<code>RSA</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>usages</var> is non-empty and the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-use\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-use-1\"><code>use</code></a> field of <var>jwk</var> is present and is\n                          not a case-sensitive string match to \"<code>sig</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-key_ops\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-key_ops-1\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                          is invalid according to the requirements of\n                          JSON Web Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>] or\n                          does not contain all of the specified <var>usages</var> values,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-ext\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-ext-3\"><code>ext</code></a> field of <var>jwk</var> is present and\n                          has the value false and <var>extractable</var> is true,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>hash</var> be a be a string whose initial value is\n                          undefined.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-1\"><code>alg</code></a> field of <var>jwk</var> is not\n                            present:\n                          </dt>\n                          <dd>\n                            <p>\n                              Let <var>hash</var> be undefined.\n                            </p>\n                          </dd>\n                          <dt>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-2\"><code>alg</code></a> field is equal to the string\n                            \"<code>RS1</code>\":\n                          </dt>\n                          <dd>\n                            <p>\n                              Let <var>hash</var> be the string \"<code>SHA-1</code>\".\n                            </p>\n                          </dd>\n                          <dt>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-3\"><code>alg</code></a> field is equal to the string\n                            \"<code>RS256</code>\":\n                          </dt>\n                          <dd>\n                            <p>\n                              Let <var>hash</var> be the string \"<code>SHA-256</code>\".\n                            </p>\n                          </dd>\n                          <dt>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-4\"><code>alg</code></a> field is equal to the string\n                            \"<code>RS384</code>\":\n                          </dt>\n                          <dd>\n                            <p>\n                              Let <var>hash</var> be the string \"<code>SHA-384</code>\".\n                            </p>\n                          </dd>\n                          <dt>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-5\"><code>alg</code></a> field is equal to the string\n                            \"<code>RS512</code>\":\n                          </dt>\n                          <dd>\n                            <p>\n                              Let <var>hash</var> be the string \"<code>SHA-512</code>\".\n                            </p>\n                          </dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the alg field of jwk is not present:",
                              "html": "<p>\n                              Let <var>hash</var> be undefined.\n                            </p>"
                            },
                            {
                              "case": "If the alg field is equal to the string \"RS1\":",
                              "html": "<p>\n                              Let <var>hash</var> be the string \"<code>SHA-1</code>\".\n                            </p>"
                            },
                            {
                              "case": "If the alg field is equal to the string \"RS256\":",
                              "html": "<p>\n                              Let <var>hash</var> be the string \"<code>SHA-256</code>\".\n                            </p>"
                            },
                            {
                              "case": "If the alg field is equal to the string \"RS384\":",
                              "html": "<p>\n                              Let <var>hash</var> be the string \"<code>SHA-384</code>\".\n                            </p>"
                            },
                            {
                              "case": "If the alg field is equal to the string \"RS512\":",
                              "html": "<p>\n                              Let <var>hash</var> be the string \"<code>SHA-512</code>\".\n                            </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"RSASSA-PKCS1-v1_5 key import steps\" href=\"https://w3c.github.io/webcrypto/#dfn-rsa-ssa-extended-import-steps\" class=\"internalDFN\" id=\"ref-for-dfn-rsa-ssa-extended-import-steps-1\">key import steps</a> defined by\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-2\">other applicable\n                                  specifications</a>, passing <var>format</var>, <var>jwk</var>\n                                  and obtaining <var>hash</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If an error occurred or there are no\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-3\">applicable\n                                  specifications</a>,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<dl>\n                          <dt>\n                            If <var>hash</var> is not undefined:\n                          </dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": "let",
                      "steps": [
                        {
                          "html": "<p>\n                                  Let <var>normalizedHash</var> be the result of\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-20\">normalize an algorithm</a>\n                                  with <code>alg</code> set to <var>hash</var> and <code>op</code> set\n                                  to <code>digest</code>.\n                                </p>"
                        },
                        {
                          "html": "<p>\n                                  If <var>normalizedHash</var> is not equal to the\n                                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedImportParams-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedImportParams-hash-2\"><code>hash</code></a> member of\n                                  <var>normalizedAlgorithm</var>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                        }
                      ]
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-3\"><code>d</code></a> field of <var>jwk</var> is present:</dt>\n                          <dd>\n                            \n                          </dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the d field of jwk is present:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                  If <var>jwk</var> does not meet the requirements of\n                                  Section 6.3.2 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>],\n                                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>privateKey</var> represents the\n                                  RSA private key identified by interpreting <var>jwk</var>\n                                  according to Section 6.3.2 of JSON Web\n                                  Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If <var>privateKey</var> is not a valid RSA private key\n                                  according to [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>],\n                                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-48\"><code>CryptoKey</code></a> object that represents\n                                  <var>privateKey</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-14\"><code>[[type]]</code></a>\n                                  internal slot of <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-9\"><code>private</code></a>\"\n                                </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                  If <var>jwk</var> does not meet the requirements of Section\n                                  6.3.1 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>], then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>publicKey</var> represent the\n                                  RSA public key identified by interpreting <var>jwk</var>\n                                  according to Section 6.3.1 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If <var>publicKey</var> can be determined to not be a valid RSA public key\n                                  according to [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>],\n                                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-49\"><code>CryptoKey</code></a> representing <var>publicKey</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-15\"><code>[[type]]</code></a>\n                                  internal slot of <var>key</var> to \"<code>public</code>\"\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"RsaHashedKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-3\"><code>RsaHashedKeyAlgorithm</code></a> dictionary.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-12\"><code>name</code></a> attribute of\n                  <var>algorithm</var> to \"<code>RSASSA-PKCS1-v1_5</code>\"\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyAlgorithm-modulusLength\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyAlgorithm-modulusLength-3\"><code>modulusLength</code></a>\n                  attribute of <var>algorithm</var> to the length, in bits, of the RSA public\n                  modulus.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyAlgorithm-publicExponent\" id=\"ref-for-dfn-RsaKeyAlgorithm-publicExponent-3\">publicExponent</a>\n                  attribute of <var>algorithm</var> to the <a href=\"https://w3c.github.io/webcrypto/#dfn-BigInteger\" id=\"ref-for-dfn-BigInteger-4\">BigInteger</a>\n                  representation of the RSA public exponent.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-hash-5\"><code>hash</code></a> attribute of\n                  <var>algorithm</var> to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedImportParams-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedImportParams-hash-3\"><code>hash</code></a> member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-21\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>key</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>Return <var>key</var>.</p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>key</var> be the key to be exported.\n                </p>"
        },
        {
          "html": "<p>\n                  If the underlying cryptographic key material represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-8\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n                  cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-8\"><code>spki</code></a>\"</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-8\"><code>pkcs8</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-8\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise</dt>\n                  <dd>\n                    <p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\"",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-16\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>data</var> be an instance of the <code>SubjectPublicKeyInfo</code>\n                          ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5280\" title=\"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile\">RFC5280</a></cite>]\n                          with the following properties:\n                        </p>\n                        <ul>\n                          <li>\n                            <p>\n                              Set the <var>algorithm</var> field to an\n                              <code>AlgorithmIdentifier</code> ASN.1 type with the following\n                              properties:\n                            </p>\n                            <ul>\n                              <li>\n                                <p>\n                                  Set the <var>algorithm</var> field to the OID\n                                  <code>rsaEncryption</code> defined in\n                                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>].\n                                </p>\n                              </li>\n                              <li>\n                                <p>\n                                  Set the <var>params</var> field to the ASN.1 type NULL.\n                                </p>\n                              </li>\n                            </ul>\n                          </li>\n                          <li>\n                            <p>\n                              Set the <var>subjectPublicKey</var> field to the result of\n                              DER-encoding an <code>RSAPublicKey</code> ASN.1 type, as defined\n                              in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>], Appendix A.1.1, that\n                              represents the RSA public key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-9\"><code>[[handle]]</code></a> internal slot of\n                              <var>key</var>\n                            </p>\n                          </li>\n                        </ul>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be the result of DER-encoding <var>data</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-17\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> is not \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-10\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>data</var> be an instance of the <code>PrivateKeyInfo</code>\n                          ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5208\" title=\"Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2\">RFC5208</a></cite>]\n                          with the following properties:\n                        </p>\n                        <ul>\n                          <li>\n                            <p>\n                              Set the <var>version</var> field to <code>0</code>.\n                            </p>\n                          </li>\n                          <li>\n                            <p>\n                              Set the <var>privateKeyAlgorithm</var> field to a\n                              <code>PrivateKeyAlgorithmIdentifier</code> ASN.1 type with the\n                              following properties:\n                            </p>\n                            <ul>\n                              <li>\n                                <p>\n                                  Set the <var>algorithm</var> field to the OID\n                                  <code>rsaEncryption</code> defined in\n                                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>].\n                                </p>\n                              </li>\n                              <li>\n                                <p>\n                                  Set the <var>params</var> field to the ASN.1 type NULL.\n                                </p>\n                              </li>\n                            </ul>\n                          </li>\n                          <li>\n                            <p>\n                              Set the <var>privateKey</var> field to the result of DER-encoding\n                              an <code>RSAPrivateKey</code> ASN.1 type, as defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>], Appendix A.1.2, that represents the\n                              RSA private key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-10\"><code>[[handle]]</code></a> internal slot of\n                              <var>key</var>\n                            </p>\n                            \n                          </li>\n                        </ul>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be the result of DER-encoding <var>data</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>Let <var>jwk</var> be a new <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-9\"><code>JsonWebKey</code></a>\n                        dictionary.</p>"
                    },
                    {
                      "html": "<p>Set the <code>kty</code> attribute of <var>jwk</var> to the string\n                        \"<code>RSA</code>\".</p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>hash</var> be the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-13\"><code>name</code></a>\n                          attribute of the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-hash-6\"><code>hash</code></a>\n                          attribute of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-22\"><code>[[algorithm]]</code></a>\n                          internal slot of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If <var>hash</var> is \"<code>SHA-1</code>\":</dt>\n                          <dd>\n                            <p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>RS1</code>\".\n                            </p>\n                          </dd>\n                          <dt>If <var>hash</var> is \"<code>SHA-256</code>\":</dt>\n                          <dd>\n                            <p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>RS256</code>\".\n                            </p>\n                          </dd>\n                          <dt>If <var>hash</var> is \"<code>SHA-384</code>\":</dt>\n                          <dd>\n                            <p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>RS384</code>\".\n                            </p>\n                          </dd>\n                          <dt>If <var>hash</var> is \"<code>SHA-512</code>\":</dt>\n                          <dd>\n                            <p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>RS512</code>\".\n                            </p>\n                          </dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If hash is \"SHA-1\":",
                              "html": "<p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>RS1</code>\".\n                            </p>"
                            },
                            {
                              "case": "If hash is \"SHA-256\":",
                              "html": "<p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>RS256</code>\".\n                            </p>"
                            },
                            {
                              "case": "If hash is \"SHA-384\":",
                              "html": "<p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>RS384</code>\".\n                            </p>"
                            },
                            {
                              "case": "If hash is \"SHA-512\":",
                              "html": "<p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>RS512</code>\".\n                            </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"RSASSA-PKCS1-v1_5 key import steps\" href=\"https://w3c.github.io/webcrypto/#dfn-rsa-ssa-extended-import-steps\" class=\"internalDFN\" id=\"ref-for-dfn-rsa-ssa-extended-import-steps-2\">key export steps</a> defined by\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-4\">other applicable\n                                  specifications</a>, passing <var>format</var>, <var>key</var>\n                                  and obtaining <var>alg</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If an error occurred or there are no\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-5\">applicable\n                                  specifications</a>,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Set the <code>alg</code> attribute of <var>jwk</var> to <var>alg</var>.\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Set the attributes <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-n\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-n-1\"><code>n</code></a> and <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-e\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-e-1\"><code>e</code></a> of <var>jwk</var>\n                          according to the corresponding definitions in JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>], Section 6.3.1.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-18\"><code>[[type]]</code></a> internal slot\n                            of <var>key</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-11\"><code>private</code></a>\":\n                          </dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the [[type]] internal slot of key is \"private\":",
                              "html": "",
                              "rationale": "set",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Set the attributes named <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-4\"><code>d</code></a>, <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-p\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-p-1\"><code>p</code></a>,\n                                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-q\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-q-1\"><code>q</code></a>, <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-dp\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-dp-1\"><code>dp</code></a>, <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-dq\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-dq-1\"><code>dq</code></a>, and\n                                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-qi\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-qi-1\"><code>qi</code></a> of <var>jwk</var> according to the\n                                  corresponding definitions in JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>], Section 6.3.2.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If the underlying RSA private key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-11\"><code>[[handle]]</code></a> internal slot\n                                  of <var>key</var> is represented by more than two primes, set\n                                  the attribute named <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-oth\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-oth-1\"><code>oth</code></a> of <var>jwk</var>\n                                  according to the corresponding definition in JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>], Section 6.3.2.7\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-usages\">usages</a> attribute of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>ext</code> attribute of <var>jwk</var> to the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-12\"><code>[[extractable]]</code></a> internal slot\n                          of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>jwk</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise",
                  "html": "<p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-19\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> is not \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-12\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Perform the signature generation operation defined in Section 8.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>] with the key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-12\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n                  as the signer's private key, <var>K</var>, and <var>message</var> as\n                  the message to be signed, <var>M</var>, and using the hash function specified\n                  by the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-hash-7\"><code>hash</code></a> attribute of the\n                  <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-23\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var> as the Hash option, MGF1 (defined in Section B.2.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>]) as the MGF option and the <a href=\"https://w3c.github.io/webcrypto/#dfn-RsaPssParams-saltLength\" id=\"ref-for-dfn-RsaPssParams-saltLength-2\">saltLength</a> member of\n                  <var>normalizedAlgorithm</var> as the salt length option for the\n                  EMSA-PSS-ENCODE operation.\n                </p>"
        },
        {
          "html": "<p>\n                  If performing the operation results in an error,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>signature</var> be the\n                  signature, S, that results from performing the operation.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>signature</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-20\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Perform the signature verification operation defined in Section 8.1 of\n                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>] with the key represented by the\n                  <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-13\"><code>[[handle]]</code></a> internal slot of\n                  <var>key</var> as the signer's RSA public key and <var>message</var> as\n                  <var>M</var> and\n                  <var>signature</var> as <var>S</var> and using the hash function specified\n                  by the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-hash-8\"><code>hash</code></a> attribute of the\n                  <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-24\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var> as the Hash option, MGF1 (defined in Section B.2.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>]) as the MGF option and the <a href=\"https://w3c.github.io/webcrypto/#dfn-RsaPssParams-saltLength\" id=\"ref-for-dfn-RsaPssParams-saltLength-3\">saltLength</a> member of\n                  <var>normalizedAlgorithm</var> as the salt length option for the\n                  EMSA-PSS-VERIFY operation.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be a boolean with the value true if the\n                  result of the operation was \"valid signature\" and the value\n                  false otherwise.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>usages</var> contains an entry which is not\n                  \"<code>sign</code>\" or \"<code>verify</code>\",\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Generate an RSA key pair, as defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>], with RSA modulus length equal to the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyGenParams-modulusLength\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyGenParams-modulusLength-4\"><code>modulusLength</code></a> member of\n                  <var>normalizedAlgorithm</var> and RSA public exponent equal to the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyGenParams-publicExponent\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyGenParams-publicExponent-4\"><code>publicExponent</code></a> member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  If performing the operation results in an error,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"RsaHashedKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-4\"><code>RsaHashedKeyAlgorithm</code></a>\n                  dictionary.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-14\"><code>name</code></a> attribute of\n                  <var>algorithm</var> to \"<code>RSA-PSS</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyAlgorithm-modulusLength\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyAlgorithm-modulusLength-4\"><code>modulusLength</code></a>\n                  attribute of <var>algorithm</var> to equal the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyGenParams-modulusLength\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyGenParams-modulusLength-5\"><code>modulusLength</code></a>\n                  member of <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyAlgorithm-publicExponent\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyAlgorithm-publicExponent-4\"><code>publicExponent</code></a>\n                  attribute of <var>algorithm</var> to equal the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyGenParams-publicExponent\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyGenParams-publicExponent-5\"><code>publicExponent</code></a>\n                  member of <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-hash-9\"><code>hash</code></a> attribute\n                  of <var>algorithm</var> to equal the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyGenParams-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyGenParams-hash-3\"><code>hash</code></a> member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>publicKey</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-51\"><code>CryptoKey</code></a>\n                  representing the public key of the generated key pair.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-21\"><code>[[type]]</code></a> internal slot of\n                  <var>publicKey</var> to \"<code>public</code>\"\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-25\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>publicKey</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-13\"><code>[[extractable]]</code></a> internal\n                  slot of <var>publicKey</var> to true.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-19\"><code>[[usages]]</code></a> internal slot of\n                  <var>publicKey</var> to be the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-usage-intersection\" class=\"internalDFN\" id=\"ref-for-concept-usage-intersection-4\">usage intersection</a> of <var>usages</var> and <code>[ \"verify\" ]</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>privateKey</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-52\"><code>CryptoKey</code></a>\n                  representing the private key of the generated key pair.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-22\"><code>[[type]]</code></a> internal slot of\n                  <var>privateKey</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-13\"><code>private</code></a>\"\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-26\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>privateKey</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-14\"><code>[[extractable]]</code></a> internal\n                  slot of <var>privateKey</var> to <var>extractable</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-20\"><code>[[usages]]</code></a> internal slot of\n                  <var>privateKey</var> to be the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-usage-intersection\" class=\"internalDFN\" id=\"ref-for-concept-usage-intersection-5\">usage intersection</a> of <var>usages</var> and <code>[ \"sign\" ]</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKeyPair\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-7\"><code>CryptoKeyPair</code></a>\n                  dictionary.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair-publicKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-publicKey-3\"><code>publicKey</code></a> attribute\n                  of <var>result</var> to <var>publicKey</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair-privateKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-privateKey-4\"><code>privateKey</code></a> attribute\n                  of <var>result</var> to <var>privateKey</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-9\"><code>spki</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-9\"><code>pkcs8</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-9\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If <var>usages</var> contains an entry which is not\n                          \"<code>verify</code>\"\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>spki</var> be the result of running the\n                          <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-a-spki\" class=\"internalDFN\" id=\"ref-for-concept-parse-a-spki-2\">parse a subjectPublicKeyInfo</a>\n                          algorithm over <var>keyData</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurred while parsing,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>algorithm</code> object identifier field of the\n                          <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is\n                          not equal to the <code>rsaEncryption</code>\n                          object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>publicKey</var> be the result of performing the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-an-asn1-structure\" class=\"internalDFN\" id=\"ref-for-concept-parse-an-asn1-structure-5\">parse an ASN.1 structure</a>\n                          algorithm, with <var>data</var> as the\n                          <code>subjectPublicKeyInfo</code> field of <var>spki</var>,\n                          <var>structure</var> as the <code>RSAPublicKey</code> structure\n                          specified in Section A.1.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>], and\n                          <var>exactData</var> set to true.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurred while parsing, or it can be determined that <var>publicKey</var>\n                          is not a valid public key according to [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-53\"><code>CryptoKey</code></a>\n                          that represents the RSA public key identified by\n                          <var>publicKey</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-23\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> to \"<code>public</code>\"\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If <var>usages</var> contains an entry which is not\n                          \"<code>sign</code>\"\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>privateKeyInfo</var> be the result of running the\n                          <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-a-privateKeyInfo\" class=\"internalDFN\" id=\"ref-for-concept-parse-a-privateKeyInfo-2\">parse a privateKeyInfo</a>\n                          algorithm over <var>keyData</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurred while parsing, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>algorithm</code> object identifier field of the\n                          <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of\n                          <var>privateKeyInfo</var> is not equal to the\n                          <code>rsaEncryption</code> object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>rsaPrivateKey</var> be the result of performing the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-an-asn1-structure\" class=\"internalDFN\" id=\"ref-for-concept-parse-an-asn1-structure-6\">parse an ASN.1 structure</a>\n                          algorithm, with <var>data</var> as the\n                          <code>privateKey</code> field of <var>privateKeyInfo</var>,\n                          <var>structure</var> as the <code>RSAPrivateKey</code> structure\n                          specified in Section A.1.2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>], and\n                          <var>exactData</var> set to true.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurred while parsing, or if <var>rsaPrivateKey</var> is not\n                          a valid RSA private key according to [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-54\"><code>CryptoKey</code></a>\n                          that represents the RSA private key identified by\n                          <var>rsaPrivateKey</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-24\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-14\"><code>private</code></a>\"\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If <var>keyData</var> is a <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-10\"><code>JsonWebKey</code></a> dictionary:</dt>\n                          <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                          <dt>Otherwise:</dt>\n                          <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-5\"><code>d</code></a> field of <var>jwk</var> is present and\n                          <var>usages</var> contains an entry which is not\n                          \"<code>sign</code>\", or, if the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-6\"><code>d</code></a> field of <var>jwk</var>\n                          is not present and\n                          <var>usages</var> contains an entry which is not\n                          \"<code>verify</code>\"\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-kty\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-kty-3\"><code>kty</code></a> field of <var>jwk</var> is not a\n                          case-sensitive string match to \"<code>RSA</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>usages</var> is non-empty and the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-use\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-use-2\"><code>use</code></a> field of <var>jwk</var> is present and is\n                          not a case-sensitive string match to \"<code>sig</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-key_ops\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-key_ops-2\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                          is invalid according to the requirements of\n                          JSON Web Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>] or\n                          does not contain all of the specified <var>usages</var> values,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-ext\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-ext-4\"><code>ext</code></a> field of <var>jwk</var> is present and\n                          has the value false and <var>extractable</var> is true,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-6\"><code>alg</code></a> field of <var>jwk</var> is not\n                            present:\n                          </dt>\n                          <dd>\n                            <p>\n                              Let <var>hash</var> be undefined.\n                            </p>\n                          </dd>\n                          <dt>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-7\"><code>alg</code></a> field is equal to the string\n                            \"<code>PS1</code>\":\n                          </dt>\n                          <dd>\n                            <p>\n                              Let <var>hash</var> be the string \"<code>SHA-1</code>\".\n                            </p>\n                          </dd>\n                          <dt>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-8\"><code>alg</code></a> field is equal to the string\n                            \"<code>PS256</code>\":\n                          </dt>\n                          <dd>\n                            <p>\n                              Let <var>hash</var> be the string \"<code>SHA-256</code>\".\n                            </p>\n                          </dd>\n                          <dt>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-9\"><code>alg</code></a> field is equal to the string\n                            \"<code>PS384</code>\":\n                          </dt>\n                          <dd>\n                            <p>\n                              Let <var>hash</var> be the string \"<code>SHA-384</code>\".\n                            </p>\n                          </dd>\n                          <dt>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-10\"><code>alg</code></a> field is equal to the string\n                            \"<code>PS512</code>\":\n                          </dt>\n                          <dd>\n                            <p>\n                              Let <var>hash</var> be the string \"<code>SHA-512</code>\".\n                            </p>\n                          </dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the alg field of jwk is not present:",
                              "html": "<p>\n                              Let <var>hash</var> be undefined.\n                            </p>"
                            },
                            {
                              "case": "If the alg field is equal to the string \"PS1\":",
                              "html": "<p>\n                              Let <var>hash</var> be the string \"<code>SHA-1</code>\".\n                            </p>"
                            },
                            {
                              "case": "If the alg field is equal to the string \"PS256\":",
                              "html": "<p>\n                              Let <var>hash</var> be the string \"<code>SHA-256</code>\".\n                            </p>"
                            },
                            {
                              "case": "If the alg field is equal to the string \"PS384\":",
                              "html": "<p>\n                              Let <var>hash</var> be the string \"<code>SHA-384</code>\".\n                            </p>"
                            },
                            {
                              "case": "If the alg field is equal to the string \"PS512\":",
                              "html": "<p>\n                              Let <var>hash</var> be the string \"<code>SHA-512</code>\".\n                            </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"RSA-PSS key import steps\" href=\"https://w3c.github.io/webcrypto/#dfn-rsa-pss-extended-import-steps\" class=\"internalDFN\" id=\"ref-for-dfn-rsa-pss-extended-import-steps-1\">key import steps</a> defined by\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-7\">other applicable\n                                  specifications</a>, passing <var>format</var>, <var>jwk</var>\n                                  and obtaining <var>hash</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If an error occurred or there are no\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-8\">applicable\n                                  specifications</a>,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<dl>\n                          <dt>\n                            If <var>hash</var> is not undefined:\n                          </dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": "let",
                      "steps": [
                        {
                          "html": "<p>\n                                  Let <var>normalizedHash</var> be the result of\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-21\">normalize an algorithm</a>\n                                  with <code>alg</code> set to <var>hash</var> and <code>op</code> set\n                                  to <code>digest</code>.\n                                </p>"
                        },
                        {
                          "html": "<p>\n                                  If <var>normalizedHash</var> is not equal to the\n                                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedImportParams-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedImportParams-hash-4\"><code>hash</code></a> member of\n                                  <var>normalizedAlgorithm</var>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                        }
                      ]
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-7\"><code>d</code></a> field of <var>jwk</var> is present:</dt>\n                          <dd>\n                            \n                          </dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the d field of jwk is present:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                  If <var>jwk</var> does not meet the requirements of\n                                  Section 6.3.2 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>],\n                                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>privateKey</var> represent the\n                                  RSA private key identified by interpreting <var>jwk</var>\n                                  according to Section 6.3.2 of JSON Web\n                                  Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If <var>privateKey</var> can be determined to not be a valid RSA private key\n                                  according to [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>],\n                                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-55\"><code>CryptoKey</code></a> representing <var>privateKey</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-25\"><code>[[type]]</code></a>\n                                  internal slot of <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-15\"><code>private</code></a>\"\n                                </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                  If <var>jwk</var> does not meet the requirements of Section\n                                  6.3.1 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>], then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>publicKey</var> represent the\n                                  RSA public key identified by interpreting <var>jwk</var>\n                                  according to Section 6.3.1 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If <var>publicKey</var> can be determined to not be a valid RSA public key\n                                  according to [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>],\n                                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-56\"><code>CryptoKey</code></a> representing <var>publicKey</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-26\"><code>[[type]]</code></a>\n                                  internal slot of <var>key</var> to \"<code>public</code>\"\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"RsaHashedKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-5\"><code>RsaHashedKeyAlgorithm</code></a> dictionary.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-15\"><code>name</code></a> attribute of\n                  <var>algorithm</var> to \"<code>RSA-PSS</code>\"\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyAlgorithm-modulusLength\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyAlgorithm-modulusLength-5\"><code>modulusLength</code></a>\n                  attribute of <var>algorithm</var> to the length, in bits, of the RSA public\n                  modulus.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyAlgorithm-publicExponent\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyAlgorithm-publicExponent-5\"><code>publicExponent</code></a>\n                  attribute of <var>algorithm</var> to the <a data-link-type=\"idl\" data-lt=\"BigInteger\" href=\"https://w3c.github.io/webcrypto/#dfn-BigInteger\" class=\"internalDFN\" id=\"ref-for-dfn-BigInteger-5\"><code>BigInteger</code></a>\n                  representation of the RSA public exponent.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-hash-10\"><code>hash</code></a> attribute of\n                  <var>algorithm</var> to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedImportParams-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedImportParams-hash-5\"><code>hash</code></a> member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-27\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>key</var> to <var>algorithm</var>\n                </p>"
        },
        {
          "html": "<p>Return <var>key</var>.</p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>key</var> be the key to be exported.\n                </p>"
        },
        {
          "html": "<p>\n                  If the underlying cryptographic key material represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-14\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n                  cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-10\"><code>spki</code></a>\"</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-10\"><code>pkcs8</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-10\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise</dt>\n                  <dd>\n                    <p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\"",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-27\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>data</var> be an instance of the <code>SubjectPublicKeyInfo</code>\n                          ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5280\" title=\"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile\">RFC5280</a></cite>]\n                          with the following properties:\n                        </p>\n                        <ul>\n                          <li>\n                            <p>\n                              Set the <var>algorithm</var> field to an\n                              <code>AlgorithmIdentifier</code> ASN.1 type with the following\n                              properties:\n                            </p>\n                            <ul>\n                              <li>\n                                <p>\n                                  Set the <var>algorithm</var> field to the OID\n                                  <code>rsaEncryption</code> defined in\n                                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>].\n                                </p>\n                              </li>\n                              <li>\n                                <p>\n                                  Set the <var>params</var> field to the ASN.1 type NULL.\n                                </p>\n                              </li>\n                            </ul>\n                          </li>\n                          <li>\n                            <p>\n                              Set the <var>subjectPublicKey</var> field to the result of\n                              DER-encoding an <code>RSAPublicKey</code> ASN.1 type, as defined\n                              in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>], Appendix A.1.1, that\n                              represents the RSA public key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-15\"><code>[[handle]]</code></a> internal slot of\n                              <var>key</var>\n                            </p>\n                          </li>\n                        </ul>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be the result of DER-encoding <var>data</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-28\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> is not \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-16\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>data</var> be an instance of the <code>PrivateKeyInfo</code>\n                          ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5208\" title=\"Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2\">RFC5208</a></cite>]\n                          with the following properties:\n                        </p>\n                        <ul>\n                          <li>\n                            <p>\n                              Set the <var>version</var> field to <code>0</code>.\n                            </p>\n                          </li>\n                          <li>\n                            <p>\n                              Set the <var>privateKeyAlgorithm</var> field to a\n                              <code>PrivateKeyAlgorithmIdentifier</code> ASN.1 type with the\n                              following properties:\n                            </p>\n                            <ul>\n                              <li>\n                                <p>\n                                  Set the <var>algorithm</var> field to the OID\n                                  <code>rsaEncryption</code> defined in\n                                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>].\n                                </p>\n                              </li>\n                              <li>\n                                <p>\n                                  Set the <var>params</var> field to the ASN.1 type NULL.\n                                </p>\n                              </li>\n                            </ul>\n                          </li>\n                          <li>\n                            <p>\n                              Set the <var>privateKey</var> field to the result of DER-encoding\n                              an <code>RSAPrivateKey</code> ASN.1 type, as defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>], Appendix A.1.2, that represents the\n                              RSA private key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-16\"><code>[[handle]]</code></a> internal slot of\n                              <var>key</var>\n                            </p>\n                            \n                          </li>\n                        </ul>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be the result of DER-encoding <var>data</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>Let <var>jwk</var> be a new <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-11\"><code>JsonWebKey</code></a> dictionary.</p>"
                    },
                    {
                      "html": "<p>Set the <code>kty</code> attribute of <var>jwk</var> to the string\n                        \"<code>RSA</code>\".</p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>hash</var> be the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-16\"><code>name</code></a>\n                          attribute of the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-hash-11\"><code>hash</code></a>\n                          attribute of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-28\"><code>[[algorithm]]</code></a> internal slot of\n                          <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If <var>hash</var> is \"<code>SHA-1</code>\":</dt>\n                          <dd>\n                            <p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>PS1</code>\".\n                            </p>\n                          </dd>\n                          <dt>If <var>hash</var> is \"<code>SHA-256</code>\":</dt>\n                          <dd>\n                            <p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>PS256</code>\".\n                            </p>\n                          </dd>\n                          <dt>If <var>hash</var> is \"<code>SHA-384</code>\":</dt>\n                          <dd>\n                            <p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>PS384</code>\".\n                            </p>\n                          </dd>\n                          <dt>If <var>hash</var> is \"<code>SHA-512</code>\":</dt>\n                          <dd>\n                            <p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>PS512</code>\".\n                            </p>\n                          </dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If hash is \"SHA-1\":",
                              "html": "<p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>PS1</code>\".\n                            </p>"
                            },
                            {
                              "case": "If hash is \"SHA-256\":",
                              "html": "<p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>PS256</code>\".\n                            </p>"
                            },
                            {
                              "case": "If hash is \"SHA-384\":",
                              "html": "<p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>PS384</code>\".\n                            </p>"
                            },
                            {
                              "case": "If hash is \"SHA-512\":",
                              "html": "<p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>PS512</code>\".\n                            </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"RSA-PSS key export steps\" href=\"https://w3c.github.io/webcrypto/#dfn-rsa-pss-extended-export-steps\" class=\"internalDFN\" id=\"ref-for-dfn-rsa-pss-extended-export-steps-1\">key export steps</a>\n                                  defined by <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-9\">other applicable\n                                  specifications</a>, passing <var>format</var> and the\n                                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-hash-12\"><code>hash</code></a> attribute of\n                                  the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-29\"><code>[[algorithm]]</code></a>\n                                  internal slot of <var>key</var>\n                                  and obtaining <var>alg</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Set the <code>alg</code> attribute of <var>jwk</var> to <var>alg</var>.\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Set the attributes <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-n\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-n-2\"><code>n</code></a> and <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-e\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-e-2\"><code>e</code></a> of <var>jwk</var>\n                          according to the corresponding definitions in JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>], Section 6.3.1.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-29\"><code>[[type]]</code></a> internal slot of\n                            <var>key</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-17\"><code>private</code></a>\":\n                          </dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the [[type]] internal slot of key is \"private\":",
                              "html": "",
                              "rationale": "set",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Set the attributes named <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-8\"><code>d</code></a>, <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-p\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-p-2\"><code>p</code></a>,\n                                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-q\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-q-2\"><code>q</code></a>, <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-dp\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-dp-2\"><code>dp</code></a>, <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-dq\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-dq-2\"><code>dq</code></a>, and\n                                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-qi\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-qi-2\"><code>qi</code></a> of <var>jwk</var> according to the\n                                  corresponding definitions in JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>], Section 6.3.2.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If the underlying RSA private key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-17\"><code>[[handle]]</code></a> internal slot\n                                  of <var>key</var> is represented by more than two primes, set\n                                  the attribute named <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-oth\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-oth-2\"><code>oth</code></a> of <var>jwk</var>\n                                  according to the corresponding definition in JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>], Section 6.3.2.7\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-cryptokey-usages\" class=\"internalDFN\" id=\"ref-for-dom-cryptokey-usages-2\"><code>usages</code></a> attribute of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>ext</code> attribute of <var>jwk</var> to the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-15\"><code>[[extractable]]</code></a> internal slot\n                          of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>jwk</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise",
                  "html": "<p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-30\"><code>[[type]]</code></a> internal slot of <var>key</var>\n                  is not \"<code>public</code>\",\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>label</var> be the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaOaepParams-label\" class=\"internalDFN\" id=\"ref-for-dfn-RsaOaepParams-label-2\"><code>label</code></a> member of\n                  <var>normalizedAlgorithm</var> or the empty byte sequence if the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaOaepParams-label\" class=\"internalDFN\" id=\"ref-for-dfn-RsaOaepParams-label-3\"><code>label</code></a> member of\n                  <var>normalizedAlgorithm</var> is not present.\n                </p>"
        },
        {
          "html": "<p>\n                  Perform the encryption operation defined in Section 7.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>] with the key represented by <var>key</var>\n                  as the recipient's RSA public key, <var>plaintext</var>\n                  as the message to be encrypted, <var>M</var> and <var>label</var>\n                  as the label, <var>L</var>, and with the hash\n                  function specified by the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-hash-13\"><code>hash</code></a>\n                  attribute of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-30\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var> as the Hash option and MGF1 (defined in Section B.2.1 of\n                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>]) as the MGF option.\n                </p>"
        },
        {
          "html": "<p>\n                  If performing the operation results in an error,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>ciphertext</var> be the value <var>C</var> that results from performing the\n                  operation.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>ciphertext</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-31\"><code>[[type]]</code></a> internal slot of <var>key</var>\n                  is not \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-18\"><code>private</code></a>\",\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>label</var> be the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaOaepParams-label\" class=\"internalDFN\" id=\"ref-for-dfn-RsaOaepParams-label-4\"><code>label</code></a> member of\n                  <var>normalizedAlgorithm</var> or the empty byte sequence if the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaOaepParams-label\" class=\"internalDFN\" id=\"ref-for-dfn-RsaOaepParams-label-5\"><code>label</code></a> member of\n                  <var>normalizedAlgorithm</var> is not present.\n                </p>"
        },
        {
          "html": "<p>\n                  Perform the decryption operation defined in Section 7.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>] with the key represented by <var>key</var>\n                  as the recipient's RSA private key, <var>ciphertext</var>\n                  as the ciphertext to be decrypted, C, and <var>label</var>\n                  as the label, <var>L</var>, and with the hash\n                  function specified by the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-hash-14\"><code>hash</code></a>\n                  attribute of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-31\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var> as the Hash option and MGF1 (defined in Section B.2.1 of\n                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>]) as the MGF option.\n                </p>"
        },
        {
          "html": "<p>\n                  If performing the operation results in an error,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>plaintext</var> the value <var>M</var> that results from performing the\n                  operation.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>plaintext</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>usages</var> contains an entry which is not\n                  \"<code>encrypt</code>\", \"<code>decrypt</code>\",\n                  \"<code>wrapKey</code>\" or \"<code>unwrapKey</code>\",\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Generate an RSA key pair, as defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>], with RSA modulus length equal to the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyGenParams-modulusLength\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyGenParams-modulusLength-6\"><code>modulusLength</code></a> member of\n                  <var>normalizedAlgorithm</var> and RSA public exponent equal to the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyGenParams-publicExponent\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyGenParams-publicExponent-6\"><code>publicExponent</code></a> member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  If performing the operation results in an error,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"RsaHashedKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-6\"><code>RsaHashedKeyAlgorithm</code></a>\n                  object.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-17\"><code>name</code></a> attribute of\n                  <var>algorithm</var> to \"<code>RSA-OAEP</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyAlgorithm-modulusLength\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyAlgorithm-modulusLength-6\"><code>modulusLength</code></a>\n                  attribute of <var>algorithm</var> to equal the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyGenParams-modulusLength\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyGenParams-modulusLength-7\"><code>modulusLength</code></a>\n                  member of <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyAlgorithm-publicExponent\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyAlgorithm-publicExponent-6\"><code>publicExponent</code></a>\n                  attribute of <var>algorithm</var> to equal the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyGenParams-publicExponent\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyGenParams-publicExponent-7\"><code>publicExponent</code></a>\n                  member of <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-hash-15\"><code>hash</code></a> attribute\n                  of <var>algorithm</var> to equal the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyGenParams-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyGenParams-hash-4\"><code>hash</code></a> member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>publicKey</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-58\"><code>CryptoKey</code></a>\n                  representing the public key of the generated key pair.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-32\"><code>[[type]]</code></a> internal slot of\n                  <var>publicKey</var> to \"<code>public</code>\"\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-32\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>publicKey</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-16\"><code>[[extractable]]</code></a> internal slot of\n                  <var>publicKey</var> to true.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-21\"><code>[[usages]]</code></a> internal slot of\n                  <var>publicKey</var> to be the\n                  <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-usage-intersection\" class=\"internalDFN\" id=\"ref-for-concept-usage-intersection-6\">usage intersection</a> of\n                  <var>usages</var> and <code>[ \"encrypt\", \"wrapKey\" ]</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>privateKey</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-59\"><code>CryptoKey</code></a>\n                  representing the private key of the generated key pair.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-33\"><code>[[type]]</code></a> internal slot of\n                  <var>privateKey</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-19\"><code>private</code></a>\"\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-33\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>privateKey</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-17\"><code>[[extractable]]</code></a> internal slot of\n                  <var>privateKey</var> to <var>extractable</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-22\"><code>[[usages]]</code></a> internal slot of\n                  <var>privateKey</var> to be the\n                  <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-usage-intersection\" class=\"internalDFN\" id=\"ref-for-concept-usage-intersection-7\">usage intersection</a> of\n                  <var>usages</var> and <code>[ \"decrypt\", \"unwrapKey\" ]</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKeyPair\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-9\"><code>CryptoKeyPair</code></a>\n                  dictionary.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair-publicKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-publicKey-4\"><code>publicKey</code></a> attribute\n                  of <var>result</var> to be <var>publicKey</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair-privateKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-privateKey-5\"><code>privateKey</code></a> attribute\n                  of <var>result</var> to be <var>privateKey</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-11\"><code>spki</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-11\"><code>pkcs8</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-11\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If <var>usages</var> contains an entry which is not\n                          \"<code>encrypt</code>\" or\n                          \"<code>wrapKey</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>spki</var> be the result of running the\n                          <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-a-spki\" class=\"internalDFN\" id=\"ref-for-concept-parse-a-spki-3\">parse a subjectPublicKeyInfo</a>\n                          algorithm over <var>keyData</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurred while parsing,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>algorithm</code> object identifier field of the\n                          <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is\n                          not equal to the <code>rsaEncryption</code>\n                          object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>publicKey</var> be the result of performing the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-an-asn1-structure\" class=\"internalDFN\" id=\"ref-for-concept-parse-an-asn1-structure-7\">parse an ASN.1 structure</a>\n                          algorithm, with <var>data</var> as the\n                          <code>subjectPublicKeyInfo</code> field of <var>spki</var>,\n                          <var>structure</var> as the <code>RSAPublicKey</code> structure\n                          specified in Section A.1.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>], and\n                          <var>exactData</var> set to true.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurred while parsing, or it can be determined that <var>publicKey</var>\n                          is not a valid public key according to [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-60\"><code>CryptoKey</code></a>\n                          that represents the RSA public key identified by\n                          <var>publicKey</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-34\"><code>[[type]]</code></a> internal slot of\n                          <var>key</var> to \"<code>public</code>\"\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If <var>usages</var> contains an entry which is not\n                          \"<code>decrypt</code>\" or \"<code>unwrapKey</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>privateKeyInfo</var> be the result of running the\n                          <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-a-privateKeyInfo\" class=\"internalDFN\" id=\"ref-for-concept-parse-a-privateKeyInfo-3\">parse a privateKeyInfo</a>\n                          algorithm over <var>keyData</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurred while parsing, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>algorithm</code> object identifier field of the\n                          <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of\n                          <var>privateKeyInfo</var> is not equal to the\n                          <code>rsaEncryption</code> object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>rsaPrivateKey</var> be the result of performing the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-an-asn1-structure\" class=\"internalDFN\" id=\"ref-for-concept-parse-an-asn1-structure-8\">parse an ASN.1 structure</a>\n                          algorithm, with <var>data</var> as the\n                          <code>privateKey</code> field of <var>privateKeyInfo</var>,\n                          <var>structure</var> as the <code>RSAPrivateKey</code> structure\n                          specified in Section A.1.2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>], and\n                          <var>exactData</var> set to true.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurred while parsing, or if <var>rsaPrivateKey</var> is not\n                          a valid RSA private key according to [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-61\"><code>CryptoKey</code></a>\n                          that represents the RSA private key identified by\n                          <var>rsaPrivateKey</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-35\"><code>[[type]]</code></a> internal slot of\n                          <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-20\"><code>private</code></a>\"\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If <var>keyData</var> is a <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-12\"><code>JsonWebKey</code></a> dictionary:</dt>\n                          <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                          <dt>Otherwise:</dt>\n                          <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-9\"><code>d</code></a> field of <var>jwk</var> is present and\n                          <var>usages</var> contains an entry which is not\n                          \"<code>decrypt</code>\" or \"<code>unwrapKey</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-10\"><code>d</code></a> field of <var>jwk</var> is not present and\n                          <var>usages</var> contains an entry which is not\n                          \"<code>encrypt</code>\" or \"<code>wrapKey</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-kty\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-kty-4\"><code>kty</code></a> field of <var>jwk</var> is not a\n                          case-sensitive string match to \"<code>RSA</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>usages</var> is non-empty and the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-use\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-use-3\"><code>use</code></a> field of <var>jwk</var> is present and is\n                          not a case-sensitive string match to \"<code>enc</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-key_ops\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-key_ops-3\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                          is invalid according to the requirements of\n                          JSON Web Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>] or\n                          does not contain all of the specified <var>usages</var> values,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-ext\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-ext-5\"><code>ext</code></a> field of <var>jwk</var> is present and\n                          has the value false and <var>extractable</var> is true,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If the <code>alg</code> field of <var>jwk</var> is not present:</dt>\n                          <dd>Let <var>hash</var> be undefined.</dd>\n                          <dt>\n                            If the <code>alg</code> field of <var>jwk</var> is equal to\n                            \"<code>RSA-OAEP</code>\":\n                          </dt>\n                          <dd>Let <var>hash</var> be the string \"<code>SHA-1</code>\".</dd>\n                          <dt>\n                            If the <code>alg</code> field of <var>jwk</var> is equal to\n                            \"<code>RSA-OAEP-256</code>\":\n                          </dt>\n                          <dd>Let <var>hash</var> be the string \"<code>SHA-256</code>\".</dd>\n                          <dt>\n                            If the <code>alg</code> field of <var>jwk</var> is equal to\n                            \"<code>RSA-OAEP-384</code>\":\n                          </dt>\n                          <dd>Let <var>hash</var> be the string \"<code>SHA-384</code>\".</dd>\n                          <dt>\n                            If the <code>alg</code> field of <var>jwk</var> is equal to\n                            \"<code>RSA-OAEP-512</code>\":\n                          </dt>\n                          <dd>Let <var>hash</var> be the string \"<code>SHA-512</code>\".</dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the alg field of jwk is not present:",
                              "html": "Let <var>hash</var> be undefined."
                            },
                            {
                              "case": "If the alg field of jwk is equal to \"RSA-OAEP\":",
                              "html": "Let <var>hash</var> be the string \"<code>SHA-1</code>\"."
                            },
                            {
                              "case": "If the alg field of jwk is equal to \"RSA-OAEP-256\":",
                              "html": "Let <var>hash</var> be the string \"<code>SHA-256</code>\"."
                            },
                            {
                              "case": "If the alg field of jwk is equal to \"RSA-OAEP-384\":",
                              "html": "Let <var>hash</var> be the string \"<code>SHA-384</code>\"."
                            },
                            {
                              "case": "If the alg field of jwk is equal to \"RSA-OAEP-512\":",
                              "html": "Let <var>hash</var> be the string \"<code>SHA-512</code>\"."
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"RSA-OAEP key import steps\" href=\"https://w3c.github.io/webcrypto/#dfn-rsa-oaep-extended-import-steps\" class=\"internalDFN\" id=\"ref-for-dfn-rsa-oaep-extended-import-steps-1\">key import steps</a> defined by\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-11\">other applicable\n                                  specifications</a>, passing <var>format</var>, <var>jwk</var>\n                                  and obtaining <var>hash</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If an error occurred or there are no\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-12\">applicable\n                                  specifications</a>,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<dl>\n                          <dt>\n                            If <var>hash</var> is not undefined:\n                          </dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": "let",
                      "steps": [
                        {
                          "html": "<p>\n                                  Let <var>normalizedHash</var> be the result of\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-normalize-an-algorithm\" id=\"ref-for-dfn-normalize-an-algorithm-22\">normalize an algorithm</a>\n                                  with <code>alg</code> set to <var>hash</var> and <code>op</code> set\n                                  to <code>digest</code>.\n                                </p>"
                        },
                        {
                          "html": "<p>\n                                  If <var>normalizedHash</var> is not equal to the\n                                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedImportParams-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedImportParams-hash-6\"><code>hash</code></a> member of\n                                  <var>normalizedAlgorithm</var>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                        }
                      ]
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-11\"><code>d</code></a> field of <var>jwk</var> is present:</dt>\n                          <dd>\n                            \n                          </dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the d field of jwk is present:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                  If <var>jwk</var> does not meet the requirements of Section\n                                  6.3.2 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>], then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>privateKey</var> represent the\n                                  RSA private key identified by interpreting <var>jwk</var>\n                                  according to Section 6.3.2 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If <var>privateKey</var> can be determined to not be a valid RSA private key\n                                  according to [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>],\n                                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-62\"><code>CryptoKey</code></a> representing <var>privateKey</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-36\"><code>[[type]]</code></a> internal slot of\n                                  <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-21\"><code>private</code></a>\"\n                                </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                  If <var>jwk</var> does not meet the requirements of Section\n                                  6.3.1 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>], then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>publicKey</var> represent the\n                                  RSA public key identified by interpreting <var>jwk</var>\n                                  according to Section 6.3.1 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If <var>publicKey</var> can be determined to not be a valid RSA public key\n                                  according to [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>],\n                                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-63\"><code>CryptoKey</code></a> representing <var>publicKey</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-37\"><code>[[type]]</code></a> internal slot of\n                                  <var>key</var> to \"<code>public</code>\"\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"RsaHashedKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-7\"><code>RsaHashedKeyAlgorithm</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-18\"><code>name</code></a> attribute of\n                  <var>algorithm</var> to \"<code>RSA-OAEP</code>\"\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyAlgorithm-modulusLength\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyAlgorithm-modulusLength-7\"><code>modulusLength</code></a>\n                  attribute of <var>algorithm</var> to the length, in bits, of the RSA public\n                  modulus.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaKeyAlgorithm-publicExponent\" class=\"internalDFN\" id=\"ref-for-dfn-RsaKeyAlgorithm-publicExponent-7\"><code>publicExponent</code></a>\n                  attribute of <var>algorithm</var> to the <a data-link-type=\"idl\" data-lt=\"BigInteger\" href=\"https://w3c.github.io/webcrypto/#dfn-BigInteger\" class=\"internalDFN\" id=\"ref-for-dfn-BigInteger-6\"><code>BigInteger</code></a>\n                  representation of the RSA public exponent.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-hash-16\"><code>hash</code></a> attribute of\n                  <var>algorithm</var> to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedImportParams-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedImportParams-hash-7\"><code>hash</code></a> member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-34\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var> to <var>algorithm</var>\n                </p>"
        },
        {
          "html": "<p>Return <var>key</var>.</p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>key</var> be the key to be exported.\n                </p>"
        },
        {
          "html": "<p>\n                  If the underlying cryptographic key material represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-18\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n                  cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-12\"><code>spki</code></a>\"</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-12\"><code>pkcs8</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-12\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise</dt>\n                  <dd>\n                    <p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\"",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-38\"><code>[[type]]</code></a> internal slot of\n                          <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>data</var> be an instance of the <code>SubjectPublicKeyInfo</code>\n                          ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5280\" title=\"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile\">RFC5280</a></cite>]\n                          with the following properties:\n                        </p>\n                        <ul>\n                          <li>\n                            <p>\n                              Set the <var>algorithm</var> field to an\n                              <code>AlgorithmIdentifier</code> ASN.1 type with the following\n                              properties:\n                            </p>\n                            <ul>\n                              <li>\n                                <p>\n                                  Set the <var>algorithm</var> field to the OID\n                                  <code>rsaEncryption</code> defined in\n                                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>].\n                                </p>\n                              </li>\n                              <li>\n                                <p>\n                                  Set the <var>params</var> field to the ASN.1 type NULL.\n                                </p>\n                              </li>\n                            </ul>\n                          </li>\n                          <li>\n                            <p>\n                              Set the <var>subjectPublicKey</var> field to the result of\n                              DER-encoding an <code>RSAPublicKey</code> ASN.1 type, as defined\n                              in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>], Appendix A.1.1, that\n                              represents the RSA public key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-19\"><code>[[handle]]</code></a> internal slot of\n                              <var>key</var>\n                            </p>\n                          </li>\n                        </ul>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be the result of DER-encoding <var>data</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-39\"><code>[[type]]</code></a> internal slot of\n                          <var>key</var> is not \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-22\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>data</var> be an instance of the <code>PrivateKeyInfo</code>\n                          ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5208\" title=\"Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2\">RFC5208</a></cite>]\n                          with the following properties:\n                        </p>\n                        <ul>\n                          <li>\n                            <p>\n                              Set the <var>version</var> field to <code>0</code>.\n                            </p>\n                          </li>\n                          <li>\n                            <p>\n                              Set the <var>privateKeyAlgorithm</var> field to a\n                              <code>PrivateKeyAlgorithmIdentifier</code> ASN.1 type with the\n                              following properties:\n                            </p>\n                            <ul>\n                              <li>\n                                <p>\n                                  Set the <var>algorithm</var> field to the OID\n                                  <code>rsaEncryption</code> defined in\n                                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>].\n                                </p>\n                              </li>\n                              <li>\n                                <p>\n                                  Set the <var>params</var> field to the ASN.1 type NULL.\n                                </p>\n                              </li>\n                            </ul>\n                          </li>\n                          <li>\n                            <p>\n                              Set the <var>privateKey</var> field to the result of DER-encoding\n                              an <code>RSAPrivateKey</code> ASN.1 type, as defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3447\" title=\"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1\">RFC3447</a></cite>], Appendix A.1.2, that represents the\n                              RSA private key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-20\"><code>[[handle]]</code></a> internal slot of\n                              <var>key</var>\n                            </p>\n                            \n                          </li>\n                        </ul>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be the result of DER-encoding <var>data</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>jwk</var> be a new <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-13\"><code>JsonWebKey</code></a>\n                          dictionary.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>kty</code> attribute of <var>jwk</var> to the string\n                          \"<code>RSA</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>hash</var> be the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-19\"><code>name</code></a>\n                          attribute of the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-hash-17\"><code>hash</code></a>\n                          attribute of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-35\"><code>[[algorithm]]</code></a> internal slot of\n                          <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If <var>hash</var> is \"<code>SHA-1</code>\":\n                          </dt>\n                          <dd>\n                            <p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>RSA-OAEP</code>\".\n                            </p>\n                          </dd>\n                          <dt>\n                            If <var>hash</var> is \"<code>SHA-256</code>\":\n                          </dt>\n                          <dd>\n                            <p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>RSA-OAEP-256</code>\".\n                            </p>\n                          </dd>\n                          <dt>\n                            If <var>hash</var> is \"<code>SHA-384</code>\":\n                          </dt>\n                          <dd>\n                            <p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>RSA-OAEP-384</code>\".\n                            </p>\n                          </dd>\n                          <dt>\n                            If <var>hash</var> is \"<code>SHA-512</code>\":\n                          </dt>\n                          <dd>\n                            <p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>RSA-OAEP-512</code>\".\n                            </p>\n                          </dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If hash is \"SHA-1\":",
                              "html": "<p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>RSA-OAEP</code>\".\n                            </p>"
                            },
                            {
                              "case": "If hash is \"SHA-256\":",
                              "html": "<p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>RSA-OAEP-256</code>\".\n                            </p>"
                            },
                            {
                              "case": "If hash is \"SHA-384\":",
                              "html": "<p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>RSA-OAEP-384</code>\".\n                            </p>"
                            },
                            {
                              "case": "If hash is \"SHA-512\":",
                              "html": "<p>\n                              Set the <code>alg</code> attribute of <var>jwk</var> to the string\n                              \"<code>RSA-OAEP-512</code>\".\n                            </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"RSA-OAEP key export steps\" href=\"https://w3c.github.io/webcrypto/#dfn-rsa-oaep-extended-export-steps\" class=\"internalDFN\" id=\"ref-for-dfn-rsa-oaep-extended-export-steps-1\">key export steps</a>\n                                  defined by <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-13\">other applicable\n                                  specifications</a>, passing <var>format</var> and the\n                                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-RsaHashedKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-RsaHashedKeyAlgorithm-hash-18\"><code>hash</code></a> attribute of\n                                  the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-36\"><code>[[algorithm]]</code></a>\n                                  internal slot of <var>key</var>\n                                  and obtaining <var>alg</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Set the <code>alg</code> attribute of <var>jwk</var> to <var>alg</var>.\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Set the attributes <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-n\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-n-3\"><code>n</code></a> and <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-e\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-e-3\"><code>e</code></a> of <var>jwk</var>\n                          according to the corresponding definitions in JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>], Section 6.3.1.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-40\"><code>[[type]]</code></a> internal slot\n                            of <var>key</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-23\"><code>private</code></a>\":\n                          </dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the [[type]] internal slot of key is \"private\":",
                              "html": "",
                              "rationale": "set",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Set the attributes named <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-12\"><code>d</code></a>, <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-p\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-p-3\"><code>p</code></a>,\n                                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-q\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-q-3\"><code>q</code></a>, <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-dp\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-dp-3\"><code>dp</code></a>, <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-dq\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-dq-3\"><code>dq</code></a>, and\n                                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-qi\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-qi-3\"><code>qi</code></a> of <var>jwk</var> according to the\n                                  corresponding definitions in JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>], Section 6.3.2.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If the underlying RSA private key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-21\"><code>[[handle]]</code></a> internal slot\n                                  of <var>key</var> is represented by more than two primes, set\n                                  the attribute named <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-oth\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-oth-3\"><code>oth</code></a> of <var>jwk</var>\n                                  according to the corresponding definition in JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>], Section 6.3.2.7\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-cryptokey-usages\" class=\"internalDFN\" id=\"ref-for-dom-cryptokey-usages-3\"><code>usages</code></a> attribute of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>ext</code> attribute of <var>jwk</var> to the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-18\"><code>[[extractable]]</code></a> internal slot\n                          of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>jwk</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise",
                  "html": "<p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-41\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> is not \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-24\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>hashAlgorithm</var> be the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcdsaParams-hash\" class=\"internalDFN\" id=\"ref-for-dfn-EcdsaParams-hash-2\"><code>hash</code></a>\n                  member of <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>M</var> be the result of performing the digest operation specified by\n                  <var>hashAlgorithm</var> using <var>message</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>d</var> be the ECDSA private key associated with <var>key</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>params</var> be the EC domain parameters associated with\n                  <var>key</var>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>\n                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-2\"><code>namedCurve</code></a> attribute of the\n                    <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-37\"><code>[[algorithm]]</code></a> internal slot of\n                    <var>key</var> is \"<code>P-256</code>\", \"<code>P-384</code>\" or \"<code>P-521</code>\":\n                  </dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>\n                    Otherwise, the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-3\"><code>namedCurve</code></a> attribute\n                    of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-38\"><code>[[algorithm]]</code></a> internal slot of\n                    <var>key</var> is a value specified in an\n                    <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-16\">applicable specification</a>:\n                  </dt>\n                  <dd>\n                    <p>\n                      Perform the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdsa-extended-signature-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdsa-extended-signature-steps-1\">ECDSA signature steps</a>\n                      specified in that specification, passing in <var>M</var>, <var>params</var>\n                      and <var>d</var> and resulting in <var>result</var>.\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                  "html": "",
                  "rationale": "perform",
                  "steps": [
                    {
                      "html": "<p>\n                          Perform the ECDSA signing process, as specified in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc6090\" title=\"Fundamental Elliptic Curve Cryptography Algorithms\">RFC6090</a></cite>],\n                          Section 5.4.2, with <var>M</var> as the message, using <var>params</var> as the\n                          EC domain parameters, and with <var>d</var> as the private key.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>r</var> and <var>s</var> be the pair of integers resulting from\n                        performing the ECDSA signing process.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be an empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>n</var> be the smallest integer such that <var>n</var> * 8 is greater than\n                          the logarithm to base 2 of the order of the base point of the elliptic curve identified\n                          by <var>params</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          <a href=\"https://w3c.github.io/webcrypto/#dfn-convert-integer-to-byte-sequence\" id=\"ref-for-dfn-convert-integer-to-byte-sequence-1\">Convert <var>r</var> to a byte sequence of\n                          length <var>n</var></a> and append it to <var>result</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          <a href=\"https://w3c.github.io/webcrypto/#dfn-convert-integer-to-byte-sequence\" id=\"ref-for-dfn-convert-integer-to-byte-sequence-2\">Convert <var>s</var> to a byte sequence of\n                          length <var>n</var></a> and append it to <var>result</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise, the namedCurve attribute of the [[algorithm]] internal slot of key is a value specified in an applicable specification:",
                  "html": "<p>\n                      Perform the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdsa-extended-signature-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdsa-extended-signature-steps-1\">ECDSA signature steps</a>\n                      specified in that specification, passing in <var>M</var>, <var>params</var>\n                      and <var>d</var> and resulting in <var>result</var>.\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-42\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>hashAlgorithm</var> be the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcdsaParams-hash\" class=\"internalDFN\" id=\"ref-for-dfn-EcdsaParams-hash-3\"><code>hash</code></a>\n                  member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>M</var> be the result of performing the digest operation specified by\n                  <var>hashAlgorithm</var> using <var>message</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>Q</var> be the ECDSA public key associated with <var>key</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>params</var> be the EC domain parameters associated with\n                  <var>key</var>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>\n                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-4\"><code>namedCurve</code></a> attribute of the\n                    <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-39\"><code>[[algorithm]]</code></a> internal slot of\n                    <var>key</var> is \"<code>P-256</code>\", \"<code>P-384</code>\" or \"<code>P-521</code>\":\n                  </dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>\n                    Otherwise, the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-5\"><code>namedCurve</code></a> attribute\n                    of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-40\"><code>[[algorithm]]</code></a> internal slot of\n                    <var>key</var> is a value specified in an\n                    <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-17\">applicable specification</a>:\n                  </dt>\n                  <dd>\n                    <p>\n                      Perform the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdsa-extended-verification-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdsa-extended-verification-steps-1\">ECDSA verification steps</a>\n                      specified in that specification passing in <var>M</var>, <var>signature</var>,\n                      <var>params</var> and <var>Q</var> and resulting in an indication of whether\n                      or not the purported signature is valid.\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>n</var> be the smallest integer such that <var>n</var> * 8 is greater than\n                          the logarithm to base 2 of the order of the base point of the elliptic curve identified\n                          by <var>params</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>signature</var> does not have a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence-length\">length</a> of <var>n</var> * 2 bytes,\n                          then return false.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>r</var> be the result of\n                          <a href=\"https://w3c.github.io/webcrypto/#dfn-convert-byte-sequence-to-integer\" id=\"ref-for-dfn-convert-byte-sequence-to-integer-1\">converting the first <var>n</var> bytes of <var>signature</var> to an integer</a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>s</var> be the result of\n                          <a href=\"https://w3c.github.io/webcrypto/#dfn-convert-byte-sequence-to-integer\" id=\"ref-for-dfn-convert-byte-sequence-to-integer-2\">converting the last <var>n</var> bytes of <var>signature</var> to an integer</a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Perform the ECDSA verifying process, as specified in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc6090\" title=\"Fundamental Elliptic Curve Cryptography Algorithms\">RFC6090</a></cite>], Section 5.4.3, with <var>M</var> as the received\n                          message, (<var>r</var>, <var>s</var>) as the signature and using\n                          <var>params</var> as the EC domain parameters, and\n                          <var>Q</var> as the public key.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise, the namedCurve attribute of the [[algorithm]] internal slot of key is a value specified in an applicable specification:",
                  "html": "<p>\n                      Perform the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdsa-extended-verification-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdsa-extended-verification-steps-1\">ECDSA verification steps</a>\n                      specified in that specification passing in <var>M</var>, <var>signature</var>,\n                      <var>params</var> and <var>Q</var> and resulting in an indication of whether\n                      or not the purported signature is valid.\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Let <var>result</var> be a boolean with the value <code>true</code> if the signature is valid\n                  and the value <code>false</code> otherwise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>usages</var> contains a value which is not\n                  one of \"<code>sign</code>\" or \"<code>verify</code>\",\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>\n                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyGenParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyGenParams-namedCurve-2\"><code>namedCurve</code></a> member of\n                    <var>normalizedAlgorithm</var> is \"<code>P-256</code>\", \"<code>P-384</code>\"\n                    or \"<code>P-521</code>\":\n                  </dt>\n                  <dd>\n                    <p>\n                      Generate an Elliptic Curve key pair, as defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc6090\" title=\"Fundamental Elliptic Curve Cryptography Algorithms\">RFC6090</a></cite>]\n                      with domain parameters for the curve identified by\n                      the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyGenParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyGenParams-namedCurve-3\"><code>namedCurve</code></a> member of\n                      <var>normalizedAlgorithm</var>.\n                    </p>\n                  </dd>\n                  <dt>\n                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyGenParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyGenParams-namedCurve-4\"><code>namedCurve</code></a> member of\n                    <var>normalizedAlgorithm</var> is a value specified in an\n                    <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-18\">applicable specification</a>:\n                  </dt>\n                  <dd>\n                    <p>\n                      Perform the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdsa-extended-generation-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdsa-extended-generation-steps-1\">ECDSA generation steps</a> specified in that specification, passing in\n                      <var>normalizedAlgorithm</var> and resulting in an elliptic curve key pair.\n                    </p>\n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the namedCurve member of normalizedAlgorithm is \"P-256\", \"P-384\" or \"P-521\":",
                  "html": "<p>\n                      Generate an Elliptic Curve key pair, as defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc6090\" title=\"Fundamental Elliptic Curve Cryptography Algorithms\">RFC6090</a></cite>]\n                      with domain parameters for the curve identified by\n                      the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyGenParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyGenParams-namedCurve-3\"><code>namedCurve</code></a> member of\n                      <var>normalizedAlgorithm</var>.\n                    </p>"
                },
                {
                  "case": "If the namedCurve member of normalizedAlgorithm is a value specified in an applicable specification:",
                  "html": "<p>\n                      Perform the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdsa-extended-generation-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdsa-extended-generation-steps-1\">ECDSA generation steps</a> specified in that specification, passing in\n                      <var>normalizedAlgorithm</var> and resulting in an elliptic curve key pair.\n                    </p>"
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  If performing the key generation operation results in an error,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"EcKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-2\"><code>EcKeyAlgorithm</code></a>\n                  object.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-20\"><code>name</code></a> attribute of\n                  <var>algorithm</var> to \"<code>ECDSA</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-6\"><code>namedCurve</code></a>\n                  attribute of <var>algorithm</var> to equal the\n                  <a data-link-type=\"idl\" data-lt=\"namedCurve\" href=\"https://w3c.github.io/webcrypto/#dfn-NamedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-NamedCurve-5\"><code>namedCurve</code></a> member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>publicKey</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-65\"><code>CryptoKey</code></a>\n                  representing the public key of the generated key pair.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-43\"><code>[[type]]</code></a> internal slot of\n                  <var>publicKey</var> to \"<code>public</code>\"\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-41\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>publicKey</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-19\"><code>[[extractable]]</code></a> internal\n                  slot of <var>publicKey</var> to true.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-23\"><code>[[usages]]</code></a> internal slot of\n                  <var>publicKey</var> to be the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-usage-intersection\" class=\"internalDFN\" id=\"ref-for-concept-usage-intersection-8\">usage intersection</a> of <var>usages</var> and <code>[ \"verify\" ]</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>privateKey</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-66\"><code>CryptoKey</code></a>\n                  representing the private key of the generated key pair.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-44\"><code>[[type]]</code></a> internal slot of\n                  <var>privateKey</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-25\"><code>private</code></a>\"\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-42\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>privateKey</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-20\"><code>[[extractable]]</code></a> internal\n                  slot of <var>privateKey</var> to <var>extractable</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-24\"><code>[[usages]]</code></a> internal slot of\n                  <var>privateKey</var> to be the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-usage-intersection\" class=\"internalDFN\" id=\"ref-for-concept-usage-intersection-9\">usage intersection</a> of <var>usages</var> and <code>[ \"sign\" ]</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKeyPair\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-11\"><code>CryptoKeyPair</code></a>\n                  dictionary.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair-publicKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-publicKey-5\"><code>publicKey</code></a> attribute\n                  of <var>result</var> to be <var>publicKey</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair-privateKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-privateKey-6\"><code>privateKey</code></a> attribute\n                  of <var>result</var> to be <var>privateKey</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-13\"><code>spki</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-13\"><code>pkcs8</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-13\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-10\"><code>raw</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If <var>usages</var> contains a value which is not\n                          \"<code>verify</code>\"\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>spki</var> be the result of running the\n                          <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-a-spki\" class=\"internalDFN\" id=\"ref-for-concept-parse-a-spki-4\">parse a subjectPublicKeyInfo</a>\n                          algorithm over <var>keyData</var>\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurred while parsing,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>algorithm</code> object identifier field of the\n                          <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is\n                          not equal to the <code>id-ecPublicKey</code>\n                          object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>parameters</code> field of the <code>algorithm</code>\n                          AlgorithmIdentifier field of <var>spki</var> is absent,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>params</var> be the <code>parameters</code> field of the\n                          <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>params</var> is not an instance of the\n                          <code>ECParameters</code> ASN.1 type defined in\n                          [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>] that specifies a\n                          <code>namedCurve</code>, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>namedCurve</var> be a string whose initial value is\n                          undefined.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If <var>params</var> is equivalent to the <code>secp256r1</code>\n                            object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]:\n                          </dt>\n                          <dd>\n                            <p>\n                              Set <var>namedCurve</var> \"<code>P-256</code>\".\n                            </p>\n                          </dd>\n                          <dt>\n                            If <var>params</var> is equivalent to the <code>secp384r1</code>\n                            object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]:\n                          </dt>\n                          <dd>\n                            <p>\n                              Set <var>namedCurve</var> \"<code>P-384</code>\".\n                            </p>\n                          </dd>\n                          <dt>\n                            If <var>params</var> is equivalent to the <code>secp521r1</code>\n                            object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]:\n                          </dt>\n                          <dd>\n                            <p>\n                              Set <var>namedCurve</var> \"<code>P-521</code>\".\n                            </p>\n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If params is equivalent to the secp256r1 object identifier defined in [RFC5480]:",
                              "html": "<p>\n                              Set <var>namedCurve</var> \"<code>P-256</code>\".\n                            </p>"
                            },
                            {
                              "case": "If params is equivalent to the secp384r1 object identifier defined in [RFC5480]:",
                              "html": "<p>\n                              Set <var>namedCurve</var> \"<code>P-384</code>\".\n                            </p>"
                            },
                            {
                              "case": "If params is equivalent to the secp521r1 object identifier defined in [RFC5480]:",
                              "html": "<p>\n                              Set <var>namedCurve</var> \"<code>P-521</code>\".\n                            </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If <var>namedCurve</var> is not undefined:</dt>\n                          <dd>\n                            \n                          </dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If namedCurve is not undefined:",
                              "html": "",
                              "rationale": "let",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Let <var>publicKey</var> be the Elliptic Curve public key identified by\n                                  performing the conversion steps defined in Section 2.3.4 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-sec1\" title=\"SEC 1: Elliptic Curve Cryptography\">SEC1</a></cite>] using the <code>subjectPublicKey</code>\n                                  field of <var>spki</var>.\n                                </p>\n                                <p>\n                                  The uncompressed point format <em class=\"rfc2119\">MUST</em> be supported.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If the implementation does not support the compressed point format and\n                                  a compressed point is provided,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If a decode error occurs or an identity point is found,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-67\"><code>CryptoKey</code></a>\n                                  that represents <var>publicKey</var>.\n                                </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"ECDSA key import steps\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdsa-extended-import-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdsa-extended-import-steps-1\">key import steps</a> defined by\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-19\">other applicable\n                                  specifications</a>, passing <var>format</var>, <var>spki</var>\n                                  and obtaining <var>namedCurve</var> and <var>key</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If an error occurred or there are no\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-20\">applicable\n                                  specifications</a>,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If <var>namedCurve</var> is defined, and not equal to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyImportParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyImportParams-namedCurve-2\"><code>namedCurve</code></a> member of\n                          <var>normalizedAlgorithm</var>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the public key value is not a valid point on the Elliptic Curve\n                          identified by the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyImportParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyImportParams-namedCurve-3\"><code>namedCurve</code></a> member of\n                          <var>normalizedAlgorithm</var> <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-45\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> to \"<code>public</code>\"\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>algorithm</var> be a new <a data-link-type=\"idl\" data-lt=\"EcKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-3\"><code>EcKeyAlgorithm</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-21\"><code>name</code></a> attribute of\n                          <var>algorithm</var> to \"<code>ECDSA</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-7\"><code>namedCurve</code></a>\n                          attribute of <var>algorithm</var> to <var>namedCurve</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-43\"><code>[[algorithm]]</code></a>\n                          internal slot of <var>key</var> to <var>algorithm</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If <var>usages</var> contains a value which is not\n                          \"<code>sign</code>\"\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>privateKeyInfo</var> be the result of running the\n                          <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-a-privateKeyInfo\" class=\"internalDFN\" id=\"ref-for-concept-parse-a-privateKeyInfo-4\">parse a privateKeyInfo</a>\n                          algorithm over <var>keyData</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurs while parsing,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>algorithm</code> object identifier field of the\n                          <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of\n                          <var>privateKeyInfo</var> is not equal to the\n                          <code>id-ecPublicKey</code> object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>parameters</code> field of the\n                          <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                          of <var>privateKeyInfo</var> is not present,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>params</var> be the <code>parameters</code> field of the\n                          <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                          of <var>privateKeyInfo</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>params</var> is not an instance of the\n                          <code>ECParameters</code> ASN.1 type defined in\n                          [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>] that specifies a\n                          <code>namedCurve</code>, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>namedCurve</var> be a string whose initial value is\n                          undefined.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If <var>params</var> is equivalent to the <code>secp256r1</code>\n                            object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]:\n                          </dt>\n                          <dd>\n                            <p>\n                              Set <var>namedCurve</var> \"<code>P-256</code>\".\n                            </p>\n                          </dd>\n                          <dt>\n                            If <var>params</var> is equivalent to the <code>secp384r1</code>\n                            object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]:\n                          </dt>\n                          <dd>\n                            <p>\n                              Set <var>namedCurve</var> \"<code>P-384</code>\".\n                            </p>\n                          </dd>\n                          <dt>\n                            If <var>params</var> is equivalent to the <code>secp521r1</code>\n                            object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]:\n                          </dt>\n                          <dd>\n                            <p>\n                              Set <var>namedCurve</var> \"<code>P-521</code>\".\n                            </p>\n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If params is equivalent to the secp256r1 object identifier defined in [RFC5480]:",
                              "html": "<p>\n                              Set <var>namedCurve</var> \"<code>P-256</code>\".\n                            </p>"
                            },
                            {
                              "case": "If params is equivalent to the secp384r1 object identifier defined in [RFC5480]:",
                              "html": "<p>\n                              Set <var>namedCurve</var> \"<code>P-384</code>\".\n                            </p>"
                            },
                            {
                              "case": "If params is equivalent to the secp521r1 object identifier defined in [RFC5480]:",
                              "html": "<p>\n                              Set <var>namedCurve</var> \"<code>P-521</code>\".\n                            </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If <var>namedCurve</var> is not undefined:</dt>\n                          <dd>\n                            \n                          </dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If namedCurve is not undefined:",
                              "html": "",
                              "rationale": "let",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Let <var>ecPrivateKey</var> be the result of performing the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-an-asn1-structure\" class=\"internalDFN\" id=\"ref-for-concept-parse-an-asn1-structure-9\">parse an ASN.1 structure</a>\n                                  algorithm, with <var>data</var> as the <code>privateKey</code> field\n                                  of <var>privateKeyInfo</var>, <var>structure</var> as the ASN.1\n                                  <code>ECPrivateKey</code> structure specified in Section 3 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5915\" title=\"Elliptic Curve Private Key Structure\">RFC5915</a></cite>], and <var>exactData</var> set to true.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If an error occurred while parsing,\n                                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If the <code>parameters</code> field of <var>ecPrivateKey</var> is\n                                  present, and is not an instance of the <code>namedCurve</code> ASN.1\n                                  type defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>], or does not contain\n                                  the same object identifier as the <code>parameters</code> field of the\n                                  <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                                  of <var>privateKeyInfo</var>,\n                                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-68\"><code>CryptoKey</code></a>\n                                  that represents the Elliptic Curve private key identified by\n                                  performing the conversion steps defined in Section 3 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5915\" title=\"Elliptic Curve Private Key Structure\">RFC5915</a></cite>] using <var>ecPrivateKey</var>.\n                                </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"ECDSA key import steps\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdsa-extended-import-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdsa-extended-import-steps-2\">key import steps</a> defined by\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-21\">other applicable\n                                  specifications</a>, passing <var>format</var>, <var>privateKeyInfo</var>\n                                  and obtaining <var>namedCurve</var> and <var>key</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If an error occurred or there are no\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-22\">applicable\n                                  specifications</a>,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If <var>namedCurve</var> is defined, and not equal to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyImportParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyImportParams-namedCurve-4\"><code>namedCurve</code></a> member of\n                          <var>normalizedAlgorithm</var>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the private key value is not a valid point on the Elliptic Curve\n                          identified by the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyImportParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyImportParams-namedCurve-5\"><code>namedCurve</code></a> member of\n                          <var>normalizedAlgorithm</var> <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-46\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-26\"><code>private</code></a>\"\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>algorithm</var> be a new <a data-link-type=\"idl\" data-lt=\"EcKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-4\"><code>EcKeyAlgorithm</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-22\"><code>name</code></a> attribute of\n                          <var>algorithm</var> to \"<code>ECDSA</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-8\"><code>namedCurve</code></a>\n                          attribute of <var>algorithm</var> to <var>namedCurve</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-44\"><code>[[algorithm]]</code></a>\n                          internal slot of <var>key</var> to <var>algorithm</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If <var>keyData</var> is a <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-14\"><code>JsonWebKey</code></a> dictionary:</dt>\n                          <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                          <dt>Otherwise:</dt>\n                          <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-13\"><code>d</code></a> field is present and <var>usages</var> contains\n                          a value which is not\n                          \"<code>sign</code>\", or,\n                          if the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-14\"><code>d</code></a> field is not present and <var>usages</var> contains\n                          a value which is not\n                          \"<code>verify</code>\"\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-kty\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-kty-5\"><code>kty</code></a> field of <var>jwk</var> is not\n                          \"<code>EC</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>usages</var> is non-empty and the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-use\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-use-4\"><code>use</code></a> field of <var>jwk</var> is present and is\n                          not  \"<code>sig</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-key_ops\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-key_ops-4\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                          is invalid according to the requirements of JSON Web\n                          Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>], or it does not contain all of the specified <var>usages</var>\n                          values,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-ext\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-ext-6\"><code>ext</code></a> field of <var>jwk</var> is present and\n                          has the value false and <var>extractable</var> is true,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>namedCurve</var> be a string whose value is equal to the\n                          <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-crv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-crv-1\"><code>crv</code></a> field of <var>jwk</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>namedCurve</var> is not equal to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyImportParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyImportParams-namedCurve-6\"><code>namedCurve</code></a> member of\n                          <var>normalizedAlgorithm</var>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If <var>namedCurve</var> is equal to \"<code>P-256</code>\",\n                            \"<code>P-384</code>\" or \"<code>P-521</code>\":\n                          </dt>\n                          <dd>\n                            \n                          </dd>\n                          <dt>\n                            Otherwise:\n                          </dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If namedCurve is equal to \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "",
                              "rationale": "let",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Let <var>algNamedCurve</var> be a string whose initial value is\n                                  undefined.\n                                </p>"
                                },
                                {
                                  "html": "<dl class=\"switch\">\n                                  <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-11\"><code>alg</code></a> field is not present:</dt>\n                                  <dd>\n                                    Let <var>algNamedCurve</var> be undefined.\n                                  </dd>\n                                  <dt>\n                                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-12\"><code>alg</code></a> field is equal to the string \"ES256\":\n                                  </dt>\n                                  <dd>\n                                    Let <var>algNamedCurve</var> be the string \"<code>P-256</code>\".\n                                  </dd>\n                                  <dt>\n                                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-13\"><code>alg</code></a> field is equal to the string \"ES384\":\n                                  </dt>\n                                  <dd>\n                                    Let <var>algNamedCurve</var> be the string \"<code>P-384</code>\".\n                                  </dd>\n                                  <dt>\n                                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-14\"><code>alg</code></a> field is equal to the string \"ES512\":\n                                  </dt>\n                                  <dd>\n                                    Let <var>algNamedCurve</var> be the string \"<code>P-521</code>\".\n                                  </dd>\n                                  <dt>otherwise:</dt>\n                                  <dd>\n                                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                    <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                  </dd>\n                                </dl>",
                                  "rationale": ".switch",
                                  "steps": [
                                    {
                                      "operation": "switch",
                                      "steps": [
                                        {
                                          "case": "If the alg field is not present:",
                                          "html": "Let <var>algNamedCurve</var> be undefined."
                                        },
                                        {
                                          "case": "If the alg field is equal to the string \"ES256\":",
                                          "html": "Let <var>algNamedCurve</var> be the string \"<code>P-256</code>\"."
                                        },
                                        {
                                          "case": "If the alg field is equal to the string \"ES384\":",
                                          "html": "Let <var>algNamedCurve</var> be the string \"<code>P-384</code>\"."
                                        },
                                        {
                                          "case": "If the alg field is equal to the string \"ES512\":",
                                          "html": "Let <var>algNamedCurve</var> be the string \"<code>P-521</code>\"."
                                        },
                                        {
                                          "case": "otherwise:",
                                          "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                    <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "html": "<p>\n                                  If <var>algNamedCurve</var> is defined, and is not equal to\n                                  <var>namedCurve</var>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<dl class=\"switch\">\n                                  <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-15\"><code>d</code></a> field is present:</dt>\n                                  <dd>\n                                    \n                                  </dd>\n                                  <dt>Otherwise:</dt>\n                                  <dd>\n                                    \n                                  </dd>\n                                </dl>",
                                  "rationale": ".switch",
                                  "steps": [
                                    {
                                      "operation": "switch",
                                      "steps": [
                                        {
                                          "case": "If the d field is present:",
                                          "html": "",
                                          "rationale": "if",
                                          "steps": [
                                            {
                                              "html": "<p>\n                                          If <var>jwk</var> does not meet the requirements of Section\n                                          6.2.2 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>], then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                        </p>"
                                            },
                                            {
                                              "html": "<p>\n                                          Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-69\"><code>CryptoKey</code></a> object that represents the\n                                          Elliptic Curve private key identified by interpreting\n                                          <var>jwk</var> according to Section 6.2.2 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                                        </p>"
                                            },
                                            {
                                              "html": "<p>\n                                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-47\"><code>[[type]]</code></a>\n                                          internal slot of <var>Key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-27\"><code>private</code></a>\".\n                                        </p>"
                                            }
                                          ]
                                        },
                                        {
                                          "case": "Otherwise:",
                                          "html": "",
                                          "rationale": "if",
                                          "steps": [
                                            {
                                              "html": "<p>\n                                          If <var>jwk</var> does not meet the requirements of Section\n                                          6.2.1 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>], then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                        </p>"
                                            },
                                            {
                                              "html": "<p>\n                                          Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-70\"><code>CryptoKey</code></a> object that represents the\n                                          Elliptic Curve public key identified by interpreting\n                                          <var>jwk</var> according to Section 6.2.1 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                                        </p>"
                                            },
                                            {
                                              "html": "<p>\n                                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-48\"><code>[[type]]</code></a>\n                                          internal slot of <var>Key</var> to \"<code>public</code>\".\n                                        </p>"
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"ECDSA key import steps\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdsa-extended-import-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdsa-extended-import-steps-3\">key import steps</a> defined by\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-23\">other applicable\n                                  specifications</a>, passing <var>format</var>, <var>jwk</var>\n                                  and obtaining <var>key</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If an error occurred or there are no\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-24\">applicable\n                                  specifications</a>,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If the key value is not a valid point on the Elliptic Curve\n                          identified by the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyImportParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyImportParams-namedCurve-7\"><code>namedCurve</code></a> member of\n                          <var>normalizedAlgorithm</var> <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>algorithm</var> be a new instance of an <a data-link-type=\"idl\" data-lt=\"EcKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-5\"><code>EcKeyAlgorithm</code></a> object.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-23\"><code>name</code></a> attribute of\n                          <var>algorithm</var> to \"<code>ECDSA</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-9\"><code>namedCurve</code></a>\n                          attribute of <var>algorithm</var> to <var>namedCurve</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-45\"><code>[[algorithm]]</code></a>\n                          internal slot of <var>key</var> to <var>algorithm</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyImportParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyImportParams-namedCurve-8\"><code>namedCurve</code></a>\n                          member of <var>normalizedAlgorithm</var> is not a\n                          <a href=\"https://w3c.github.io/webcrypto/#dfn-NamedCurve\" id=\"ref-for-dfn-NamedCurve-6\">named curve</a>,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>usages</var> contains a value which is not\n                          \"<code>verify</code>\"\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If <var>namedCurve</var> is \"<code>P-256</code>\",\n                            \"<code>P-384</code>\" or \"<code>P-521</code>\":\n                          </dt>\n                          <dd>\n                            \n                          </dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If namedCurve is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "",
                              "rationale": "let",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Let <var>Q</var> be the elliptic curve point on the curve identified\n                                  by the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyImportParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyImportParams-namedCurve-9\"><code>namedCurve</code></a>\n                                  member of <var>normalizedAlgorithm</var> identified by performing\n                                  the conversion steps defined in Section 2.3.4 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-sec1\" title=\"SEC 1: Elliptic Curve Cryptography\">SEC1</a></cite>] on <var>keyData</var>.\n                                </p>\n                                <p>\n                                  The uncompressed point format <em class=\"rfc2119\">MUST</em> be supported.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If the implementation does not support the compressed point format and\n                                  a compressed point is provided,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If a decode error occurs or an identity point is found,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-71\"><code>CryptoKey</code></a>\n                                  that represents <var>Q</var>.\n                                </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"ECDH key import steps\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdh-extended-import-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdh-extended-import-steps-1\">key import steps</a> defined by\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-25\">other applicable\n                                  specifications</a>, passing <var>format</var>, <var>keyData</var>\n                                  and obtaining <var>key</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If an error occurred or there are no\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-26\">applicable\n                                  specifications</a>,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Let <var>algorithm</var> be a new <a data-link-type=\"idl\" data-lt=\"EcKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-6\"><code>EcKeyAlgorithm</code></a> object.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-24\"><code>name</code></a> attribute of\n                          <var>algorithm</var> to \"<code>ECDSA</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-10\"><code>namedCurve</code></a>\n                          attribute of <var>algorithm</var> to equal the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyImportParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyImportParams-namedCurve-10\"><code>namedCurve</code></a> member of\n                          <var>normalizedAlgorithm</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-49\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> to \"<code>public</code>\"\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-46\"><code>[[algorithm]]</code></a>\n                          internal slot of <var>key</var> to <var>algorithm</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Return <var>key</var>\n                </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>key</var> be the <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-72\"><code>CryptoKey</code></a> to be\n                  exported.\n                </p>"
        },
        {
          "html": "<p>\n                  If the underlying cryptographic key material represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-22\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n                  cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-14\"><code>spki</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-14\"><code>pkcs8</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-14\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>\n                    If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-11\"><code>raw</code></a>\":\n                  </dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-50\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "Set the <var>parameters</var> field to an instance of the\n                                  <code>ECParameters</code> ASN.1 type defined in\n                                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>] as follows:",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "Let <var>keyData</var> be the\n                                      <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> that\n                                      represents the Elliptic Curve public key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-23\"><code>[[handle]]</code></a> internal slot of\n                                      <var>key</var> according to the encoding rules specified in\n                                      Section 2.2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>] and using the\n                                      uncompressed form. and <var>keyData</var>.",
                              "rationale": ".switch",
                              "steps": [
                                {
                                  "operation": "switch",
                                  "steps": [
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\":",
                                      "html": "<p>\n                                          Set <var>parameters</var> to the <code>namedCurve</code> choice\n                                          with value equal to the object identifier\n                                          <code>secp256r1</code> defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]\n                                        </p>"
                                    },
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-384\":",
                                      "html": "<p>\n                                          Set <var>parameters</var> to the <code>namedCurve</code> choice\n                                          with value equal to the object identifier\n                                          <code>secp384r1</code> defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]\n                                        </p>"
                                    },
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-521\":",
                                      "html": "<p>\n                                          Set <var>parameters</var> to the <code>namedCurve</code> choice\n                                          with value equal to the object identifier\n                                          <code>secp521r1</code> defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]\n                                        </p>"
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                          Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"ECDSA key export steps\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdsa-extended-export-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdsa-extended-export-steps-1\">key export steps</a>\n                                          defined by <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-27\">other applicable\n                                          specifications</a>, passing <var>format</var> and the\n                                          <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-15\"><code>namedCurve</code></a> attribute of\n                                          the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-51\"><code>[[algorithm]]</code></a>\n                                          internal slot of <var>key</var>\n                                          and obtaining <var>namedCurveOid</var> and <var>keyData</var>.\n                                        </p>"
                                },
                                {
                                  "html": "<p>\n                                          Set <var>parameters</var> to the <code>namedCurve</code> choice\n                                          with value equal to the object identifier <var>namedCurveOid</var>.\n                                        </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be the result of DER-encoding <var>data</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-51\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> is not \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-28\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "Set the <var>parameters</var> field to an instance of the\n                                  <code>ECParameters</code> ASN.1 type defined in\n                                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>] as follows:",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "Let <var>keyData</var> be the result of DER-encoding\n                                      an instance of the <code>ECPrivateKey</code> structure defined in\n                                      Section 3 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5915\" title=\"Elliptic Curve Private Key Structure\">RFC5915</a></cite>] for the Elliptic\n                                      Curve private key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-24\"><code>[[handle]]</code></a> internal slot of\n                                      <var>key</var> and that conforms to the following:",
                              "rationale": ".switch",
                              "steps": [
                                {
                                  "operation": "switch",
                                  "steps": [
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\":",
                                      "html": "<p>\n                                          Set <var>parameters</var> to the <code>namedCurve</code> choice\n                                          with value equal to the object identifier\n                                          <code>secp256r1</code> defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]\n                                        </p>"
                                    },
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-384\":",
                                      "html": "<p>\n                                          Set <var>parameters</var> to the <code>namedCurve</code> choice\n                                          with value equal to the object identifier\n                                          <code>secp384r1</code> defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]\n                                        </p>"
                                    },
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-521\":",
                                      "html": "<p>\n                                          Set <var>parameters</var> to the <code>namedCurve</code> choice\n                                          with value equal to the object identifier\n                                          <code>secp521r1</code> defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]\n                                        </p>"
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                          Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"ECDSA key export steps\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdsa-extended-export-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdsa-extended-export-steps-2\">key export steps</a>\n                                          defined by <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-28\">other applicable\n                                          specifications</a>, passing <var>format</var> and the\n                                          <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-20\"><code>namedCurve</code></a> attribute of\n                                          the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-56\"><code>[[algorithm]]</code></a>\n                                          internal slot of <var>key</var>\n                                          and obtaining <var>namedCurveOid</var> and <var>keyData</var>.\n                                        </p>"
                                },
                                {
                                  "html": "<p>\n                                          Set <var>parameters</var> to the <code>namedCurve</code> choice\n                                          with value equal to the object identifier <var>namedCurveOid</var>.\n                                        </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be the result of DER-encoding <var>data</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>jwk</var> be a new <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-15\"><code>JsonWebKey</code></a>\n                          dictionary.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>kty</code> attribute of <var>jwk</var> to\n                          \"<code>EC</code>\".\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-21\"><code>namedCurve</code></a>\n                            attribute of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-57\"><code>[[algorithm]]</code></a> internal slot\n                            of <var>key</var> is \"<code>P-256</code>\", \"<code>P-384</code>\" or\n                            \"<code>P-521</code>\":\n                          </dt>\n                          <dd>\n                            \n                          </dd>\n                          <dt>\n                            Otherwise:\n                          </dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<dl class=\"switch\">\n                                  <dt>\n                                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-22\"><code>namedCurve</code></a>\n                                    attribute of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-58\"><code>[[algorithm]]</code></a> internal slot\n                                    of <var>key</var> is \"<code>P-256</code>\":\n                                  </dt>\n                                  <dd>\n                                    Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-crv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-crv-2\"><code>crv</code></a> attribute of <var>jwk</var> to\n                                    \"<code>P-256</code>\"\n                                  </dd>\n                                  <dt>\n                                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-23\"><code>namedCurve</code></a>\n                                    attribute of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-59\"><code>[[algorithm]]</code></a> internal slot\n                                    of <var>key</var> is \"<code>P-384</code>\":\n                                  </dt>\n                                  <dd>\n                                    Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-crv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-crv-3\"><code>crv</code></a> attribute of <var>jwk</var> to\n                                    \"<code>P-384</code>\"\n                                  </dd>\n                                  <dt>\n                                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-24\"><code>namedCurve</code></a>\n                                    attribute of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-60\"><code>[[algorithm]]</code></a> internal slot\n                                    of <var>key</var> is \"<code>P-521</code>\":\n                                  </dt>\n                                  <dd>\n                                    Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-crv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-crv-4\"><code>crv</code></a> attribute of <var>jwk</var> to\n                                    \"<code>P-521</code>\"\n                                  </dd>\n                                </dl>",
                                  "rationale": ".switch",
                                  "steps": [
                                    {
                                      "operation": "switch",
                                      "steps": [
                                        {
                                          "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\":",
                                          "html": "Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-crv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-crv-2\"><code>crv</code></a> attribute of <var>jwk</var> to\n                                    \"<code>P-256</code>\""
                                        },
                                        {
                                          "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-384\":",
                                          "html": "Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-crv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-crv-3\"><code>crv</code></a> attribute of <var>jwk</var> to\n                                    \"<code>P-384</code>\""
                                        },
                                        {
                                          "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-521\":",
                                          "html": "Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-crv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-crv-4\"><code>crv</code></a> attribute of <var>jwk</var> to\n                                    \"<code>P-521</code>\""
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "html": "<p>\n                                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-x\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-x-1\"><code>x</code></a> attribute of <var>jwk</var> according to the\n                                  definition in Section 6.2.1.2 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-y\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-y-1\"><code>y</code></a> attribute of <var>jwk</var> according to the\n                                  definition in Section 6.2.1.3 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                                </p>"
                                },
                                {
                                  "html": "<dl class=\"switch\">\n                                  <dt>\n                                    If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-52\"><code>[[type]]</code></a> internal slot\n                                    of <var>key</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-29\"><code>private</code></a>\"\n                                  </dt>\n                                  <dd>\n                                    <p>\n                                      Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-16\"><code>d</code></a> attribute of <var>jwk</var> according to\n                                      the definition in Section 6.2.2.1 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                                    </p>\n                                  </dd>\n                                </dl>",
                                  "rationale": ".switch",
                                  "steps": [
                                    {
                                      "operation": "switch",
                                      "steps": [
                                        {
                                          "case": "If the [[type]] internal slot of key is \"private\"",
                                          "html": "<p>\n                                      Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-16\"><code>d</code></a> attribute of <var>jwk</var> according to\n                                      the definition in Section 6.2.2.1 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                                    </p>"
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"ECDSA key export steps\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdsa-extended-export-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdsa-extended-export-steps-3\">key export steps</a>\n                                  defined by <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-29\">other applicable\n                                  specifications</a>, passing <var>format</var> and the\n                                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-25\"><code>namedCurve</code></a> attribute of\n                                  the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-61\"><code>[[algorithm]]</code></a>\n                                  internal slot of <var>key</var>\n                                  and obtaining <var>namedCurve</var> and a new value of <var>jwk</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-crv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-crv-5\"><code>crv</code></a> attribute of <var>jwk</var> to\n                                  <var>namedCurve</var>.\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-cryptokey-usages\" class=\"internalDFN\" id=\"ref-for-dom-cryptokey-usages-4\"><code>usages</code></a> attribute of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>ext</code> attribute of <var>jwk</var> to the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-21\"><code>[[extractable]]</code></a> internal slot\n                          of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>jwk</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-53\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-26\"><code>namedCurve</code></a>\n                            attribute of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-62\"><code>[[algorithm]]</code></a> internal slot\n                            of <var>key</var> is \"<code>P-256</code>\", \"<code>P-384</code>\"\n                            or \"<code>P-521</code>\":\n                          </dt>\n                          <dd>\n                            <p>\n                              Let <var>data</var> be a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> representing the Elliptic Curve\n                              point <var>Q</var> represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-26\"><code>[[handle]]</code></a> internal slot of\n                              <var>key</var> according to [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-sec1\" title=\"SEC 1: Elliptic Curve Cryptography\">SEC1</a></cite>] 2.3.3 using the uncompressed format.\n                            </p>\n                          </dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            <p>\n                              Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"ECDH key export steps\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdh-extended-export-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdh-extended-export-steps-1\">key export steps</a>\n                              defined by <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-30\">other applicable\n                              specifications</a>, passing <var>format</var> and the\n                              <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-27\"><code>namedCurve</code></a> attribute of\n                              the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-63\"><code>[[algorithm]]</code></a>\n                              internal slot of <var>key</var>\n                              and obtaining <var>namedCurve</var> and <var>data</var>.\n                            </p>\n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "<p>\n                              Let <var>data</var> be a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> representing the Elliptic Curve\n                              point <var>Q</var> represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-26\"><code>[[handle]]</code></a> internal slot of\n                              <var>key</var> according to [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-sec1\" title=\"SEC 1: Elliptic Curve Cryptography\">SEC1</a></cite>] 2.3.3 using the uncompressed format.\n                            </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p>\n                              Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"ECDH key export steps\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdh-extended-export-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdh-extended-export-steps-1\">key export steps</a>\n                              defined by <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-30\">other applicable\n                              specifications</a>, passing <var>format</var> and the\n                              <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-27\"><code>namedCurve</code></a> attribute of\n                              the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-63\"><code>[[algorithm]]</code></a>\n                              internal slot of <var>key</var>\n                              and obtaining <var>namedCurve</var> and <var>data</var>.\n                            </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>data</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>usages</var> contains an entry which is not\n                  \"<code>deriveKey</code>\" or \"<code>deriveBits</code>\"\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>\n                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyGenParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyGenParams-namedCurve-5\"><code>namedCurve</code></a> member of\n                    <var>normalizedAlgorithm</var> is \"<code>P-256</code>\", \"<code>P-384</code>\"\n                    or \"<code>P-521</code>\":\n                  </dt>\n                  <dd>\n                    <p>\n                      Generate an Elliptic Curve key pair, as defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc6090\" title=\"Fundamental Elliptic Curve Cryptography Algorithms\">RFC6090</a></cite>] with domain parameters for the curve identified by\n                      the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyGenParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyGenParams-namedCurve-6\"><code>namedCurve</code></a> member of\n                      <var>normalizedAlgorithm</var>.\n                    </p>\n                  </dd>\n                  <dt>\n                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyGenParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyGenParams-namedCurve-7\"><code>namedCurve</code></a> member of\n                    <var>normalizedAlgorithm</var> is a value specified in an\n                    <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-32\">applicable specification</a> that\n                    specifies the use of that value with ECDH:\n                  </dt>\n                  <dd>\n                    <p>\n                      Perform the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdh-extended-generation-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdh-extended-generation-steps-1\">ECDH generation steps</a> specified in that specification, passing in\n                      <var>normalizedAlgorithm</var> and resulting in an elliptic curve key pair.\n                    </p>\n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the namedCurve member of normalizedAlgorithm is \"P-256\", \"P-384\" or \"P-521\":",
                  "html": "<p>\n                      Generate an Elliptic Curve key pair, as defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc6090\" title=\"Fundamental Elliptic Curve Cryptography Algorithms\">RFC6090</a></cite>] with domain parameters for the curve identified by\n                      the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyGenParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyGenParams-namedCurve-6\"><code>namedCurve</code></a> member of\n                      <var>normalizedAlgorithm</var>.\n                    </p>"
                },
                {
                  "case": "If the namedCurve member of normalizedAlgorithm is a value specified in an applicable specification that specifies the use of that value with ECDH:",
                  "html": "<p>\n                      Perform the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdh-extended-generation-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdh-extended-generation-steps-1\">ECDH generation steps</a> specified in that specification, passing in\n                      <var>normalizedAlgorithm</var> and resulting in an elliptic curve key pair.\n                    </p>"
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  If performing the operation results in an error,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"EcKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-7\"><code>EcKeyAlgorithm</code></a>\n                  object.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-algorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-algorithm-name-13\"><code>name</code></a> member of\n                  <var>algorithm</var> to \"<code>ECDH</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-28\"><code>namedCurve</code></a>\n                  attribute of <var>algorithm</var> to equal the\n                  <a data-link-type=\"idl\" data-lt=\"namedCurve\" href=\"https://w3c.github.io/webcrypto/#dfn-NamedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-NamedCurve-7\"><code>namedCurve</code></a> member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>publicKey</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-75\"><code>CryptoKey</code></a>\n                  representing the public key of the generated key pair.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-54\"><code>[[type]]</code></a> internal slot of\n                  <var>publicKey</var> to \"<code>public</code>\"\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-64\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>publicKey</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-22\"><code>[[extractable]]</code></a> internal\n                  slot of <var>publicKey</var> to true.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-25\"><code>[[usages]]</code></a> internal slot of\n                  <var>publicKey</var> to be the empty list.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>privateKey</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-76\"><code>CryptoKey</code></a>\n                  representing the private key of the generated key pair.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-55\"><code>[[type]]</code></a> internal slot of\n                  <var>privateKey</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-30\"><code>private</code></a>\"\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-65\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>privateKey</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-23\"><code>[[extractable]]</code></a> internal\n                  slot of <var>privateKey</var> to <var>extractable</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-26\"><code>[[usages]]</code></a> internal slot of\n                  <var>privateKey</var> to be the\n                  <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-usage-intersection\" class=\"internalDFN\" id=\"ref-for-concept-usage-intersection-10\">usage intersection</a> of\n                  <var>usages</var> and <code>[ \"deriveKey\", \"deriveBits\" ]</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKeyPair\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-13\"><code>CryptoKeyPair</code></a>\n                  dictionary.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair-publicKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-publicKey-6\"><code>publicKey</code></a> attribute\n                  of <var>result</var> to be <var>publicKey</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair-privateKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-privateKey-7\"><code>privateKey</code></a> attribute\n                  of <var>result</var> to be <var>privateKey</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-56\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> is not \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-31\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>publicKey</var> be the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcdhKeyDeriveParams-public\" class=\"internalDFN\" id=\"ref-for-dfn-EcdhKeyDeriveParams-public-2\"><code>public</code></a> member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-57\"><code>[[type]]</code></a> internal slot of\n                  <var>publicKey</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-25\"><code>name</code></a> attribute of\n                  the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-66\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>publicKey</var> is not equal to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-26\"><code>name</code></a> property of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-67\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var>, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-29\"><code>namedCurve</code></a> attribute of\n                  the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-68\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>publicKey</var> is not equal to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-30\"><code>namedCurve</code></a> property of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-69\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var>, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>\n                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-31\"><code>namedCurve</code></a> property of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-70\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var> is \"<code>P-256</code>\", \"<code>P-384</code>\"\n                    or \"<code>P-521</code>\":\n                  </dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>\n                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-32\"><code>namedCurve</code></a> property of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-71\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var> is a value specified in an\n                    <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-33\">applicable specification</a> that\n                    specifies the use of that value with ECDH:\n                  </dt>\n                  <dd>\n                    <p>\n                      Perform the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdh-extended-derivation-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdh-extended-derivation-steps-1\">ECDH derivation steps</a> specified in that specification, passing in\n                      <var>key</var> and <var>publicKey</var> and resulting in <var>secret</var>.\n                    </p>\n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the namedCurve property of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                  "html": "",
                  "rationale": "perform",
                  "steps": [
                    {
                      "html": "<p>\n                          Perform the ECDH primitive specified in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc6090\" title=\"Fundamental Elliptic Curve Cryptography Algorithms\">RFC6090</a></cite>] Section\n                          4 with <var>key</var> as the EC private key <var>d</var> and the EC public\n                          key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-27\"><code>[[handle]]</code></a>\n                          internal slot of <var>publicKey</var> as the EC public key.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>secret</var> be a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> containing\n                          the result of applying the field element to\n                          octet string conversion defined in Section\n                          6.2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc6090\" title=\"Fundamental Elliptic Curve Cryptography Algorithms\">RFC6090</a></cite>]\n                          to the output of the ECDH primitive.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If the namedCurve property of the [[algorithm]] internal slot of key is a value specified in an applicable specification that specifies the use of that value with ECDH:",
                  "html": "<p>\n                      Perform the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdh-extended-derivation-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdh-extended-derivation-steps-1\">ECDH derivation steps</a> specified in that specification, passing in\n                      <var>key</var> and <var>publicKey</var> and resulting in <var>secret</var>.\n                    </p>"
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  If performing the operation results in an error,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>length</var> is null:</dt>\n                  <dd>Return <var>secret</var></dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <dl class=\"switch\">\n                      <dt>\n                        If the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-1\">length in bits</a> of <var>secret</var> is less than\n                        <var>length</var>:\n                      </dt>\n                      <dd>\n                        <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                        <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                      </dd>\n                      <dt>Otherwise:</dt>\n                      <dd>\n                        Return a <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-byte-sequence-containing\" class=\"internalDFN\" id=\"ref-for-dfn-byte-sequence-containing-1\">byte sequence containing</a> the first <var>length</var> bits of <var>secret</var>.\n                      </dd>\n                    </dl>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If length is null:",
                  "html": "Return <var>secret</var>"
                },
                {
                  "case": "Otherwise:",
                  "html": "<dl class=\"switch\">\n                      <dt>\n                        If the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-1\">length in bits</a> of <var>secret</var> is less than\n                        <var>length</var>:\n                      </dt>\n                      <dd>\n                        <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                        <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                      </dd>\n                      <dt>Otherwise:</dt>\n                      <dd>\n                        Return a <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-byte-sequence-containing\" class=\"internalDFN\" id=\"ref-for-dfn-byte-sequence-containing-1\">byte sequence containing</a> the first <var>length</var> bits of <var>secret</var>.\n                      </dd>\n                    </dl>",
                  "rationale": ".switch",
                  "steps": [
                    {
                      "operation": "switch",
                      "steps": [
                        {
                          "case": "If the length in bits of secret is less than length:",
                          "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                        <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>."
                        },
                        {
                          "case": "Otherwise:",
                          "html": "Return a <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-byte-sequence-containing\" class=\"internalDFN\" id=\"ref-for-dfn-byte-sequence-containing-1\">byte sequence containing</a> the first <var>length</var> bits of <var>secret</var>."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-15\"><code>spki</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-15\"><code>pkcs8</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-15\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-12\"><code>raw</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If <var>usages</var> is not empty\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>spki</var> be the result of running the\n                          <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-a-spki\" class=\"internalDFN\" id=\"ref-for-concept-parse-a-spki-5\">parse a subjectPublicKeyInfo</a>\n                          algorithm over <var>keyData</var>\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurred while parsing,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>algorithm</code> object identifier field of the\n                          <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is\n                          not equal to the <code>id-ecPublicKey</code>\n                          object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>parameters</code> field of the <code>algorithm</code>\n                          AlgorithmIdentifier field of <var>spki</var> is absent,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>params</var> be the <code>parameters</code> field of the\n                          <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>params</var> is not an instance of the\n                          <code>ECParameters</code> ASN.1 type defined in\n                          [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>] that specifies a\n                          <code>namedCurve</code>, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>namedCurve</var> be a string whose initial value is\n                          undefined.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If <var>params</var> is equivalent to the <code>secp256r1</code>\n                            object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]:\n                          </dt>\n                          <dd>\n                            <p>\n                              Set <var>namedCurve</var> \"<code>P-256</code>\".\n                            </p>\n                          </dd>\n                          <dt>\n                            If <var>params</var> is equivalent to the <code>secp384r1</code>\n                            object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]:\n                          </dt>\n                          <dd>\n                            <p>\n                              Set <var>namedCurve</var> \"<code>P-384</code>\".\n                            </p>\n                          </dd>\n                          <dt>\n                            If <var>params</var> is equivalent to the <code>secp521r1</code>\n                            object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]:\n                          </dt>\n                          <dd>\n                            <p>\n                              Set <var>namedCurve</var> \"<code>P-521</code>\".\n                            </p>\n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If params is equivalent to the secp256r1 object identifier defined in [RFC5480]:",
                              "html": "<p>\n                              Set <var>namedCurve</var> \"<code>P-256</code>\".\n                            </p>"
                            },
                            {
                              "case": "If params is equivalent to the secp384r1 object identifier defined in [RFC5480]:",
                              "html": "<p>\n                              Set <var>namedCurve</var> \"<code>P-384</code>\".\n                            </p>"
                            },
                            {
                              "case": "If params is equivalent to the secp521r1 object identifier defined in [RFC5480]:",
                              "html": "<p>\n                              Set <var>namedCurve</var> \"<code>P-521</code>\".\n                            </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If <var>namedCurve</var> is not undefined:</dt>\n                          <dd>\n                            \n                          </dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If namedCurve is not undefined:",
                              "html": "",
                              "rationale": "let",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Let <var>publicKey</var> be the Elliptic Curve public key identified by\n                                  performing the conversion steps defined in Section 2.3.4 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-sec1\" title=\"SEC 1: Elliptic Curve Cryptography\">SEC1</a></cite>] to the <code>subjectPublicKey</code> field of\n                                  <var>spki</var>.\n                                </p>\n                                <p>\n                                  The uncompressed point format <em class=\"rfc2119\">MUST</em> be supported.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If the implementation does not support the compressed point format and\n                                  a compressed point is provided,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If a decode error occurs or an identity point is found,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-77\"><code>CryptoKey</code></a>\n                                  that represents <var>publicKey</var>.\n                                </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"ECDH key import steps\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdh-extended-import-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdh-extended-import-steps-2\">key import steps</a> defined by\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-34\">other applicable\n                                  specifications</a>, passing <var>format</var>, <var>spki</var>\n                                  and obtaining <var>namedCurve</var> and <var>key</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If an error occurred or there are no\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-35\">applicable\n                                  specifications</a>,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If <var>namedCurve</var> is defined, and not equal to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyImportParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyImportParams-namedCurve-11\"><code>namedCurve</code></a> member of\n                          <var>normalizedAlgorithm</var>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the key value is not a valid point on the Elliptic Curve\n                          identified by the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyImportParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyImportParams-namedCurve-12\"><code>namedCurve</code></a> member of\n                          <var>normalizedAlgorithm</var> <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-58\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> to \"<code>public</code>\"\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>algorithm</var> be a new <a data-link-type=\"idl\" data-lt=\"EcKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-8\"><code>EcKeyAlgorithm</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-27\"><code>name</code></a> attribute of\n                          <var>algorithm</var> to \"<code>ECDH</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-33\"><code>namedCurve</code></a>\n                          attribute of <var>algorithm</var> to <var>namedCurve</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-72\"><code>[[algorithm]]</code></a>\n                          internal slot of <var>key</var> to <var>algorithm</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If <var>usages</var> contains an entry which is not\n                          \"<code>deriveKey</code>\" or \"<code>deriveBits</code>\"\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>privateKeyInfo</var> be the result of running the\n                          <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-a-privateKeyInfo\" class=\"internalDFN\" id=\"ref-for-concept-parse-a-privateKeyInfo-5\">parse a privateKeyInfo</a>\n                          algorithm over <var>keyData</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurs while parsing,\n                          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>algorithm</code> object identifier field of the\n                          <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of\n                          <var>privateKeyInfo</var> is not equal to the\n                          <code>id-ecPublicKey</code> object identifier\n                          defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>],\n                          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>parameters</code> field of the\n                          <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                          of <var>privateKeyInfo</var> is not present,\n                          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>params</var> be the <code>parameters</code> field of the\n                          <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                          of <var>privateKeyInfo</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>params</var> is not an instance of the\n                          <code>ECParameters</code> ASN.1 type defined in\n                          [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>] that specifies a\n                          <code>namedCurve</code>, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>namedCurve</var> be a string whose initial value is\n                          undefined.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If <var>params</var> is equivalent to the <code>secp256r1</code>\n                            object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]:\n                          </dt>\n                          <dd>\n                            <p>\n                              Set <var>namedCurve</var> to \"<code>P-256</code>\".\n                            </p>\n                          </dd>\n                          <dt>\n                            If <var>params</var> is equivalent to the <code>secp384r1</code>\n                            object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]:\n                          </dt>\n                          <dd>\n                            <p>\n                              Set <var>namedCurve</var> to \"<code>P-384</code>\".\n                            </p>\n                          </dd>\n                          <dt>\n                            If <var>params</var> is equivalent to the <code>secp521r1</code>\n                            object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]:\n                          </dt>\n                          <dd>\n                            <p>\n                              Set <var>namedCurve</var> to \"<code>P-521</code>\".\n                            </p>\n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If params is equivalent to the secp256r1 object identifier defined in [RFC5480]:",
                              "html": "<p>\n                              Set <var>namedCurve</var> to \"<code>P-256</code>\".\n                            </p>"
                            },
                            {
                              "case": "If params is equivalent to the secp384r1 object identifier defined in [RFC5480]:",
                              "html": "<p>\n                              Set <var>namedCurve</var> to \"<code>P-384</code>\".\n                            </p>"
                            },
                            {
                              "case": "If params is equivalent to the secp521r1 object identifier defined in [RFC5480]:",
                              "html": "<p>\n                              Set <var>namedCurve</var> to \"<code>P-521</code>\".\n                            </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If <var>namedCurve</var> is not undefined:</dt>\n                          <dd>\n                            \n                          </dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If namedCurve is not undefined:",
                              "html": "",
                              "rationale": "let",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Let <var>ecPrivateKey</var> be the result of performing the\n                                  <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-an-asn1-structure\" class=\"internalDFN\" id=\"ref-for-concept-parse-an-asn1-structure-10\">parse an ASN.1 structure</a>\n                                  algorithm, with <var>data</var> as the <code>privateKey</code> field\n                                  of <var>privateKeyInfo</var>, <var>structure</var> as the ASN.1\n                                  <code>ECPrivateKey</code> structure specified in Section 3 of\n                                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5915\" title=\"Elliptic Curve Private Key Structure\">RFC5915</a></cite>], and <var>exactData</var> set to true.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If an error occurred while parsing,\n                                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If the <code>parameters</code> field of <var>ecPrivateKey</var> is\n                                  present, and is not an instance of the <code>namedCurve</code> ASN.1\n                                  type defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>], or does not contain\n                                  the same object identifier as the <code>parameters</code> field of the\n                                  <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                                  of <var>privateKeyInfo</var>,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-78\"><code>CryptoKey</code></a>\n                                  that represents the Elliptic Curve private key identified by\n                                  performing the conversion steps defined in Section 3 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5915\" title=\"Elliptic Curve Private Key Structure\">RFC5915</a></cite>] using <var>ecPrivateKey</var>.\n                                </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"ECDH key import steps\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdh-extended-import-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdh-extended-import-steps-3\">key import steps</a> defined by\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-36\">other applicable\n                                  specifications</a>, passing <var>format</var>, <var>privateKeyInfo</var>\n                                  and obtaining <var>namedCurve</var> and <var>key</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If an error occurred or there are no\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-37\">applicable\n                                  specifications</a>,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If <var>namedCurve</var> is defined, and not equal to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyImportParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyImportParams-namedCurve-13\"><code>namedCurve</code></a> member of\n                          <var>normalizedAlgorithm</var>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the key value is not a valid point on the Elliptic Curve\n                          identified by the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyImportParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyImportParams-namedCurve-14\"><code>namedCurve</code></a> member of\n                          <var>normalizedAlgorithm</var> <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-59\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-32\"><code>private</code></a>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>algorithm</var> be a new <a data-link-type=\"idl\" data-lt=\"EcKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-9\"><code>EcKeyAlgorithm</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-28\"><code>name</code></a> attribute of\n                          <var>algorithm</var> to \"<code>ECDH</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-34\"><code>namedCurve</code></a>\n                          attribute of <var>algorithm</var> to <var>namedCurve</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-73\"><code>[[algorithm]]</code></a>\n                          internal slot of <var>key</var> to <var>algorithm</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If <var>keyData</var> is a <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-16\"><code>JsonWebKey</code></a> dictionary:</dt>\n                          <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                          <dt>Otherwise:</dt>\n                          <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-17\"><code>d</code></a> field is present and if <var>usages</var>\n                          contains an entry which is not\n                          \"<code>deriveKey</code>\" or \"<code>deriveBits</code>\"\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-18\"><code>d</code></a> field is not present and if <var>usages</var> is not\n                          empty\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-kty\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-kty-6\"><code>kty</code></a> field of <var>jwk</var> is\n                          not \"<code>EC</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>usages</var> is non-empty and the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-use\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-use-5\"><code>use</code></a> field of <var>jwk</var> is present\n                          and is not equal to \"<code>enc</code>\" then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-key_ops\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-key_ops-5\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                          is invalid according to the requirements of JSON Web\n                          Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>], or it does not contain all of the specified <var>usages</var>\n                          values, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-ext\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-ext-7\"><code>ext</code></a> field of <var>jwk</var> is present and\n                          has the value false and <var>extractable</var> is true,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>namedCurve</var> be a string whose value is equal to the\n                          <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-crv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-crv-6\"><code>crv</code></a> field of <var>jwk</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>namedCurve</var> is not equal to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyImportParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyImportParams-namedCurve-15\"><code>namedCurve</code></a> member of\n                          <var>normalizedAlgorithm</var>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If <var>namedCurve</var> is \"<code>P-256</code>\",\n                            \"<code>P-384</code>\" or \"<code>P-521</code>\":\n                          </dt>\n                          <dd>\n                            <dl class=\"switch\">\n                              <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-19\"><code>d</code></a> field is present:</dt>\n                              <dd>\n                                \n                              </dd>\n                              <dt>Otherwise:</dt>\n                              <dd>\n                                \n                              </dd>\n                            </dl>\n                          </dd>\n                          <dt>Otherwise</dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If namedCurve is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "<dl class=\"switch\">\n                              <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-19\"><code>d</code></a> field is present:</dt>\n                              <dd>\n                                \n                              </dd>\n                              <dt>Otherwise:</dt>\n                              <dd>\n                                \n                              </dd>\n                            </dl>",
                              "rationale": ".switch",
                              "steps": [
                                {
                                  "operation": "switch",
                                  "steps": [
                                    {
                                      "case": "If the d field is present:",
                                      "html": "",
                                      "rationale": "if",
                                      "steps": [
                                        {
                                          "html": "<p>\n                                      If <var>jwk</var> does not meet the requirements of Section\n                                      6.2.2 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>], then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                    </p>"
                                        },
                                        {
                                          "html": "<p>\n                                      Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-79\"><code>CryptoKey</code></a> object that represents the\n                                      Elliptic Curve private key identified by interpreting\n                                      <var>jwk</var> according to Section 6.2.2 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                                    </p>"
                                        },
                                        {
                                          "html": "<p>\n                                      Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-60\"><code>[[type]]</code></a>\n                                      internal slot of <var>Key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-33\"><code>private</code></a>\".\n                                    </p>"
                                        }
                                      ]
                                    },
                                    {
                                      "case": "Otherwise:",
                                      "html": "",
                                      "rationale": "if",
                                      "steps": [
                                        {
                                          "html": "<p>\n                                      If <var>jwk</var> does not meet the requirements of Section\n                                      6.2.1 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>], then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                    </p>"
                                        },
                                        {
                                          "html": "<p>\n                                      Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-80\"><code>CryptoKey</code></a> object that represents the\n                                      Elliptic Curve public key identified by interpreting\n                                      <var>jwk</var> according to Section 6.2.1 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                                    </p>"
                                        },
                                        {
                                          "html": "<p>\n                                      Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-61\"><code>[[type]]</code></a>\n                                      internal slot of <var>Key</var> to \"<code>public</code>\".\n                                    </p>"
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "case": "Otherwise",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"ECDH key import steps\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdh-extended-import-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdh-extended-import-steps-4\">key import steps</a> defined by\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-38\">other applicable\n                                  specifications</a>, passing <var>format</var>, <var>jwk</var>\n                                  and obtaining <var>key</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If an error occurred or there are no\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-39\">applicable\n                                  specifications</a>,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If the key value is not a valid point on the Elliptic Curve\n                          identified by the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyImportParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyImportParams-namedCurve-16\"><code>namedCurve</code></a> member of\n                          <var>normalizedAlgorithm</var> <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>algorithm</var> be a new instance of an <a data-link-type=\"idl\" data-lt=\"EcKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-10\"><code>EcKeyAlgorithm</code></a> object.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-29\"><code>name</code></a> attribute of\n                          <var>algorithm</var> to \"<code>ECDH</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-35\"><code>namedCurve</code></a>\n                          attribute of <var>algorithm</var> to <var>namedCurve</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-74\"><code>[[algorithm]]</code></a>\n                          internal slot of <var>key</var> to <var>algorithm</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyImportParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyImportParams-namedCurve-17\"><code>namedCurve</code></a>\n                          member of <var>normalizedAlgorithm</var> is not a\n                          <a href=\"https://w3c.github.io/webcrypto/#dfn-NamedCurve\" id=\"ref-for-dfn-NamedCurve-8\">named curve</a>,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>usages</var> is not the empty list,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If <var>namedCurve</var> is \"<code>P-256</code>\",\n                            \"<code>P-384</code>\" or \"<code>P-521</code>\":\n                          </dt>\n                          <dd>\n                            \n                          </dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If namedCurve is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "",
                              "rationale": "let",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Let <var>Q</var> be the Elliptic Curve public key on the curve identified\n                                  by the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyImportParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyImportParams-namedCurve-18\"><code>namedCurve</code></a>\n                                  member of <var>normalizedAlgorithm</var> identified by performing\n                                  the conversion steps defined in Section 2.3.4 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-sec1\" title=\"SEC 1: Elliptic Curve Cryptography\">SEC1</a></cite>] to <var>keyData</var>.\n                                </p>\n                                <p>\n                                  The uncompressed point format <em class=\"rfc2119\">MUST</em> be supported.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If the implementation does not support the compressed point format and\n                                  a compressed point is provided,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If a decode error occurs or an identity point is found,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-81\"><code>CryptoKey</code></a>\n                                  that represents <var>Q</var>.\n                                </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"ECDH key import steps\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdh-extended-import-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdh-extended-import-steps-5\">key import steps</a> defined by\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-40\">other applicable\n                                  specifications</a>, passing <var>format</var>, <var>keyData</var>\n                                  and obtaining <var>key</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  If an error occured or there are no\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-41\">applicable\n                                  specifications</a>,\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Let <var>algorithm</var> be a new <a data-link-type=\"idl\" data-lt=\"EcKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-11\"><code>EcKeyAlgorithm</code></a> object.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-30\"><code>name</code></a> attribute of\n                          <var>algorithm</var> to \"<code>ECDH</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-36\"><code>namedCurve</code></a>\n                          attribute of <var>algorithm</var> to equal the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyImportParams-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyImportParams-namedCurve-19\"><code>namedCurve</code></a> member of\n                          <var>normalizedAlgorithm</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-62\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> to \"<code>public</code>\"\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-75\"><code>[[algorithm]]</code></a>\n                          internal slot of <var>key</var> to <var>algorithm</var>.\n                        </p>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Return <var>key</var>\n                </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>key</var> be the <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-82\"><code>CryptoKey</code></a> to be\n                  exported.\n                </p>"
        },
        {
          "html": "<p>\n                  If the underlying cryptographic key material represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-28\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n                  cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-16\"><code>spki</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-16\"><code>pkcs8</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-16\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>\n                    If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-13\"><code>raw</code></a>\":\n                  </dt>\n                  <dd>\n                    \n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-63\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "Set the <var>parameters</var> field to an instance of the\n                                  <code>ECParameters</code> ASN.1 type defined in\n                                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>] as follows:",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "Let <var>keyData</var> be the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> that\n                                      represents the Elliptic Curve public key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-29\"><code>[[handle]]</code></a> internal slot of\n                                      <var>key</var> according to the encoding rules specified in\n                                      Section 2.3.3 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-sec1\" title=\"SEC 1: Elliptic Curve Cryptography\">SEC1</a></cite>] and using the\n                                      uncompressed form.",
                              "rationale": ".switch",
                              "steps": [
                                {
                                  "operation": "switch",
                                  "steps": [
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\":",
                                      "html": "<p>\n                                          Set <var>parameters</var> to the <var>namedCurve</var> choice\n                                          with value equal to the object identifier\n                                          <code>secp256r1</code> defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]\n                                        </p>"
                                    },
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-384\":",
                                      "html": "<p>\n                                          Set <var>parameters</var> to the <var>namedCurve</var> choice\n                                          with value equal to the object identifier\n                                          <code>secp384r1</code> defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]\n                                        </p>"
                                    },
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-521\":",
                                      "html": "<p>\n                                          Set <var>parameters</var> to the <var>namedCurve</var> choice\n                                          with value equal to the object identifier\n                                          <code>secp521r1</code> defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]\n                                        </p>"
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                          Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"ECDH key export steps\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdh-extended-export-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdh-extended-export-steps-2\">key export steps</a>\n                                          defined by <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-42\">other applicable\n                                          specifications</a>, passing <var>format</var> and the\n                                          <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-41\"><code>namedCurve</code></a> attribute of\n                                          the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-80\"><code>[[algorithm]]</code></a>\n                                          internal slot of <var>key</var>\n                                          and obtaining <var>namedCurveOid</var> and <var>keyData</var>.\n                                        </p>"
                                },
                                {
                                  "html": "<p>\n                                          Set <var>parameters</var> to the <code>namedCurve</code> choice\n                                          with value equal to the object identifier <var>namedCurveOid</var>.\n                                        </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-64\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> is not \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-34\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "Set the <var>parameters</var> field to an instance of the\n                                  <code>ECParameters</code> ASN.1 type defined in\n                                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>] as follows:",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "Let <var>keyData</var> be the result of DER-encoding\n                                      an instance of the <code>ECPrivateKey</code> structure defined in\n                                      Section 3 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5915\" title=\"Elliptic Curve Private Key Structure\">RFC5915</a></cite>] for the Elliptic\n                                      Curve private key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-30\"><code>[[handle]]</code></a> internal slot of\n                                      <var>key</var> and that conforms to the following:",
                              "rationale": ".switch",
                              "steps": [
                                {
                                  "operation": "switch",
                                  "steps": [
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\":",
                                      "html": "<p>\n                                          Set <var>parameters</var> to the <var>namedCurve</var> choice\n                                          with value equal to the object identifier\n                                          <code>secp256r1</code> defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]\n                                        </p>"
                                    },
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-384\":",
                                      "html": "<p>\n                                          Set <var>parameters</var> to the <var>namedCurve</var> choice\n                                          with value equal to the object identifier\n                                          <code>secp384r1</code> defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]\n                                        </p>"
                                    },
                                    {
                                      "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-521\":",
                                      "html": "<p>\n                                          Set <var>parameters</var> to the <var>namedCurve</var> choice\n                                          with value equal to the object identifier\n                                          <code>secp521r1</code> defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5480\" title=\"Elliptic Curve Cryptography Subject Public Key Information\">RFC5480</a></cite>]\n                                        </p>"
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                          Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"ECDH key export steps\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdh-extended-export-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdh-extended-export-steps-3\">key export steps</a>\n                                          defined by <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-43\">other applicable\n                                          specifications</a>, passing <var>format</var> and the\n                                          <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-46\"><code>namedCurve</code></a> attribute of\n                                          the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-85\"><code>[[algorithm]]</code></a>\n                                          internal slot of <var>key</var>\n                                          and obtaining <var>namedCurveOid</var> and <var>keyData</var>.\n                                        </p>"
                                },
                                {
                                  "html": "<p>\n                                          Set <var>parameters</var> to the <code>namedCurve</code> choice\n                                          with value equal to the object identifier <var>namedCurveOid</var>.\n                                        </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>jwk</var> be a new <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-17\"><code>JsonWebKey</code></a>\n                          dictionary.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>kty</code> attribute of <var>jwk</var> to\n                          \"<code>EC</code>\".\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-47\"><code>namedCurve</code></a>\n                            attribute of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-86\"><code>[[algorithm]]</code></a> internal slot\n                            of <var>key</var> is \"<code>P-256</code>\", \"<code>P-384</code>\"\n                            or \"<code>P-521</code>\":\n                          </dt>\n                          <dd>\n                            \n                          </dd>\n                          <dt>\n                            Otherwise:\n                          </dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<dl class=\"switch\">\n                                  <dt>\n                                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-48\"><code>namedCurve</code></a>\n                                    attribute of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-87\"><code>[[algorithm]]</code></a> internal slot\n                                    of <var>key</var> is \"<code>P-256</code>\":\n                                  </dt>\n                                  <dd>\n                                    Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-crv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-crv-7\"><code>crv</code></a> attribute of <var>jwk</var> to\n                                    \"<code>P-256</code>\"\n                                  </dd>\n                                  <dt>\n                                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-49\"><code>namedCurve</code></a>\n                                    attribute of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-88\"><code>[[algorithm]]</code></a> internal slot\n                                    of <var>key</var> is \"<code>P-384</code>\":\n                                  </dt>\n                                  <dd>\n                                    Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-crv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-crv-8\"><code>crv</code></a> attribute of <var>jwk</var> to\n                                    \"<code>P-384</code>\"\n                                  </dd>\n                                  <dt>\n                                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-50\"><code>namedCurve</code></a>\n                                    attribute of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-89\"><code>[[algorithm]]</code></a> internal slot\n                                    of <var>key</var> is \"<code>P-521</code>\":\n                                  </dt>\n                                  <dd>\n                                    Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-crv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-crv-9\"><code>crv</code></a> attribute of <var>jwk</var> to\n                                    \"<code>P-521</code>\"\n                                  </dd>\n                                </dl>",
                                  "rationale": ".switch",
                                  "steps": [
                                    {
                                      "operation": "switch",
                                      "steps": [
                                        {
                                          "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\":",
                                          "html": "Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-crv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-crv-7\"><code>crv</code></a> attribute of <var>jwk</var> to\n                                    \"<code>P-256</code>\""
                                        },
                                        {
                                          "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-384\":",
                                          "html": "Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-crv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-crv-8\"><code>crv</code></a> attribute of <var>jwk</var> to\n                                    \"<code>P-384</code>\""
                                        },
                                        {
                                          "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-521\":",
                                          "html": "Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-crv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-crv-9\"><code>crv</code></a> attribute of <var>jwk</var> to\n                                    \"<code>P-521</code>\""
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "html": "<p>\n                                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-x\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-x-2\"><code>x</code></a> attribute of <var>jwk</var> according to the\n                                  definition in Section 6.2.1.2 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-y\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-y-2\"><code>y</code></a> attribute of <var>jwk</var> according to the\n                                  definition in Section 6.2.1.3 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                                </p>"
                                },
                                {
                                  "html": "<dl class=\"switch\">\n                                  <dt>\n                                    If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-65\"><code>[[type]]</code></a> internal slot\n                                    of <var>key</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-35\"><code>private</code></a>\"\n                                  </dt>\n                                  <dd>\n                                    <p>\n                                      Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-20\"><code>d</code></a> attribute of <var>jwk</var> according to the\n                                      definition in Section 6.2.2.1 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                                    </p>\n                                  </dd>\n                                </dl>",
                                  "rationale": ".switch",
                                  "steps": [
                                    {
                                      "operation": "switch",
                                      "steps": [
                                        {
                                          "case": "If the [[type]] internal slot of key is \"private\"",
                                          "html": "<p>\n                                      Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-20\"><code>d</code></a> attribute of <var>jwk</var> according to the\n                                      definition in Section 6.2.2.1 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                                    </p>"
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"ECDH key export steps\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdh-extended-export-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdh-extended-export-steps-4\">key export steps</a>\n                                  defined by <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-44\">other applicable\n                                  specifications</a>, passing <var>format</var> and the\n                                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-51\"><code>namedCurve</code></a> attribute of\n                                  the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-90\"><code>[[algorithm]]</code></a>\n                                  internal slot of <var>key</var>\n                                  and obtaining <var>namedCurve</var> and a new value of <var>jwk</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-crv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-crv-10\"><code>crv</code></a> attribute of <var>jwk</var> to\n                                  <var>namedCurve</var>.\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Set the <code>key_ops</code> attribute of <var>jwk</var> to the\n                          <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-cryptokey-usages\" class=\"internalDFN\" id=\"ref-for-dom-cryptokey-usages-5\"><code>usages</code></a> attribute of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>ext</code> attribute of <var>jwk</var> to the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-24\"><code>[[extractable]]</code></a> internal slot\n                          of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>jwk</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-66\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-52\"><code>namedCurve</code></a>\n                            attribute of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-91\"><code>[[algorithm]]</code></a> internal slot\n                            of <var>key</var> is \"<code>P-256</code>\", \"<code>P-384</code>\"\n                            or \"<code>P-521</code>\":\n                          </dt>\n                          <dd>\n                            <p>\n                              Let <var>data</var> be the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> that\n                              represents the Elliptic Curve public key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-32\"><code>[[handle]]</code></a> internal slot of\n                              <var>key</var> according to the encoding rules specified in\n                              Section 2.3.3 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-sec1\" title=\"SEC 1: Elliptic Curve Cryptography\">SEC1</a></cite>] and using the\n                              uncompressed form.\n                            </p>\n                          </dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            <p>\n                              Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"ECDH key export steps\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdh-extended-export-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdh-extended-export-steps-5\">key export steps</a>\n                              defined by <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-45\">other applicable\n                              specifications</a>, passing <var>format</var> and the\n                              <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-53\"><code>namedCurve</code></a> attribute of\n                              the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-92\"><code>[[algorithm]]</code></a>\n                              internal slot of <var>key</var>\n                              and obtaining <var>namedCurve</var> and <var>data</var>.\n                            </p>\n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the namedCurve attribute of the [[algorithm]] internal slot of key is \"P-256\", \"P-384\" or \"P-521\":",
                              "html": "<p>\n                              Let <var>data</var> be the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> that\n                              represents the Elliptic Curve public key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-32\"><code>[[handle]]</code></a> internal slot of\n                              <var>key</var> according to the encoding rules specified in\n                              Section 2.3.3 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-sec1\" title=\"SEC 1: Elliptic Curve Cryptography\">SEC1</a></cite>] and using the\n                              uncompressed form.\n                            </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p>\n                              Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"ECDH key export steps\" href=\"https://w3c.github.io/webcrypto/#dfn-ecdh-extended-export-steps\" class=\"internalDFN\" id=\"ref-for-dfn-ecdh-extended-export-steps-5\">key export steps</a>\n                              defined by <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-45\">other applicable\n                              specifications</a>, passing <var>format</var> and the\n                              <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcKeyAlgorithm-namedCurve\" class=\"internalDFN\" id=\"ref-for-dfn-EcKeyAlgorithm-namedCurve-53\"><code>namedCurve</code></a> attribute of\n                              the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-92\"><code>[[algorithm]]</code></a>\n                              internal slot of <var>key</var>\n                              and obtaining <var>namedCurve</var> and <var>data</var>.\n                            </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>data</var>.\n                        </p>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-67\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> is not \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-36\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of performing the Ed25519\n                  signing process, as specified in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8032\" title=\"Edwards-Curve Digital Signature Algorithm (EdDSA)\">RFC8032</a></cite>],\n                  Section 5.1.6, with <var>message</var> as <var>M</var>,\n                  using the Ed25519 private key associated with <var>key</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-68\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> is not \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-public\" class=\"internalDFN\" id=\"ref-for-dom-keytype-public-2\"><code>public</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the key data of <var>key</var> represents an invalid point or a small-order element\n                  on the Elliptic Curve of Ed25519, return <code>false</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the point R, encoded in the first half of <var>signature</var>,\n                  represents an invalid point or a small-order element\n                  on the Elliptic Curve of Ed25519, return <code>false</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  Perform the Ed25519 verification steps, as specified in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8032\" title=\"Edwards-Curve Digital Signature Algorithm (EdDSA)\">RFC8032</a></cite>],\n                  Section 5.1.7, using the cofactorless (unbatched) equation,\n                  <code>[S]B = R + [k]A'</code>, on the <var>signature</var>, with <var>message</var> as <var>M</var>,\n                  using the Ed25519 public key associated with <var>key</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be a boolean with the value <code>true</code> if the signature is valid\n                  and the value <code>false</code> otherwise.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>usages</var> contains a value which is not\n                  one of \"<code>sign</code>\" or \"<code>verify</code>\",\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Generate an Ed25519 key pair, as defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8032\" title=\"Edwards-Curve Digital Signature Algorithm (EdDSA)\">RFC8032</a></cite>], section 5.1.5.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new <a data-link-type=\"idl\" data-lt=\"KeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-KeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-KeyAlgorithm-7\"><code>KeyAlgorithm</code></a> object.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-31\"><code>name</code></a> attribute of\n                  <var>algorithm</var> to \"<code>Ed25519</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>publicKey</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-84\"><code>CryptoKey</code></a>\n                  representing the public key of the generated key pair.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-69\"><code>[[type]]</code></a> internal slot of\n                  <var>publicKey</var> to \"<code>public</code>\"\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-93\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>publicKey</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-25\"><code>[[extractable]]</code></a> internal\n                  slot of <var>publicKey</var> to true.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-27\"><code>[[usages]]</code></a> internal slot of\n                  <var>publicKey</var> to be the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-usage-intersection\" class=\"internalDFN\" id=\"ref-for-concept-usage-intersection-11\">usage intersection</a>\n                  of <var>usages</var> and <code>[ \"verify\" ]</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>privateKey</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-85\"><code>CryptoKey</code></a>\n                  representing the private key of the generated key pair.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-70\"><code>[[type]]</code></a> internal slot of\n                  <var>privateKey</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-37\"><code>private</code></a>\"\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-94\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>privateKey</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-26\"><code>[[extractable]]</code></a> internal\n                  slot of <var>privateKey</var> to <var>extractable</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-28\"><code>[[usages]]</code></a> internal slot of\n                  <var>privateKey</var> to be the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-usage-intersection\" class=\"internalDFN\" id=\"ref-for-concept-usage-intersection-12\">usage intersection</a>\n                  of <var>usages</var> and <code>[ \"sign\" ]</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKeyPair\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-15\"><code>CryptoKeyPair</code></a>\n                  dictionary.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair-publicKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-publicKey-7\"><code>publicKey</code></a> attribute\n                  of <var>result</var> to be <var>publicKey</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair-privateKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-privateKey-8\"><code>privateKey</code></a> attribute\n                  of <var>result</var> to be <var>privateKey</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-17\"><code>spki</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-17\"><code>pkcs8</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-17\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-14\"><code>raw</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If <var>usages</var> contains a value which is not\n                          \"<code>verify</code>\"\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>spki</var> be the result of running the\n                          <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-a-spki\" class=\"internalDFN\" id=\"ref-for-concept-parse-a-spki-6\">parse a subjectPublicKeyInfo</a>\n                          algorithm over <var>keyData</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurred while parsing,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>algorithm</code> object identifier field of the\n                          <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is\n                          not equal to the <code>id-Ed25519</code>\n                          object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>parameters</code> field of the <code>algorithm</code>\n                          AlgorithmIdentifier field of <var>spki</var> is present,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>publicKey</var> be the Ed25519 public key identified by\n                          the <code>subjectPublicKey</code> field of <var>spki</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-86\"><code>CryptoKey</code></a>\n                          that represents <var>publicKey</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-71\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> to \"<code>public</code>\"\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>algorithm</var> be a new <a data-link-type=\"idl\" data-lt=\"KeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-KeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-KeyAlgorithm-8\"><code>KeyAlgorithm</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-32\"><code>name</code></a> attribute of\n                          <var>algorithm</var> to \"<code>Ed25519</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-95\"><code>[[algorithm]]</code></a>\n                          internal slot of <var>key</var> to <var>algorithm</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If <var>usages</var> contains a value which is not\n                          \"<code>sign</code>\"\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>privateKeyInfo</var> be the result of running the\n                          <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-a-privateKeyInfo\" class=\"internalDFN\" id=\"ref-for-concept-parse-a-privateKeyInfo-6\">parse a privateKeyInfo</a>\n                          algorithm over <var>keyData</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurs while parsing,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>algorithm</code> object identifier field of the\n                          <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of\n                          <var>privateKeyInfo</var> is not equal to the\n                          <code>id-Ed25519</code> object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>parameters</code> field of the\n                          <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                          of <var>privateKeyInfo</var> is present,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>curvePrivateKey</var> be the result of performing the\n                          <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-an-asn1-structure\" class=\"internalDFN\" id=\"ref-for-concept-parse-an-asn1-structure-11\">parse an ASN.1 structure</a>\n                          algorithm, with <var>data</var> as the <code>privateKey</code> field\n                          of <var>privateKeyInfo</var>, <var>structure</var> as the ASN.1\n                          <code>CurvePrivateKey</code> structure specified in Section 7 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>], and <var>exactData</var> set to true.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurred while parsing,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-87\"><code>CryptoKey</code></a>\n                          that represents the Ed25519 private key identified by <var>curvePrivateKey</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-72\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-38\"><code>private</code></a>\"\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>algorithm</var> be a new <a data-link-type=\"idl\" data-lt=\"KeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-KeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-KeyAlgorithm-9\"><code>KeyAlgorithm</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-33\"><code>name</code></a> attribute of\n                          <var>algorithm</var> to \"<code>Ed25519</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-96\"><code>[[algorithm]]</code></a>\n                          internal slot of <var>key</var> to <var>algorithm</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If <var>keyData</var> is a <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-18\"><code>JsonWebKey</code></a> dictionary:</dt>\n                          <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                          <dt>Otherwise:</dt>\n                          <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-21\"><code>d</code></a> field is present and <var>usages</var> contains\n                          a value which is not\n                          \"<code>sign</code>\", or,\n                          if the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-22\"><code>d</code></a> field is not present and <var>usages</var> contains\n                          a value which is not\n                          \"<code>verify</code>\"\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-kty\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-kty-7\"><code>kty</code></a> field of <var>jwk</var> is not\n                          \"<code>OKP</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-crv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-crv-11\"><code>crv</code></a> field of <var>jwk</var> is not\n                          \"<code>Ed25519</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-15\"><code>alg</code></a> field of <var>jwk</var> is present and is\n                          not \"<code>Ed25519</code>\" or \"<code>EdDSA</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>usages</var> is non-empty and the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-use\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-use-6\"><code>use</code></a> field of <var>jwk</var> is present and is\n                          not \"<code>sig</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-key_ops\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-key_ops-6\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                          is invalid according to the requirements of JSON Web\n                          Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>], or it does not contain all of the specified <var>usages</var>\n                          values,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-ext\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-ext-8\"><code>ext</code></a> field of <var>jwk</var> is present and\n                          has the value false and <var>extractable</var> is true,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-23\"><code>d</code></a> field is present:</dt>\n                          <dd>\n                            \n                          </dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the d field is present:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                  If <var>jwk</var> does not meet the requirements of\n                                  the JWK private key format described in Section 2\n                                  of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>], then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-88\"><code>CryptoKey</code></a> object that represents the\n                                  Ed25519 private key identified by interpreting\n                                  <var>jwk</var> according to Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-73\"><code>[[type]]</code></a>\n                                  internal slot of <var>Key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-39\"><code>private</code></a>\".\n                                </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                  If <var>jwk</var> does not meet the requirements of\n                                  the JWK public key format described in Section 2\n                                  of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>], then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-89\"><code>CryptoKey</code></a> object that represents the\n                                  Ed25519 public key identified by interpreting\n                                  <var>jwk</var> according to Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-74\"><code>[[type]]</code></a>\n                                  internal slot of <var>Key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-public\" class=\"internalDFN\" id=\"ref-for-dom-keytype-public-3\"><code>public</code></a>\".\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Let <var>algorithm</var> be a new instance of a <a data-link-type=\"idl\" data-lt=\"KeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-KeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-KeyAlgorithm-10\"><code>KeyAlgorithm</code></a> object.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-34\"><code>name</code></a> attribute of\n                          <var>algorithm</var> to \"<code>Ed25519</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-97\"><code>[[algorithm]]</code></a>\n                          internal slot of <var>key</var> to <var>algorithm</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If <var>usages</var> contains a value which is not\n                          \"<code>verify</code>\"\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-2\">length in bits</a> of <var>keyData</var>\n                          is not 256 then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>algorithm</var> be a new <a data-link-type=\"idl\" data-lt=\"KeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-KeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-KeyAlgorithm-11\"><code>KeyAlgorithm</code></a> object.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-35\"><code>name</code></a> attribute of\n                          <var>algorithm</var> to \"<code>Ed25519</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-90\"><code>CryptoKey</code></a>\n                          representing the key data provided in <var>keyData</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-75\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> to \"<code>public</code>\"\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-98\"><code>[[algorithm]]</code></a>\n                          internal slot of <var>key</var> to <var>algorithm</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Return <var>key</var>\n                </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>key</var> be the <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-91\"><code>CryptoKey</code></a> to be\n                  exported.\n                </p>"
        },
        {
          "html": "<p>\n                  If the underlying cryptographic key material represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-33\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n                  cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-18\"><code>spki</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-18\"><code>pkcs8</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-18\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>\n                    If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-15\"><code>raw</code></a>\":\n                  </dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-76\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>data</var> be an instance of the <code>SubjectPublicKeyInfo</code>\n                          ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5280\" title=\"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile\">RFC5280</a></cite>]\n                          with the following properties:\n                        </p>\n                        <ul>\n                          <li>\n                            <p>\n                              Set the <var>algorithm</var> field to an\n                              <code>AlgorithmIdentifier</code> ASN.1 type with the following\n                              properties:\n                            </p>\n                            <ul>\n                              <li>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the\n                                  <code>id-Ed25519</code> OID defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>].\n                                </p>\n                              </li>\n                            </ul>\n                          </li>\n                          <li>\n                            <p>\n                              Set the <var>subjectPublicKey</var> field to <var>keyData</var>.\n                            </p>\n                          </li>\n                        </ul>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be the result of DER-encoding <var>data</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-77\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> is not \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-40\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>data</var> be an instance of the <code>PrivateKeyInfo</code>\n                          ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5208\" title=\"Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2\">RFC5208</a></cite>]\n                          with the following properties:\n                        </p>\n                        <ul>\n                          <li>\n                            <p>\n                              Set the <var>version</var> field to <code>0</code>.\n                            </p>\n                          </li>\n                          <li>\n                            <p>\n                              Set the <var>privateKeyAlgorithm</var> field to a\n                              <code>PrivateKeyAlgorithmIdentifier</code> ASN.1 type with the\n                              following properties:\n                            </p>\n                            <ul>\n                              <li>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the\n                                  <code>id-Ed25519</code> OID defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>].\n                                </p>\n                              </li>\n                            </ul>\n                          </li>\n                          <li>\n                            <p>\n                              Set the <var>privateKey</var> field to the result of DER-encoding\n                              a <code>CurvePrivateKey</code> ASN.1 type, as defined in Section 7 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>], that represents the\n                              Ed25519 private key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-34\"><code>[[handle]]</code></a> internal slot of\n                              <var>key</var>\n                            </p>\n                          </li>\n                        </ul>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be the result of DER-encoding <var>data</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>jwk</var> be a new <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-19\"><code>JsonWebKey</code></a>\n                          dictionary.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>kty</code> attribute of <var>jwk</var> to\n                          \"<code>OKP</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>alg</code> attribute of <var>jwk</var> to\n                          \"<code>Ed25519</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>crv</code> attribute of <var>jwk</var> to\n                          \"<code>Ed25519</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-x\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-x-3\"><code>x</code></a> attribute of <var>jwk</var> according to the\n                          definition in Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-78\"><code>[[type]]</code></a> internal slot\n                            of <var>key</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-41\"><code>private</code></a>\"\n                          </dt>\n                          <dd>\n                            Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-24\"><code>d</code></a> attribute of <var>jwk</var> according to the\n                            definition in Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the [[type]] internal slot of key is \"private\"",
                              "html": "Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-24\"><code>d</code></a> attribute of <var>jwk</var> according to the\n                            definition in Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>]."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-cryptokey-usages\" class=\"internalDFN\" id=\"ref-for-dom-cryptokey-usages-6\"><code>usages</code></a> attribute of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>ext</code> attribute of <var>jwk</var> to the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-27\"><code>[[extractable]]</code></a> internal slot\n                          of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>jwk</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-79\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>data</var> be a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> representing the Ed25519\n                          public key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-35\"><code>[[handle]]</code></a> internal slot of\n                          <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>data</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-80\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> is not \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-42\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>publicKey</var> be the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-EcdhKeyDeriveParams-public\" class=\"internalDFN\" id=\"ref-for-dfn-EcdhKeyDeriveParams-public-3\"><code>public</code></a> member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-81\"><code>[[type]]</code></a> internal slot of\n                  <var>publicKey</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-36\"><code>name</code></a> attribute of\n                  the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-99\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>publicKey</var> is not equal to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-37\"><code>name</code></a> property of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-100\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var>, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>secret</var> be the result of performing the X25519 function specified in\n                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc7748\" title=\"Elliptic Curves for Security\">RFC7748</a></cite>] Section 5 with <var>key</var> as the X25519 private key <var>k</var>\n                  and the X25519 public key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-36\"><code>[[handle]]</code></a>\n                  internal slot of <var>publicKey</var> as the X25519 public key <var>u</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  If <var>secret</var> is the all-zero value,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                  This check must be performed in constant-time, as per [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc7748\" title=\"Elliptic Curves for Security\">RFC7748</a></cite>] Section 6.1.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>length</var> is null:</dt>\n                  <dd>Return <var>secret</var></dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <dl class=\"switch\">\n                      <dt>\n                        If the length of <var>secret</var> in bits is less than\n                        <var>length</var>:\n                      </dt>\n                      <dd>\n                        <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                        <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                      </dd>\n                      <dt>Otherwise:</dt>\n                      <dd>\n                        Return a <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-byte-sequence-containing\" class=\"internalDFN\" id=\"ref-for-dfn-byte-sequence-containing-2\">byte sequence containing</a> the first <var>length</var> bits of <var>secret</var>.\n                      </dd>\n                    </dl>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If length is null:",
                  "html": "Return <var>secret</var>"
                },
                {
                  "case": "Otherwise:",
                  "html": "<dl class=\"switch\">\n                      <dt>\n                        If the length of <var>secret</var> in bits is less than\n                        <var>length</var>:\n                      </dt>\n                      <dd>\n                        <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                        <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                      </dd>\n                      <dt>Otherwise:</dt>\n                      <dd>\n                        Return a <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-byte-sequence-containing\" class=\"internalDFN\" id=\"ref-for-dfn-byte-sequence-containing-2\">byte sequence containing</a> the first <var>length</var> bits of <var>secret</var>.\n                      </dd>\n                    </dl>",
                  "rationale": ".switch",
                  "steps": [
                    {
                      "operation": "switch",
                      "steps": [
                        {
                          "case": "If the length of secret in bits is less than length:",
                          "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                        <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>."
                        },
                        {
                          "case": "Otherwise:",
                          "html": "Return a <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-byte-sequence-containing\" class=\"internalDFN\" id=\"ref-for-dfn-byte-sequence-containing-2\">byte sequence containing</a> the first <var>length</var> bits of <var>secret</var>."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>usages</var> contains an entry which is not\n                  \"<code>deriveKey</code>\" or \"<code>deriveBits</code>\"\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Generate an X25519 key pair, with the private key being 32 random bytes,\n                  and the public key being <code>X25519(a, 9)</code>,\n                  as defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc7748\" title=\"Elliptic Curves for Security\">RFC7748</a></cite>], section 6.1.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new <a data-link-type=\"idl\" data-lt=\"KeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-KeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-KeyAlgorithm-12\"><code>KeyAlgorithm</code></a> object.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-38\"><code>name</code></a> attribute of\n                  <var>algorithm</var> to \"<code>X25519</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>publicKey</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-93\"><code>CryptoKey</code></a>\n                  representing the public key of the generated key pair.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-82\"><code>[[type]]</code></a> internal slot of\n                  <var>publicKey</var> to \"<code>public</code>\"\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-101\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>publicKey</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-28\"><code>[[extractable]]</code></a> internal\n                  slot of <var>publicKey</var> to true.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-29\"><code>[[usages]]</code></a> internal slot of\n                  <var>publicKey</var> to be the empty list.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>privateKey</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-94\"><code>CryptoKey</code></a>\n                  representing the private key of the generated key pair.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-83\"><code>[[type]]</code></a> internal slot of\n                  <var>privateKey</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-43\"><code>private</code></a>\"\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-102\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>privateKey</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-29\"><code>[[extractable]]</code></a> internal\n                  slot of <var>privateKey</var> to <var>extractable</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-30\"><code>[[usages]]</code></a> internal slot of\n                  <var>privateKey</var> to be the\n                  <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-usage-intersection\" class=\"internalDFN\" id=\"ref-for-concept-usage-intersection-13\">usage intersection</a> of\n                  <var>usages</var> and <code>[ \"deriveKey\", \"deriveBits\" ]</code>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKeyPair\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-17\"><code>CryptoKeyPair</code></a>\n                  dictionary.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair-publicKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-publicKey-8\"><code>publicKey</code></a> attribute\n                  of <var>result</var> to be <var>publicKey</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKeyPair-privateKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKeyPair-privateKey-9\"><code>privateKey</code></a> attribute\n                  of <var>result</var> to be <var>privateKey</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-19\"><code>spki</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-19\"><code>pkcs8</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-19\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-16\"><code>raw</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If <var>usages</var> is not empty\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>spki</var> be the result of running the\n                          <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-a-spki\" class=\"internalDFN\" id=\"ref-for-concept-parse-a-spki-7\">parse a subjectPublicKeyInfo</a>\n                          algorithm over <var>keyData</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurred while parsing,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>algorithm</code> object identifier field of the\n                          <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is\n                          not equal to the <code>id-X25519</code>\n                          object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>parameters</code> field of the <code>algorithm</code>\n                          AlgorithmIdentifier field of <var>spki</var> is present,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>publicKey</var> be the X25519 public key identified by\n                          the <code>subjectPublicKey</code> field of <var>spki</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-95\"><code>CryptoKey</code></a>\n                          that represents <var>publicKey</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-84\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> to \"<code>public</code>\"\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>algorithm</var> be a new <a data-link-type=\"idl\" data-lt=\"KeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-KeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-KeyAlgorithm-13\"><code>KeyAlgorithm</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-39\"><code>name</code></a> attribute of\n                          <var>algorithm</var> to \"<code>X25519</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-103\"><code>[[algorithm]]</code></a>\n                          internal slot of <var>key</var> to <var>algorithm</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If <var>usages</var> contains an entry which is not\n                          \"<code>deriveKey</code>\" or \"<code>deriveBits</code>\"\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>privateKeyInfo</var> be the result of running the\n                          <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-a-privateKeyInfo\" class=\"internalDFN\" id=\"ref-for-concept-parse-a-privateKeyInfo-7\">parse a privateKeyInfo</a>\n                          algorithm over <var>keyData</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurs while parsing,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>algorithm</code> object identifier field of the\n                          <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of\n                          <var>privateKeyInfo</var> is not equal to the\n                          <code>id-X25519</code> object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <code>parameters</code> field of the\n                          <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                          of <var>privateKeyInfo</var> is present,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>curvePrivateKey</var> be the result of performing the\n                          <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#concept-parse-an-asn1-structure\" class=\"internalDFN\" id=\"ref-for-concept-parse-an-asn1-structure-12\">parse an ASN.1 structure</a>\n                          algorithm, with <var>data</var> as the <code>privateKey</code> field\n                          of <var>privateKeyInfo</var>, <var>structure</var> as the ASN.1\n                          <code>CurvePrivateKey</code> structure specified in Section 7 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>], and <var>exactData</var> set to true.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If an error occurred while parsing,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-96\"><code>CryptoKey</code></a>\n                          that represents the X25519 private key identified by <var>curvePrivateKey</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-85\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-44\"><code>private</code></a>\"\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>algorithm</var> be a new <a data-link-type=\"idl\" data-lt=\"KeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-KeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-KeyAlgorithm-14\"><code>KeyAlgorithm</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-40\"><code>name</code></a> attribute of\n                          <var>algorithm</var> to \"<code>X25519</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-104\"><code>[[algorithm]]</code></a>\n                          internal slot of <var>key</var> to <var>algorithm</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If <var>keyData</var> is a <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-20\"><code>JsonWebKey</code></a> dictionary:</dt>\n                          <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                          <dt>Otherwise:</dt>\n                          <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-25\"><code>d</code></a> field is present and if <var>usages</var>\n                          contains an entry which is not\n                          \"<code>deriveKey</code>\" or \"<code>deriveBits</code>\"\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-26\"><code>d</code></a> field is not present and if <var>usages</var> is not\n                          empty\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-kty\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-kty-8\"><code>kty</code></a> field of <var>jwk</var> is not\n                          \"<code>OKP</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-crv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-crv-12\"><code>crv</code></a> field of <var>jwk</var> is not\n                          \"<code>X25519</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>usages</var> is non-empty and the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-use\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-use-7\"><code>use</code></a> field of <var>jwk</var> is present\n                          and is not equal to \"<code>enc</code>\" then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-key_ops\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-key_ops-7\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                          is invalid according to the requirements of JSON Web\n                          Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>], or it does not contain all of the specified <var>usages</var>\n                          values,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-ext\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-ext-9\"><code>ext</code></a> field of <var>jwk</var> is present and\n                          has the value false and <var>extractable</var> is true,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-27\"><code>d</code></a> field is present:</dt>\n                          <dd>\n                            \n                          </dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the d field is present:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                  If <var>jwk</var> does not meet the requirements of\n                                  the JWK private key format described in Section 2\n                                  of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>], then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-97\"><code>CryptoKey</code></a> object that represents the\n                                  X25519 private key identified by interpreting\n                                  <var>jwk</var> according to Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-86\"><code>[[type]]</code></a>\n                                  internal slot of <var>Key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-45\"><code>private</code></a>\".\n                                </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                  If <var>jwk</var> does not meet the requirements of\n                                  the JWK public key format described in Section 2\n                                  of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>], then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-98\"><code>CryptoKey</code></a> object that represents the\n                                  X25519 public key identified by interpreting\n                                  <var>jwk</var> according to Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-87\"><code>[[type]]</code></a>\n                                  internal slot of <var>Key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-public\" class=\"internalDFN\" id=\"ref-for-dom-keytype-public-4\"><code>public</code></a>\".\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Let <var>algorithm</var> be a new instance of a <a data-link-type=\"idl\" data-lt=\"KeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-KeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-KeyAlgorithm-15\"><code>KeyAlgorithm</code></a> object.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-41\"><code>name</code></a> attribute of\n                          <var>algorithm</var> to \"<code>X25519</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-105\"><code>[[algorithm]]</code></a>\n                          internal slot of <var>key</var> to <var>algorithm</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If <var>usages</var> is not empty\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-3\">length in bits</a> of <var>keyData</var>\n                          is not 256 then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>algorithm</var> be a new <a data-link-type=\"idl\" data-lt=\"KeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-KeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-KeyAlgorithm-16\"><code>KeyAlgorithm</code></a> object.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-42\"><code>name</code></a> attribute of\n                          <var>algorithm</var> to \"<code>X25519</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-99\"><code>CryptoKey</code></a>\n                          representing the key data provided in <var>keyData</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-88\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> to \"<code>public</code>\"\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-106\"><code>[[algorithm]]</code></a>\n                          internal slot of <var>key</var> to <var>algorithm</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Return <var>key</var>\n                </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>key</var> be the <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-100\"><code>CryptoKey</code></a> to be\n                  exported.\n                </p>"
        },
        {
          "html": "<p>\n                  If the underlying cryptographic key material represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-37\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n                  cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-20\"><code>spki</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-20\"><code>pkcs8</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-20\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>\n                    If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-17\"><code>raw</code></a>\":\n                  </dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-89\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>data</var> be an instance of the <code>SubjectPublicKeyInfo</code>\n                          ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5280\" title=\"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile\">RFC5280</a></cite>]\n                          with the following properties:\n                        </p>\n                        <ul>\n                          <li>\n                            <p>\n                              Set the <var>algorithm</var> field to an\n                              <code>AlgorithmIdentifier</code> ASN.1 type with the following\n                              properties:\n                            </p>\n                            <ul>\n                              <li>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the\n                                  <code>id-X25519</code> OID defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>].\n                                </p>\n                              </li>\n                            </ul>\n                          </li>\n                          <li>\n                            <p>\n                              Set the <var>subjectPublicKey</var> field to <var>keyData</var>.\n                            </p>\n                          </li>\n                        </ul>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be the result of DER-encoding <var>data</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-90\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> is not \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-46\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>data</var> be an instance of the <code>PrivateKeyInfo</code>\n                          ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5208\" title=\"Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2\">RFC5208</a></cite>]\n                          with the following properties:\n                        </p>\n                        <ul>\n                          <li>\n                            <p>\n                              Set the <var>version</var> field to <code>0</code>.\n                            </p>\n                          </li>\n                          <li>\n                            <p>\n                              Set the <var>privateKeyAlgorithm</var> field to a\n                              <code>PrivateKeyAlgorithmIdentifier</code> ASN.1 type with the\n                              following properties:\n                            </p>\n                            <ul>\n                              <li>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the\n                                  <code>id-X25519</code> OID defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>].\n                                </p>\n                              </li>\n                            </ul>\n                          </li>\n                          <li>\n                            <p>\n                              Set the <var>privateKey</var> field to the result of DER-encoding\n                              a <code>CurvePrivateKey</code> ASN.1 type, as defined in Section 7 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>], that represents the\n                              X25519 private key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-38\"><code>[[handle]]</code></a> internal slot of\n                              <var>key</var>\n                            </p>\n                          </li>\n                        </ul>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be the result of DER-encoding <var>data</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>jwk</var> be a new <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-21\"><code>JsonWebKey</code></a>\n                          dictionary.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>kty</code> attribute of <var>jwk</var> to\n                          \"<code>OKP</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>crv</code> attribute of <var>jwk</var> to\n                          \"<code>X25519</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-x\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-x-4\"><code>x</code></a> attribute of <var>jwk</var> according to the\n                          definition in Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-91\"><code>[[type]]</code></a> internal slot\n                            of <var>key</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-private\" class=\"internalDFN\" id=\"ref-for-dom-keytype-private-47\"><code>private</code></a>\"\n                          </dt>\n                          <dd>\n                            Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-28\"><code>d</code></a> attribute of <var>jwk</var> according to the\n                            definition in Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the [[type]] internal slot of key is \"private\"",
                              "html": "Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-d\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-d-28\"><code>d</code></a> attribute of <var>jwk</var> according to the\n                            definition in Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>]."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-cryptokey-usages\" class=\"internalDFN\" id=\"ref-for-dom-cryptokey-usages-7\"><code>usages</code></a> attribute of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>ext</code> attribute of <var>jwk</var> to the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-30\"><code>[[extractable]]</code></a> internal slot\n                          of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>jwk</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-92\"><code>[[type]]</code></a> internal slot\n                          of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>data</var> be a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> representing the X25519\n                          public key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-39\"><code>[[handle]]</code></a> internal slot of\n                          <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>data</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesCtrParams-counter\" class=\"internalDFN\" id=\"ref-for-dfn-AesCtrParams-counter-3\"><code>counter</code></a> member of\n                  <var>normalizedAlgorithm</var> does not have\n                  a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence-length\">length</a> of 16 bytes,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesCtrParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesCtrParams-length-2\"><code>length</code></a> member of\n                  <var>normalizedAlgorithm</var> is zero or is greater\n                  than 128,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>ciphertext</var> be the result of performing the CTR Encryption\n                  operation described in Section 6.5 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-nist-sp800-38a\" title=\"NIST Special Publication 800-38A: Recommendation for Block Cipher Modes of Operation, Methods and Techniques\">NIST-SP800-38A</a></cite>] using AES as the block cipher, the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesCtrParams-counter\" class=\"internalDFN\" id=\"ref-for-dfn-AesCtrParams-counter-4\"><code>counter</code></a> member of\n                  <var>normalizedAlgorithm</var> as the initial value of the counter block, the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesCtrParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesCtrParams-length-3\"><code>length</code></a> member of\n                  <var>normalizedAlgorithm</var> as the input parameter <var>m</var> to the\n                  standard counter block incrementing function defined in Appendix B.1 of\n                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-nist-sp800-38a\" title=\"NIST Special Publication 800-38A: Recommendation for Block Cipher Modes of Operation, Methods and Techniques\">NIST-SP800-38A</a></cite>] and\n                  <var>plaintext</var> as the input plaintext.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>ciphertext</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesCtrParams-counter\" class=\"internalDFN\" id=\"ref-for-dfn-AesCtrParams-counter-5\"><code>counter</code></a> member of\n                  <var>normalizedAlgorithm</var> does not have\n                  a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence-length\">length</a> of 16 bytes,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesCtrParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesCtrParams-length-4\"><code>length</code></a> member of\n                  <var>normalizedAlgorithm</var> is zero or is greater\n                  than 128,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>plaintext</var> be the result of performing the CTR Decryption\n                  operation described in Section 6.5 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-nist-sp800-38a\" title=\"NIST Special Publication 800-38A: Recommendation for Block Cipher Modes of Operation, Methods and Techniques\">NIST-SP800-38A</a></cite>] using AES as the block cipher, the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesCtrParams-counter\" class=\"internalDFN\" id=\"ref-for-dfn-AesCtrParams-counter-6\"><code>counter</code></a> member of\n                  <var>normalizedAlgorithm</var> as the initial value of the counter block, the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesCtrParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesCtrParams-length-5\"><code>length</code></a> member of\n                  <var>normalizedAlgorithm</var> as the input parameter <var>m</var> to the\n                  standard counter block incrementing function defined in Appendix B.1 of\n                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-nist-sp800-38a\" title=\"NIST Special Publication 800-38A: Recommendation for Block Cipher Modes of Operation, Methods and Techniques\">NIST-SP800-38A</a></cite>] and\n                  <var>ciphertext</var> as the input ciphertext.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>plaintext</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>usages</var> contains any entry which is not\n                  one of \"<code>encrypt</code>\", \"<code>decrypt</code>\",\n                  \"<code>wrapKey</code>\" or \"<code>unwrapKey</code>\",\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyGenParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyGenParams-length-2\"><code>length</code></a> member of\n                  <var>normalizedAlgorithm</var> is not equal to one of\n                  128, 192 or 256,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Generate an AES key of length\n                  equal to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyGenParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyGenParams-length-3\"><code>length</code></a> member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the key generation step fails,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>key</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-103\"><code>CryptoKey</code></a> object representing the\n                  generated AES key.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"AesKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-2\"><code>AesKeyAlgorithm</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-43\"><code>name</code></a> attribute of\n                  <var>algorithm</var> to \"<code>AES-CTR</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-length-2\"><code>length</code></a> attribute of\n                  <var>algorithm</var> to equal the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyGenParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyGenParams-length-4\"><code>length</code></a> member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-93\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-secret\" class=\"internalDFN\" id=\"ref-for-dom-keytype-secret-6\"><code>secret</code></a>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-107\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>key</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-31\"><code>[[extractable]]</code></a> internal\n                  slot of <var>key</var> to be <var>extractable</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-31\"><code>[[usages]]</code></a> internal slot of\n                  <var>key</var> to be <var>usages</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>key</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>usages</var> contains an entry which is not\n                  one of \"<code>encrypt</code>\", \"<code>decrypt</code>\",\n                  \"<code>wrapKey</code>\" or \"<code>unwrapKey</code>\",\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-18\"><code>raw</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-21\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>data</var> be <var>keyData</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-4\">length in bits</a> of <var>data</var> is not 128, 192 or 256\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If <var>keyData</var> is a <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-22\"><code>JsonWebKey</code></a> dictionary:</dt>\n                          <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                          <dt>Otherwise:</dt>\n                          <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-kty\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-kty-9\"><code>kty</code></a> field of <var>jwk</var> is not\n                            \"<code>oct</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>jwk</var> does not meet the requirements of\n                          Section 6.4 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>data</var> be the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> obtained by decoding the\n                          <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-k\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-k-1\"><code>k</code></a> field of <var>jwk</var>.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-5\">length in bits</a> of <var>data</var> is 128:</dt>\n                          <dd>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-16\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                            not \"<code>A128CTR</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                          </dd>\n                          <dt>If the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-6\">length in bits</a> of <var>data</var> is 192:</dt>\n                          <dd>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-17\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                            not \"<code>A192CTR</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                          </dd>\n                          <dt>If the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-7\">length in bits</a> of <var>data</var> is 256:</dt>\n                          <dd>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-18\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                            not \"<code>A256CTR</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                          </dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the length in bits of data is 128:",
                              "html": "If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-16\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                            not \"<code>A128CTR</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If the length in bits of data is 192:",
                              "html": "If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-17\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                            not \"<code>A192CTR</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If the length in bits of data is 256:",
                              "html": "If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-18\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                            not \"<code>A256CTR</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If <var>usages</var> is non-empty and the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-use\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-use-8\"><code>use</code></a> field of <var>jwk</var> is present and is\n                          not \"<code>enc</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-key_ops\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-key_ops-8\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                          is invalid according to the requirements of\n                          JSON Web Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>] or\n                          does not contain all of the specified <var>usages</var> values,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-ext\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-ext-10\"><code>ext</code></a> field of <var>jwk</var> is present and\n                          has the value false and <var>extractable</var> is true,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-104\"><code>CryptoKey</code></a> object representing an AES key with\n                  value <var>data</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-94\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-secret\" class=\"internalDFN\" id=\"ref-for-dom-keytype-secret-7\"><code>secret</code></a>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"AesKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-3\"><code>AesKeyAlgorithm</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-44\"><code>name</code></a> attribute of\n                  <var>algorithm</var> to \"<code>AES-CTR</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-length-3\"><code>length</code></a> attribute of\n                  <var>algorithm</var> to the length, in bits, of <var>data</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-108\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>key</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>key</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the underlying cryptographic key material represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-40\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n                  cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-19\"><code>raw</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-22\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>data</var> be a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> containing\n                          the raw octets of the key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-41\"><code>[[handle]]</code></a> internal slot of\n                          <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>data</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>jwk</var> be a new <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-23\"><code>JsonWebKey</code></a>\n                          dictionary.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>kty</code> attribute of <var>jwk</var> to the\n                          string \"<code>oct</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-k\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-k-2\"><code>k</code></a> attribute of <var>jwk</var> to be a string\n                          containing the raw octets of the key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-42\"><code>[[handle]]</code></a> internal slot of\n                          <var>key</var>, encoded according to Section 6.4 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-length-4\"><code>length</code></a> attribute of\n                          <var>key</var> is 128:</dt>\n                          <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A128CTR</code>\".</dd>\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-length-5\"><code>length</code></a> attribute of\n                          <var>key</var> is 192:</dt>\n                          <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A192CTR</code>\".</dd>\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-length-6\"><code>length</code></a> attribute of\n                          <var>key</var> is 256:</dt>\n                          <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A256CTR</code>\".</dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the length attribute of key is 128:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A128CTR</code>\"."
                            },
                            {
                              "case": "If the length attribute of key is 192:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A192CTR</code>\"."
                            },
                            {
                              "case": "If the length attribute of key is 256:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A256CTR</code>\"."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Set the <code>key_ops</code> attribute of <var>jwk</var> to equal the\n                          <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-32\"><code>[[usages]]</code></a> internal slot of\n                          <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>ext</code> attribute of <var>jwk</var> to equal the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-32\"><code>[[extractable]]</code></a> internal slot\n                          of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>jwk</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesDerivedKeyParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesDerivedKeyParams-length-2\"><code>length</code></a> member of\n                  <var>normalizedDerivedKeyAlgorithm</var> is not 128, 192 or 256,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesDerivedKeyParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesDerivedKeyParams-length-3\"><code>length</code></a> member of\n                  <var>normalizedDerivedKeyAlgorithm</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesCbcParams-iv\" class=\"internalDFN\" id=\"ref-for-dfn-AesCbcParams-iv-2\"><code>iv</code></a> member of\n                  <var>normalizedAlgorithm</var> does not have\n                  a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence-length\">length</a> of 16 bytes,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>paddedPlaintext</var> be the result of adding padding octets to\n                  <var>plaintext</var>\n                  according to the procedure defined in Section 10.3\n                  of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc2315\" title=\"PKCS #7: Cryptographic Message Syntax Version 1.5\">RFC2315</a></cite>], step 2, with a value of\n                  <var>k</var> of 16.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>ciphertext</var> be the result of performing the CBC Encryption\n                  operation described in Section 6.2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-nist-sp800-38a\" title=\"NIST Special Publication 800-38A: Recommendation for Block Cipher Modes of Operation, Methods and Techniques\">NIST-SP800-38A</a></cite>] using AES as the block cipher, the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesCbcParams-iv\" class=\"internalDFN\" id=\"ref-for-dfn-AesCbcParams-iv-3\"><code>iv</code></a> member of <var>normalizedAlgorithm</var> as\n                  the <var>IV</var> input parameter and <var>paddedPlaintext</var>\n                  as the input plaintext.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>ciphertext</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesCbcParams-iv\" class=\"internalDFN\" id=\"ref-for-dfn-AesCbcParams-iv-4\"><code>iv</code></a> member of\n                  <var>normalizedAlgorithm</var> does not have\n                  a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence-length\">length</a> of 16 bytes,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the length of <var>ciphertext</var> is zero or is not a multiple\n                  of 16 bytes, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>paddedPlaintext</var> be the result of performing the CBC Decryption\n                  operation described in Section 6.2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-nist-sp800-38a\" title=\"NIST Special Publication 800-38A: Recommendation for Block Cipher Modes of Operation, Methods and Techniques\">NIST-SP800-38A</a></cite>] using AES as the block cipher, the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesCbcParams-iv\" class=\"internalDFN\" id=\"ref-for-dfn-AesCbcParams-iv-5\"><code>iv</code></a> member of <var>normalizedAlgorithm</var> as\n                  the <var>IV</var> input parameter and\n                  <var>ciphertext</var> as the input ciphertext.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>p</var> be the value of the last octet of <var>paddedPlaintext</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  If <var>p</var> is zero or greater than 16, or if any of the last <var>p</var>\n                  octets of <var>paddedPlaintext</var> have a value which is not <var>p</var>,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>plaintext</var> be the result of removing <var>p</var> octets from\n                  the end of <var>paddedPlaintext</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>plaintext</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>usages</var> contains any entry which is not\n                   one of \"<code>encrypt</code>\", \"<code>decrypt</code>\",\n                  \"<code>wrapKey</code>\" or \"<code>unwrapKey</code>\",\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyGenParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyGenParams-length-5\"><code>length</code></a> member of\n                  <var>normalizedAlgorithm</var> is not equal to one of\n                  128, 192 or 256,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Generate an AES key of length\n                  equal to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyGenParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyGenParams-length-6\"><code>length</code></a> member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the key generation step fails,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>key</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-107\"><code>CryptoKey</code></a> object representing the\n                  generated AES key.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"AesKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-4\"><code>AesKeyAlgorithm</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-45\"><code>name</code></a> attribute of\n                  <var>algorithm</var> to \"<code>AES-CBC</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-length-7\"><code>length</code></a> attribute of\n                  <var>algorithm</var> to equal the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyGenParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyGenParams-length-7\"><code>length</code></a> member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-95\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-secret\" class=\"internalDFN\" id=\"ref-for-dom-keytype-secret-8\"><code>secret</code></a>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-109\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>key</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-33\"><code>[[extractable]]</code></a> internal\n                  slot of <var>key</var> to be <var>extractable</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-33\"><code>[[usages]]</code></a> internal slot of\n                  <var>key</var> to be <var>usages</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>key</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>usages</var> contains an entry which is not\n                  one of \"<code>encrypt</code>\", \"<code>decrypt</code>\",\n                  \"<code>wrapKey</code>\" or \"<code>unwrapKey</code>\",\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-20\"><code>raw</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-23\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>data</var> be <var>keyData</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-8\">length in bits</a> of <var>data</var> is not 128, 192 or 256\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If <var>keyData</var> is a <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-24\"><code>JsonWebKey</code></a> dictionary:</dt>\n                          <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                          <dt>Otherwise:</dt>\n                          <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-kty\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-kty-10\"><code>kty</code></a> field of <var>jwk</var> is not\n                          \"<code>oct</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>jwk</var> does not meet the requirements of\n                          Section 6.4 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>data</var> be the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> obtained by decoding the\n                          <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-k\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-k-3\"><code>k</code></a> field of <var>jwk</var>.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-9\">length in bits</a> of <var>data</var> is 128:</dt>\n                          <dd>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-19\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                          not  \"<code>A128CBC</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</dd>\n                          <dt>If the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-10\">length in bits</a> of <var>data</var> is 192:</dt>\n                          <dd>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-20\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                          not  \"<code>A192CBC</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</dd>\n                          <dt>If the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-11\">length in bits</a> of <var>data</var> is 256:</dt>\n                          <dd>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-21\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                          not  \"<code>A256CBC</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the length in bits of data is 128:",
                              "html": "If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-19\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                          not  \"<code>A128CBC</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If the length in bits of data is 192:",
                              "html": "If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-20\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                          not  \"<code>A192CBC</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If the length in bits of data is 256:",
                              "html": "If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-21\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                          not  \"<code>A256CBC</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If <var>usages</var> is non-empty and the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-use\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-use-9\"><code>use</code></a> field of <var>jwk</var> is present and is\n                          not  \"<code>enc</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-key_ops\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-key_ops-9\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                          is invalid according to the requirements of\n                          JSON Web Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>] or\n                          does not contain all of the specified <var>usages</var> values,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-ext\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-ext-11\"><code>ext</code></a> field of <var>jwk</var> is present and\n                          has the value false and <var>extractable</var> is true,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-108\"><code>CryptoKey</code></a>\n                  object representing an AES key with value <var>data</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-96\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-secret\" class=\"internalDFN\" id=\"ref-for-dom-keytype-secret-9\"><code>secret</code></a>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"AesKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-5\"><code>AesKeyAlgorithm</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-46\"><code>name</code></a> attribute of\n                  <var>algorithm</var> to \"<code>AES-CBC</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-length-8\"><code>length</code></a> attribute of\n                  <var>algorithm</var> to the length, in bits, of <var>data</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-110\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>key</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>key</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the underlying cryptographic key material represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-43\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n                  cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-21\"><code>raw</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-24\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>data</var> be a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> containing\n                          the raw octets of the key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-44\"><code>[[handle]]</code></a> internal slot of\n                          <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>data</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>Let <var>jwk</var> be a new <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-25\"><code>JsonWebKey</code></a> dictionary.</p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>kty</code> attribute of <var>jwk</var> to the\n                          string \"<code>oct</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-k\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-k-4\"><code>k</code></a> attribute of <var>jwk</var> to be a string\n                          containing the raw octets of the key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-45\"><code>[[handle]]</code></a> internal slot of\n                          <var>key</var>, encoded according to Section 6.4 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-length-9\"><code>length</code></a> attribute of\n                          <var>key</var> is 128:</dt>\n                          <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A128CBC</code>\".</dd>\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-length-10\"><code>length</code></a> attribute of\n                          <var>key</var> is 192:</dt>\n                          <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A192CBC</code>\".</dd>\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-length-11\"><code>length</code></a> attribute of\n                          <var>key</var> is 256:</dt>\n                          <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A256CBC</code>\".</dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the length attribute of key is 128:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A128CBC</code>\"."
                            },
                            {
                              "case": "If the length attribute of key is 192:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A192CBC</code>\"."
                            },
                            {
                              "case": "If the length attribute of key is 256:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A256CBC</code>\"."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Set the <code>key_ops</code> attribute of <var>jwk</var> to equal the\n                          <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-cryptokey-usages\" class=\"internalDFN\" id=\"ref-for-dom-cryptokey-usages-8\"><code>usages</code></a> attribute of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>ext</code> attribute of <var>jwk</var> to equal the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-34\"><code>[[extractable]]</code></a> internal slot\n                          of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>jwk</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesDerivedKeyParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesDerivedKeyParams-length-4\"><code>length</code></a> member of\n                  <var>normalizedDerivedKeyAlgorithm</var> is not 128, 192 or 256,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesDerivedKeyParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesDerivedKeyParams-length-5\"><code>length</code></a> member of\n                  <var>normalizedDerivedKeyAlgorithm</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>plaintext</var> has a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence-length\">length</a>\n                  greater than 2^39 - 256 bytes,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesGcmParams-iv\" class=\"internalDFN\" id=\"ref-for-dfn-AesGcmParams-iv-2\"><code>iv</code></a> member of\n                  <var>normalizedAlgorithm</var> has a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence-length\">length</a>\n                  greater than 2^64 - 1 bytes,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesGcmParams-additionalData\" class=\"internalDFN\" id=\"ref-for-dfn-AesGcmParams-additionalData-2\"><code>additionalData</code></a> member\n                  of <var>normalizedAlgorithm</var> is present and has a\n                  <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence-length\">length</a>\n                  greater than 2^64 - 1 bytes,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesGcmParams-tagLength\" class=\"internalDFN\" id=\"ref-for-dfn-AesGcmParams-tagLength-2\"><code>tagLength</code></a> member of\n                  <var>normalizedAlgorithm</var> is not present:</dt>\n                  <dd>Let <var>tagLength</var> be 128.</dd>\n                  <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesGcmParams-tagLength\" class=\"internalDFN\" id=\"ref-for-dfn-AesGcmParams-tagLength-3\"><code>tagLength</code></a> member of\n                  <var>normalizedAlgorithm</var> is one of 32, 64, 96, 104, 112, 120 or 128:</dt>\n                  <dd>Let <var>tagLength</var> be equal to the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesGcmParams-tagLength\" class=\"internalDFN\" id=\"ref-for-dfn-AesGcmParams-tagLength-4\"><code>tagLength</code></a> member of\n                   <var>normalizedAlgorithm</var></dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                    <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the tagLength member of normalizedAlgorithm is not present:",
                  "html": "Let <var>tagLength</var> be 128."
                },
                {
                  "case": "If the tagLength member of normalizedAlgorithm is one of 32, 64, 96, 104, 112, 120 or 128:",
                  "html": "Let <var>tagLength</var> be equal to the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesGcmParams-tagLength\" class=\"internalDFN\" id=\"ref-for-dfn-AesGcmParams-tagLength-4\"><code>tagLength</code></a> member of\n                   <var>normalizedAlgorithm</var>"
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                    <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Let <var>additionalData</var> be the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesGcmParams-additionalData\" class=\"internalDFN\" id=\"ref-for-dfn-AesGcmParams-additionalData-3\"><code>additionalData</code></a> member of\n                  <var>normalizedAlgorithm</var> if present or an empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a>\n                  otherwise.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>C</var> and <var>T</var> be the outputs that result from performing\n                  the Authenticated Encryption Function described in Section 7.1 of\n                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-nist-sp800-38d\" title=\"NIST Special Publication 800-38D: Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode (GCM) and GMAC\">NIST-SP800-38D</a></cite>] using AES as the block cipher, the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesGcmParams-iv\" class=\"internalDFN\" id=\"ref-for-dfn-AesGcmParams-iv-3\"><code>iv</code></a> member of <var>normalizedAlgorithm</var> as\n                  the <var>IV</var> input parameter,\n                  <var>additionalData</var> as the <var>A</var> input parameter,\n                  <var>tagLength</var> as the <var>t</var> pre-requisite and\n                  <var>plaintext</var> as the input plaintext.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>ciphertext</var> be equal to <var>C</var> | <var>T</var>,\n                  where '|' denotes concatenation.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>ciphertext</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<dl class=\"switch\">\n                  <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesGcmParams-tagLength\" class=\"internalDFN\" id=\"ref-for-dfn-AesGcmParams-tagLength-5\"><code>tagLength</code></a> member of\n                  <var>normalizedAlgorithm</var> is not present:</dt>\n                  <dd>Let <var>tagLength</var> be 128.</dd>\n                  <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesGcmParams-tagLength\" class=\"internalDFN\" id=\"ref-for-dfn-AesGcmParams-tagLength-6\"><code>tagLength</code></a> member of\n                  <var>normalizedAlgorithm</var> is one of 32, 64, 96, 104, 112, 120 or 128:</dt>\n                  <dd>Let <var>tagLength</var> be equal to the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesGcmParams-tagLength\" class=\"internalDFN\" id=\"ref-for-dfn-AesGcmParams-tagLength-7\"><code>tagLength</code></a> member of\n                   <var>normalizedAlgorithm</var></dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                    <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the tagLength member of normalizedAlgorithm is not present:",
                  "html": "Let <var>tagLength</var> be 128."
                },
                {
                  "case": "If the tagLength member of normalizedAlgorithm is one of 32, 64, 96, 104, 112, 120 or 128:",
                  "html": "Let <var>tagLength</var> be equal to the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesGcmParams-tagLength\" class=\"internalDFN\" id=\"ref-for-dfn-AesGcmParams-tagLength-7\"><code>tagLength</code></a> member of\n                   <var>normalizedAlgorithm</var>"
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                    <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  If <var>ciphertext</var> has a <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-12\">length in bits</a> less than <var>tagLength</var>,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesGcmParams-iv\" class=\"internalDFN\" id=\"ref-for-dfn-AesGcmParams-iv-4\"><code>iv</code></a> member of\n                  <var>normalizedAlgorithm</var> has a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence-length\">length</a>\n                  greater than 2^64 - 1 bytes,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesGcmParams-additionalData\" class=\"internalDFN\" id=\"ref-for-dfn-AesGcmParams-additionalData-4\"><code>additionalData</code></a> member\n                  of <var>normalizedAlgorithm</var> is present and has a\n                  <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence-length\">length</a>\n                  greater than 2^64 - 1 bytes,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>tag</var> be the last <var>tagLength</var> bits of\n                  <var>ciphertext</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>actualCiphertext</var> be the result of removing the last <var>tagLength</var> bits\n                  from <var>ciphertext</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>additionalData</var> be the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesGcmParams-additionalData\" class=\"internalDFN\" id=\"ref-for-dfn-AesGcmParams-additionalData-5\"><code>additionalData</code></a> member of\n                  <var>normalizedAlgorithm</var> if present or an empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a>\n                  otherwise.\n                </p>"
        },
        {
          "html": "Perform the Authenticated Decryption Function described in Section 7.2 of\n                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-nist-sp800-38d\" title=\"NIST Special Publication 800-38D: Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode (GCM) and GMAC\">NIST-SP800-38D</a></cite>] using AES as the block cipher,\n                  the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesGcmParams-iv\" class=\"internalDFN\" id=\"ref-for-dfn-AesGcmParams-iv-5\"><code>iv</code></a> member of <var>normalizedAlgorithm</var> as\n                  the <var>IV</var> input parameter,\n                  <var>additionalData</var> as the <var>A</var> input parameter,\n                  <var>tagLength</var> as the <var>t</var> pre-requisite,\n                  <var>actualCiphertext</var> as the input ciphertext, <var>C</var> and <var>tag</var> as\n                  the authentication tag, <var>T</var>.",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the result of the algorithm is the indication of inauthenticity, \"FAIL\":",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                    <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>"
                },
                {
                  "case": "Otherwise:",
                  "html": "Let <var>plaintext</var> be the output <var>P</var> of the Authenticated\n                  Decryption Function."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Return <var>plaintext</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>usages</var> contains any entry which is not\n                  one of \"<code>encrypt</code>\", \"<code>decrypt</code>\",\n                  \"<code>wrapKey</code>\" or \"<code>unwrapKey</code>\",\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyGenParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyGenParams-length-8\"><code>length</code></a> member of\n                  <var>normalizedAlgorithm</var> is not equal to one of\n                  128, 192 or 256,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Generate an AES key of length\n                  equal to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyGenParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyGenParams-length-9\"><code>length</code></a> member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the key generation step fails,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>key</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-111\"><code>CryptoKey</code></a> object representing the\n                  generated AES key.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"AesKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-6\"><code>AesKeyAlgorithm</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-47\"><code>name</code></a> attribute of\n                  <var>algorithm</var> to \"<code>AES-GCM</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-length-12\"><code>length</code></a> attribute of\n                  <var>algorithm</var> to equal the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyGenParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyGenParams-length-10\"><code>length</code></a> member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-97\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-secret\" class=\"internalDFN\" id=\"ref-for-dom-keytype-secret-10\"><code>secret</code></a>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-111\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>key</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-35\"><code>[[extractable]]</code></a> internal\n                  slot of <var>key</var> to be <var>extractable</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-34\"><code>[[usages]]</code></a> internal slot of\n                  <var>key</var> to be <var>usages</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>key</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>usages</var> contains an entry which is not\n                  one of \"<code>encrypt</code>\", \"<code>decrypt</code>\",\n                  \"<code>wrapKey</code>\" or \"<code>unwrapKey</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-22\"><code>raw</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-25\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>data</var> be <var>keyData</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-13\">length in bits</a> of <var>data</var> is not 128, 192 or 256\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If <var>keyData</var> is a <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-26\"><code>JsonWebKey</code></a> dictionary:</dt>\n                          <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                          <dt>Otherwise:</dt>\n                          <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-kty\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-kty-11\"><code>kty</code></a> field of <var>jwk</var> is not\n                          \"<code>oct</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>jwk</var> does not meet the requirements of\n                          Section 6.4 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>data</var> be the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> obtained by decoding the\n                          <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-k\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-k-5\"><code>k</code></a> field of <var>jwk</var>.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-14\">length in bits</a> of <var>data</var> is 128:</dt>\n                          <dd>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-22\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                          not  \"<code>A128GCM</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</dd>\n                          <dt>If the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-15\">length in bits</a> of <var>data</var> is 192:</dt>\n                          <dd>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-23\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                          not  \"<code>A192GCM</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</dd>\n                          <dt>If the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-16\">length in bits</a> of <var>data</var> is 256:</dt>\n                          <dd>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-24\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                          not  \"<code>A256GCM</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the length in bits of data is 128:",
                              "html": "If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-22\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                          not  \"<code>A128GCM</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If the length in bits of data is 192:",
                              "html": "If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-23\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                          not  \"<code>A192GCM</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If the length in bits of data is 256:",
                              "html": "If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-24\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                          not  \"<code>A256GCM</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If <var>usages</var> is non-empty and the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-use\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-use-10\"><code>use</code></a> field of <var>jwk</var> is present and is\n                          not  \"<code>enc</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-key_ops\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-key_ops-10\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                          is invalid according to the requirements of\n                          JSON Web Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>] or\n                          does not contain all of the specified <var>usages</var> values,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-ext\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-ext-12\"><code>ext</code></a> field of <var>jwk</var> is present and\n                          has the value false and <var>extractable</var> is true,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-112\"><code>CryptoKey</code></a>\n                  object representing an AES key with value <var>data</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-98\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-secret\" class=\"internalDFN\" id=\"ref-for-dom-keytype-secret-11\"><code>secret</code></a>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"AesKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-7\"><code>AesKeyAlgorithm</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-48\"><code>name</code></a> attribute of\n                  <var>algorithm</var> to \"<code>AES-GCM</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-length-13\"><code>length</code></a> attribute of\n                  <var>algorithm</var> to the length, in bits, of <var>data</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-112\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>key</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>key</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the underlying cryptographic key material represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-46\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n                  cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-23\"><code>raw</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-26\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>data</var> be a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> containing\n                          the raw octets of the key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-47\"><code>[[handle]]</code></a> internal slot of\n                          <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>data</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>jwk</var> be a new <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-27\"><code>JsonWebKey</code></a>\n                          dictionary.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>kty</code> attribute of <var>jwk</var> to the\n                          string \"<code>oct</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-k\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-k-6\"><code>k</code></a> attribute of <var>jwk</var> to be a string\n                          containing the raw octets of the key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-48\"><code>[[handle]]</code></a> internal slot of\n                          <var>key</var>, encoded according to Section 6.4 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-length-14\"><code>length</code></a> attribute of\n                          <var>key</var> is 128:</dt>\n                          <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A128GCM</code>\".</dd>\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-length-15\"><code>length</code></a> attribute of\n                          <var>key</var> is 192:</dt>\n                          <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A192GCM</code>\".</dd>\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-length-16\"><code>length</code></a> attribute of\n                          <var>key</var> is 256:</dt>\n                          <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A256GCM</code>\".</dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the length attribute of key is 128:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A128GCM</code>\"."
                            },
                            {
                              "case": "If the length attribute of key is 192:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A192GCM</code>\"."
                            },
                            {
                              "case": "If the length attribute of key is 256:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A256GCM</code>\"."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Set the <code>key_ops</code> attribute of <var>jwk</var> to equal the\n                          <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-cryptokey-usages\" class=\"internalDFN\" id=\"ref-for-dom-cryptokey-usages-9\"><code>usages</code></a> attribute of\n                          <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>ext</code> attribute of <var>jwk</var> to equal the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-36\"><code>[[extractable]]</code></a> internal slot\n                          of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>jwk</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesDerivedKeyParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesDerivedKeyParams-length-6\"><code>length</code></a> member of\n                  <var>normalizedDerivedKeyAlgorithm</var> is not 128, 192 or 256, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesDerivedKeyParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesDerivedKeyParams-length-7\"><code>length</code></a> member of\n                  <var>normalizedDerivedKeyAlgorithm</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>plaintext</var> is not a multiple of 64 bits in length,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                          <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>ciphertext</var> be the result of performing the Key Wrap\n                  operation described in Section 2.2.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3394\" title=\"Advanced Encryption Standard (AES) Key Wrap Algorithm\">RFC3394</a></cite>]\n                  with <var>plaintext</var> as the plaintext to be wrapped and using the default\n                  Initial Value defined in Section 2.2.3.1 of the same document.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>ciphertext</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>plaintext</var> be the result of performing the Key Unwrap\n                  operation described in Section 2.2.2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc3394\" title=\"Advanced Encryption Standard (AES) Key Wrap Algorithm\">RFC3394</a></cite>] with\n                  <var>ciphertext</var> as the input ciphertext and using the default Initial\n                  Value defined in Section 2.2.3.1 of the same document.\n                </p>"
        },
        {
          "html": "<p>\n                  If the Key Unwrap operation returns an error,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>plaintext</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>usages</var> contains any entry which is not one of\n                  \"<code>wrapKey</code>\" or \"<code>unwrapKey</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyGenParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyGenParams-length-11\"><code>length</code></a> property of\n                  <var>normalizedAlgorithm</var> is not equal to one of 128, 192 or 256, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Generate an AES key of length\n                  equal to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyGenParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyGenParams-length-12\"><code>length</code></a> member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the key generation step fails,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>key</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-115\"><code>CryptoKey</code></a> object representing the\n                  generated AES key.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"AesKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-8\"><code>AesKeyAlgorithm</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-49\"><code>name</code></a> attribute of\n                  <var>algorithm</var> to \"<code>AES-KW</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-length-17\"><code>length</code></a> attribute of\n                  <var>algorithm</var> to equal the\n                  <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyGenParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyGenParams-length-13\"><code>length</code></a> property of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-99\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-secret\" class=\"internalDFN\" id=\"ref-for-dom-keytype-secret-12\"><code>secret</code></a>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-113\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>key</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-37\"><code>[[extractable]]</code></a> internal\n                  slot of <var>key</var> to be <var>extractable</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-35\"><code>[[usages]]</code></a> internal slot of\n                  <var>key</var> to be <var>usages</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>key</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>usages</var> contains an entry which is not\n                   one of \"<code>wrapKey</code>\" or \"<code>unwrapKey</code>\",\n\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-24\"><code>raw</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-27\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>data</var> be <var>keyData</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-17\">length in bits</a> of <var>data</var> is not 128, 192 or 256\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If <var>keyData</var> is a <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-28\"><code>JsonWebKey</code></a> dictionary:</dt>\n                          <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                          <dt>Otherwise:</dt>\n                          <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-kty\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-kty-12\"><code>kty</code></a> field of <var>jwk</var> is not\n                          \"<code>oct</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>jwk</var> does not meet the requirements of\n                          Section 6.4 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>data</var> be the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> obtained by decoding the\n                          <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-k\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-k-7\"><code>k</code></a> field of <var>jwk</var>.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-18\">length in bits</a> of <var>data</var> is 128:</dt>\n                          <dd>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-25\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                          not  \"<code>A128KW</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</dd>\n                          <dt>If the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-19\">length in bits</a> of <var>data</var> is 192:</dt>\n                          <dd>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-26\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                          not  \"<code>A192KW</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</dd>\n                          <dt>If the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-20\">length in bits</a> of <var>data</var> is 256:</dt>\n                          <dd>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-27\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                          not  \"<code>A256KW</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</dd>\n                          <dt>Otherwise:</dt>\n                          <dd>\n                            <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the length in bits of data is 128:",
                              "html": "If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-25\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                          not  \"<code>A128KW</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If the length in bits of data is 192:",
                              "html": "If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-26\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                          not  \"<code>A192KW</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If the length in bits of data is 256:",
                              "html": "If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-27\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                          not  \"<code>A256KW</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If <var>usages</var> is non-empty and the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-use\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-use-11\"><code>use</code></a> field of <var>jwk</var> is present and is\n                          not  \"<code>enc</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-key_ops\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-key_ops-11\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                          is invalid according to the requirements of\n                          JSON Web Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>] or\n                          does not contain all of the specified <var>usages</var> values,\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-ext\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-ext-13\"><code>ext</code></a> field of <var>jwk</var> is present and\n                          has the value false and <var>extractable</var> is true,\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.                          </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-116\"><code>CryptoKey</code></a>\n                  representing an AES key with value <var>data</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-100\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-secret\" class=\"internalDFN\" id=\"ref-for-dom-keytype-secret-13\"><code>secret</code></a>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"AesKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-9\"><code>AesKeyAlgorithm</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-50\"><code>name</code></a> attribute of\n                  <var>algorithm</var> to \"<code>AES-KW</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-length-18\"><code>length</code></a> attribute of\n                  <var>algorithm</var> to the length, in bits, of <var>data</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-114\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>key</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>key</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the underlying cryptographic key material represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-49\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n                  cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-25\"><code>raw</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-28\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>data</var> be a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> containing\n                          the raw octets of the key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-50\"><code>[[handle]]</code></a> internal slot of\n                          <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>data</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>jwk</var> be a new <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-29\"><code>JsonWebKey</code></a>\n                          dictionary.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>kty</code> attribute of <var>jwk</var> to the\n                          string \"<code>oct</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-k\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-k-8\"><code>k</code></a> attribute of <var>jwk</var> to be a string\n                          containing the raw octets of the key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-51\"><code>[[handle]]</code></a> internal slot of\n                          <var>key</var>, encoded according to Section 6.4 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-length-19\"><code>length</code></a> attribute of\n                          <var>key</var> is 128:</dt>\n                          <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A128KW</code>\".</dd>\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-length-20\"><code>length</code></a> attribute of\n                          <var>key</var> is 192:</dt>\n                          <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A192KW</code>\".</dd>\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesKeyAlgorithm-length-21\"><code>length</code></a> attribute of\n                          <var>key</var> is 256:</dt>\n                          <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A256KW</code>\".</dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the length attribute of key is 128:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A128KW</code>\"."
                            },
                            {
                              "case": "If the length attribute of key is 192:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A192KW</code>\"."
                            },
                            {
                              "case": "If the length attribute of key is 256:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>A256KW</code>\"."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Set the <code>key_ops</code> attribute of <var>jwk</var> to equal the\n                          <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-cryptokey-usages\" class=\"internalDFN\" id=\"ref-for-dom-cryptokey-usages-10\"><code>usages</code></a> attribute of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>ext</code> attribute of <var>jwk</var> to equal the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-38\"><code>[[extractable]]</code></a> internal slot\n                          of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>jwk</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesDerivedKeyParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesDerivedKeyParams-length-8\"><code>length</code></a> member of\n                  <var>normalizedDerivedKeyAlgorithm</var> is not 128, 192 or 256, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-AesDerivedKeyParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-AesDerivedKeyParams-length-9\"><code>length</code></a> member of\n                  <var>normalizedDerivedKeyAlgorithm</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>mac</var> be the result of performing the MAC Generation operation\n                  described in Section 4 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-fips-198-1\" title=\"The Keyed-Hash Message Authentication Code (HMAC)\">FIPS-198-1</a></cite>] using\n                  the key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-52\"><code>[[handle]]</code></a>\n                  internal slot of <var>key</var>, the hash function identified by the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-HmacKeyAlgorithm-hash-2\"><code>hash</code></a> attribute of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-115\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var> and <var>message</var> as the input data <var>text</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>mac</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                  Let <var>mac</var> be the result of performing the MAC Generation operation\n                  described in Section 4 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-fips-198-1\" title=\"The Keyed-Hash Message Authentication Code (HMAC)\">FIPS-198-1</a></cite>] using\n                  the key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-53\"><code>[[handle]]</code></a>\n                  internal slot of <var>key</var>, the hash function identified by the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-HmacKeyAlgorithm-hash-3\"><code>hash</code></a> attribute of the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-116\"><code>[[algorithm]]</code></a> internal slot of\n                  <var>key</var> and <var>message</var> as the input data <var>text</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return true if <var>mac</var> is equal to <var>signature</var> and false\n                  otherwise.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>usages</var> contains any entry which is not \"<code>sign</code>\" or\n                  \"<code>verify</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>\n                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacKeyGenParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-HmacKeyGenParams-length-2\"><code>length</code></a> member of\n                    <var>normalizedAlgorithm</var> is not present:\n                  </dt>\n                  <dd>\n                    Let <var>length</var> be the block size in bits of the hash function\n                    identified by the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacKeyGenParams-hash\" class=\"internalDFN\" id=\"ref-for-dfn-HmacKeyGenParams-hash-2\"><code>hash</code></a> member\n                    of <var>normalizedAlgorithm</var>.\n                  </dd>\n                  <dt>\n                    Otherwise, if the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacKeyGenParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-HmacKeyGenParams-length-3\"><code>length</code></a>\n                    member of <var>normalizedAlgorithm</var> is non-zero:\n                  </dt>\n                  <dd>\n                    Let <var>length</var> be equal to the\n                    <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacKeyGenParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-HmacKeyGenParams-length-4\"><code>length</code></a>\n                    member of <var>normalizedAlgorithm</var>.\n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                    <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the length member of normalizedAlgorithm is not present:",
                  "html": "Let <var>length</var> be the block size in bits of the hash function\n                    identified by the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacKeyGenParams-hash\" class=\"internalDFN\" id=\"ref-for-dfn-HmacKeyGenParams-hash-2\"><code>hash</code></a> member\n                    of <var>normalizedAlgorithm</var>."
                },
                {
                  "case": "Otherwise, if the length member of normalizedAlgorithm is non-zero:",
                  "html": "Let <var>length</var> be equal to the\n                    <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacKeyGenParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-HmacKeyGenParams-length-4\"><code>length</code></a>\n                    member of <var>normalizedAlgorithm</var>."
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                    <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Generate a key of length <var>length</var> bits.\n                </p>"
        },
        {
          "html": "<p>\n                  If the key generation step fails,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>key</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-119\"><code>CryptoKey</code></a> object representing the\n                  generated key.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"HmacKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-HmacKeyAlgorithm-2\"><code>HmacKeyAlgorithm</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-51\"><code>name</code></a> attribute of\n                  <var>algorithm</var> to \"<code>HMAC</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-HmacKeyAlgorithm-length-2\"><code>length</code></a> attribute of\n                  <var>algorithm</var> to <var>length</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>hash</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"KeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-KeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-KeyAlgorithm-20\"><code>KeyAlgorithm</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-52\"><code>name</code></a> attribute of\n                  <var>hash</var> to equal the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-algorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-algorithm-name-14\"><code>name</code></a>\n                  member of the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacKeyGenParams-hash\" class=\"internalDFN\" id=\"ref-for-dfn-HmacKeyGenParams-hash-3\"><code>hash</code></a>\n                  member of <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-HmacKeyAlgorithm-hash-4\"><code>hash</code></a> attribute\n                  of <var>algorithm</var> to <var>hash</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-101\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-secret\" class=\"internalDFN\" id=\"ref-for-dom-keytype-secret-14\"><code>secret</code></a>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-117\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>key</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-39\"><code>[[extractable]]</code></a> internal\n                  slot of <var>key</var> to be <var>extractable</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[usages]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-usages\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-usages-36\"><code>[[usages]]</code></a> internal slot of\n                  <var>key</var> to be <var>usages</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>key</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<p>\n                  If <var>usages</var> contains an entry which is not\n                  \"<code>sign</code>\" or \"<code>verify</code>\",\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>hash</var> be a new <a data-link-type=\"idl\" data-lt=\"KeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-KeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-KeyAlgorithm-21\"><code>KeyAlgorithm</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-26\"><code>raw</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-29\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>data</var> be <var>keyData</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set <var>hash</var> to equal the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacImportParams-hash\" class=\"internalDFN\" id=\"ref-for-dfn-HmacImportParams-hash-2\"><code>hash</code></a>\n                            member of <var>normalizedAlgorithm</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If <var>keyData</var> is a <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-30\"><code>JsonWebKey</code></a> dictionary:</dt>\n                          <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                          <dt>Otherwise:</dt>\n                          <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-kty\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-kty-13\"><code>kty</code></a> field of <var>jwk</var> is not\n                          \"<code>oct</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>jwk</var> does not meet the requirements of\n                          Section 6.4 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>],\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>data</var> be the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> obtained by decoding the\n                          <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-k\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-k-9\"><code>k</code></a> field of <var>jwk</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <var>hash</var> to equal the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacImportParams-hash\" class=\"internalDFN\" id=\"ref-for-dfn-HmacImportParams-hash-3\"><code>hash</code></a> member of\n                          <var>normalizedAlgorithm</var>.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-53\"><code>name</code></a> attribute\n                            of <var>hash</var> is\n                            \"<code>SHA-1</code>\":\n                          </dt>\n                          <dd>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-28\"><code>alg</code></a> field of <var>jwk</var> is present\n                            and is not \"<code>HS1</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                          </dd>\n                          <dt>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-54\"><code>name</code></a> attribute\n                            of <var>hash</var> is\n                            \"<code>SHA-256</code>\":\n                          </dt>\n                          <dd>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-29\"><code>alg</code></a> field of <var>jwk</var> is present\n                            and is not \"<code>HS256</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                          </dd>\n                          <dt>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-55\"><code>name</code></a> attribute\n                            of <var>hash</var> is\n                            \"<code>SHA-384</code>\":\n                          </dt>\n                          <dd>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-30\"><code>alg</code></a> field of <var>jwk</var> is present\n                            and is not \"<code>HS384</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                          </dd>\n                          <dt>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-56\"><code>name</code></a> attribute\n                            of <var>hash</var> is\n                            \"<code>SHA-512</code>\":\n                          </dt>\n                          <dd>\n                            If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-31\"><code>alg</code></a> field of <var>jwk</var> is present\n                            and is not \"<code>HS512</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                          </dd>\n                          <dt>\n                            Otherwise, if the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-57\"><code>name</code></a> attribute\n                            of <var>hash</var> is defined in\n                            <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-47\">another applicable\n                            specification</a>:\n                          </dt>\n                          <dd>\n                            Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"HMAC key import steps\" href=\"https://w3c.github.io/webcrypto/#dfn-hmac-extended-import-steps\" class=\"internalDFN\" id=\"ref-for-dfn-hmac-extended-import-steps-1\">key import steps</a> defined by\n                            <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-48\">other applicable\n                            specifications</a>, passing <var>format</var>, <var>jwk</var>\n                            and <var>hash</var>\n                            and obtaining <var>hash</var>.\n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name attribute of hash is \"SHA-1\":",
                              "html": "If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-28\"><code>alg</code></a> field of <var>jwk</var> is present\n                            and is not \"<code>HS1</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If the name attribute of hash is \"SHA-256\":",
                              "html": "If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-29\"><code>alg</code></a> field of <var>jwk</var> is present\n                            and is not \"<code>HS256</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If the name attribute of hash is \"SHA-384\":",
                              "html": "If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-30\"><code>alg</code></a> field of <var>jwk</var> is present\n                            and is not \"<code>HS384</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If the name attribute of hash is \"SHA-512\":",
                              "html": "If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-alg\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-alg-31\"><code>alg</code></a> field of <var>jwk</var> is present\n                            and is not \"<code>HS512</code>\",\n                            then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                            <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            },
                            {
                              "case": "Otherwise, if the name attribute of hash is defined in another applicable specification:",
                              "html": "Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"HMAC key import steps\" href=\"https://w3c.github.io/webcrypto/#dfn-hmac-extended-import-steps\" class=\"internalDFN\" id=\"ref-for-dfn-hmac-extended-import-steps-1\">key import steps</a> defined by\n                            <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-48\">other applicable\n                            specifications</a>, passing <var>format</var>, <var>jwk</var>\n                            and <var>hash</var>\n                            and obtaining <var>hash</var>."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          If <var>usages</var> is non-empty and the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-use\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-use-12\"><code>use</code></a> field of <var>jwk</var> is present and is\n                          not  \"<code>sign</code>\",\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-key_ops\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-key_ops-12\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                          is invalid according to the requirements of\n                          JSON Web Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>] or\n                          does not contain all of the specified <var>usages</var> values,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-ext\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-ext-14\"><code>ext</code></a> field of <var>jwk</var> is present and\n                          has the value false and <var>extractable</var> is true,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Let <var>length</var> be the <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-length-in-bits\" class=\"internalDFN\" id=\"ref-for-dfn-length-in-bits-21\">length in bits</a> of\n                  <var>data</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  If <var>length</var> is zero\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>\n                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-HmacImportParams-length-2\"><code>length</code></a> member of\n                    <var>normalizedAlgorithm</var> is present:\n                  </dt>\n                  <dd>\n                    <dl class=\"switch\">\n                      <dt>\n                        If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-HmacImportParams-length-3\"><code>length</code></a> member of\n                        <var>normalizedAlgorithm</var> is greater than <var>length</var>:\n                      </dt>\n                      <dd>\n                        <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </dd>\n                      <dt>\n                        If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-HmacImportParams-length-4\"><code>length</code></a> member of\n                        <var>normalizedAlgorithm</var>, is less than or equal to\n                        <var>length</var> minus eight:\n                      </dt>\n                      <dd>\n                        <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </dd>\n                      <dt>\n                        Otherwise:\n                      </dt>\n                      <dd>\n                        Set <var>length</var> equal to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-HmacImportParams-length-5\"><code>length</code></a>\n                        member of <var>normalizedAlgorithm</var>.\n                      </dd>\n                    </dl>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the length member of normalizedAlgorithm is present:",
                  "html": "<dl class=\"switch\">\n                      <dt>\n                        If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-HmacImportParams-length-3\"><code>length</code></a> member of\n                        <var>normalizedAlgorithm</var> is greater than <var>length</var>:\n                      </dt>\n                      <dd>\n                        <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </dd>\n                      <dt>\n                        If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-HmacImportParams-length-4\"><code>length</code></a> member of\n                        <var>normalizedAlgorithm</var>, is less than or equal to\n                        <var>length</var> minus eight:\n                      </dt>\n                      <dd>\n                        <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </dd>\n                      <dt>\n                        Otherwise:\n                      </dt>\n                      <dd>\n                        Set <var>length</var> equal to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-HmacImportParams-length-5\"><code>length</code></a>\n                        member of <var>normalizedAlgorithm</var>.\n                      </dd>\n                    </dl>",
                  "rationale": ".switch",
                  "steps": [
                    {
                      "operation": "switch",
                      "steps": [
                        {
                          "case": "If the length member of normalizedAlgorithm is greater than length:",
                          "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                        },
                        {
                          "case": "If the length member of normalizedAlgorithm, is less than or equal to length minus eight:",
                          "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                        },
                        {
                          "case": "Otherwise:",
                          "html": "Set <var>length</var> equal to the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-HmacImportParams-length-5\"><code>length</code></a>\n                        member of <var>normalizedAlgorithm</var>."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-120\"><code>CryptoKey</code></a>\n                  object representing an HMAC key with the first <var>length</var>\n                  bits of <var>data</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-102\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-secret\" class=\"internalDFN\" id=\"ref-for-dom-keytype-secret-15\"><code>secret</code></a>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new\n                  <a data-link-type=\"idl\" data-lt=\"HmacKeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-HmacKeyAlgorithm-3\"><code>HmacKeyAlgorithm</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-58\"><code>name</code></a> attribute of\n                  <var>algorithm</var> to \"<code>HMAC</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-HmacKeyAlgorithm-length-3\"><code>length</code></a> attribute of\n                  <var>algorithm</var> to <var>length</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-HmacKeyAlgorithm-hash-5\"><code>hash</code></a> attribute of\n                  <var>algorithm</var> to <var>hash</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-118\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>key</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>key</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If the underlying cryptographic key material represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-54\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n                  cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>bits</var> be the raw bits of the key represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-55\"><code>[[handle]]</code></a> internal slot of\n                  <var>key</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>data</var> be a <a data-link-type=\"dfn|abstract-op\" href=\"https://w3c.github.io/webcrypto/#dfn-byte-sequence-containing\" class=\"internalDFN\" id=\"ref-for-dfn-byte-sequence-containing-3\">byte sequence containing</a> <var>bits</var>.\n                </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-27\"><code>raw</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-30\"><code>jwk</code></a>\":</dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>data</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                          Let <var>jwk</var> be a new <a data-link-type=\"idl\" data-lt=\"JsonWebKey\" href=\"https://w3c.github.io/webcrypto/#dfn-JsonWebKey\" class=\"internalDFN\" id=\"ref-for-dfn-JsonWebKey-31\"><code>JsonWebKey</code></a>\n                          dictionary.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>kty</code> attribute of <var>jwk</var> to the\n                          string \"<code>oct</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-jsonwebkey-k\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-k-10\"><code>k</code></a> attribute of <var>jwk</var> to be a string\n                          containing <var>data</var>, encoded according to Section 6.4 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>algorithm</var> be the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-119\"><code>[[algorithm]]</code></a> internal slot of\n                          <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>hash</var> be the\n                          <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacKeyAlgorithm-hash\" class=\"internalDFN\" id=\"ref-for-dfn-HmacKeyAlgorithm-hash-6\"><code>hash</code></a> attribute of\n                          <var>algorithm</var>.\n                        </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-59\"><code>name</code></a> attribute of\n                          <var>hash</var> is \"<code>SHA-1</code>\":</dt>\n                          <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>HS1</code>\".</dd>\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-60\"><code>name</code></a> attribute of\n                          <var>hash</var> is \"<code>SHA-256</code>\":</dt>\n                          <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>HS256</code>\".</dd>\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-61\"><code>name</code></a> attribute of\n                          <var>hash</var> is \"<code>SHA-384</code>\":</dt>\n                          <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>HS384</code>\".</dd>\n                          <dt>If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-62\"><code>name</code></a> attribute of\n                          <var>hash</var> is \"<code>SHA-512</code>\":</dt>\n                          <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>HS512</code>\".</dd>\n                          <dt>\n                            Otherwise, the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-63\"><code>name</code></a> attribute\n                            of <var>hash</var> is defined in\n                            <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-49\">another applicable\n                            specification</a>:\n                          </dt>\n                          <dd>\n                            \n                          </dd>\n                        </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name attribute of hash is \"SHA-1\":",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>HS1</code>\"."
                            },
                            {
                              "case": "If the name attribute of hash is \"SHA-256\":",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>HS256</code>\"."
                            },
                            {
                              "case": "If the name attribute of hash is \"SHA-384\":",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>HS384</code>\"."
                            },
                            {
                              "case": "If the name attribute of hash is \"SHA-512\":",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                          the string \"<code>HS512</code>\"."
                            },
                            {
                              "case": "Otherwise, the name attribute of hash is defined in another applicable specification:",
                              "html": "",
                              "rationale": "perform",
                              "steps": [
                                {
                                  "html": "<p>\n                                  Perform any <a data-link-type=\"dfn|abstract-op\" data-lt=\"HMAC key export steps\" href=\"https://w3c.github.io/webcrypto/#dfn-hmac-extended-export-steps\" class=\"internalDFN\" id=\"ref-for-dfn-hmac-extended-export-steps-1\">key export steps</a> defined by\n                                  <a href=\"https://w3c.github.io/webcrypto/#dfn-applicable-specification\" id=\"ref-for-dfn-applicable-specification-50\">other applicable\n                                  specifications</a>, passing <var>format</var> and <var>key</var>\n                                  and obtaining <var>alg</var>.\n                                </p>"
                                },
                                {
                                  "html": "<p>\n                                  Set the <code>alg</code> attribute of <var>jwk</var> to\n                                  <var>alg</var>.\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                          Set the <code>key_ops</code> attribute of <var>jwk</var> to equal the\n                          <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-cryptokey-usages\" class=\"internalDFN\" id=\"ref-for-dom-cryptokey-usages-11\"><code>usages</code></a> attribute of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <code>ext</code> attribute of <var>jwk</var> to equal the <a data-link-type=\"attribute\" data-lt=\"[[extractable]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-extractable\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-extractable-40\"><code>[[extractable]]</code></a> internal slot\n                          of <var>key</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>result</var> be <var>jwk</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                    </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<dl class=\"switch\">\n                  <dt>\n                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-HmacImportParams-length-6\"><code>length</code></a> member of\n                    <var>normalizedDerivedKeyAlgorithm</var> is not present:\n                  </dt>\n                  <dd>\n                    <p>\n                      Let <var>length</var> be the block size in bits of the hash function\n                      identified by the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacImportParams-hash\" class=\"internalDFN\" id=\"ref-for-dfn-HmacImportParams-hash-4\"><code>hash</code></a> member\n                      of <var>normalizedDerivedKeyAlgorithm</var>.\n                    </p>\n                  </dd>\n                  <dt>\n                    Otherwise, if the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-HmacImportParams-length-7\"><code>length</code></a>\n                    member of <var>normalizedDerivedKeyAlgorithm</var> is non-zero:\n                  </dt>\n                  <dd>\n                    Let <var>length</var> be equal to the\n                    <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-HmacImportParams-length-8\"><code>length</code></a>\n                    member of <var>normalizedDerivedKeyAlgorithm</var>.\n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"TypeError\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\"><code>TypeError</code></a>.\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the length member of normalizedDerivedKeyAlgorithm is not present:",
                  "html": "<p>\n                      Let <var>length</var> be the block size in bits of the hash function\n                      identified by the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacImportParams-hash\" class=\"internalDFN\" id=\"ref-for-dfn-HmacImportParams-hash-4\"><code>hash</code></a> member\n                      of <var>normalizedDerivedKeyAlgorithm</var>.\n                    </p>"
                },
                {
                  "case": "Otherwise, if the length member of normalizedDerivedKeyAlgorithm is non-zero:",
                  "html": "Let <var>length</var> be equal to the\n                    <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-HmacImportParams-length-8\"><code>length</code></a>\n                    member of <var>normalizedDerivedKeyAlgorithm</var>."
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"TypeError\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\"><code>TypeError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  Return <var>length</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<dl class=\"switch\">\n                  <dt>\n                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-algorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-algorithm-name-15\"><code>name</code></a> member of\n                    <var>normalizedAlgorithm</var> is a cases-sensitive string match for\n                    \"<code>SHA-1</code>\":\n                  </dt>\n                  <dd>\n                    Let <var>result</var> be the result of performing the SHA-1 hash function\n                    defined in Section 6.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-fips-180-4\" title=\"FIPS PUB 180-4: Secure Hash Standard (SHS)\">FIPS-180-4</a></cite>] using\n                    <var>message</var> as the input message, <var>M</var>.\n                  </dd>\n                  <dt>\n                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-algorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-algorithm-name-16\"><code>name</code></a> member of\n                    <var>normalizedAlgorithm</var> is a cases-sensitive string match for\n                    \"<code>SHA-256</code>\":\n                  </dt>\n                  <dd>\n                    Let <var>result</var> be the result of performing the SHA-256 hash function\n                    defined in Section 6.2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-fips-180-4\" title=\"FIPS PUB 180-4: Secure Hash Standard (SHS)\">FIPS-180-4</a></cite>] using\n                    <var>message</var> as the input message, <var>M</var>.\n                  </dd>\n                  <dt>\n                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-algorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-algorithm-name-17\"><code>name</code></a> member of\n                    <var>normalizedAlgorithm</var> is a cases-sensitive string match for\n                    \"<code>SHA-384</code>\":\n                  </dt>\n                  <dd>\n                    Let <var>result</var> be the result of performing the SHA-384 hash function\n                    defined in Section 6.5 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-fips-180-4\" title=\"FIPS PUB 180-4: Secure Hash Standard (SHS)\">FIPS-180-4</a></cite>] using\n                    <var>message</var> as the input message, <var>M</var>.\n                  </dd>\n                  <dt>\n                    If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-algorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-algorithm-name-18\"><code>name</code></a> member of\n                    <var>normalizedAlgorithm</var> is a cases-sensitive string match for\n                    \"<code>SHA-512</code>\":\n                  </dt>\n                  <dd>\n                    Let <var>result</var> be the result of performing the SHA-512 hash function\n                    defined in Section 6.4 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-fips-180-4\" title=\"FIPS PUB 180-4: Secure Hash Standard (SHS)\">FIPS-180-4</a></cite>] using\n                    <var>message</var> as the input message, <var>M</var>.\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the name member of normalizedAlgorithm is a cases-sensitive string match for \"SHA-1\":",
                  "html": "Let <var>result</var> be the result of performing the SHA-1 hash function\n                    defined in Section 6.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-fips-180-4\" title=\"FIPS PUB 180-4: Secure Hash Standard (SHS)\">FIPS-180-4</a></cite>] using\n                    <var>message</var> as the input message, <var>M</var>."
                },
                {
                  "case": "If the name member of normalizedAlgorithm is a cases-sensitive string match for \"SHA-256\":",
                  "html": "Let <var>result</var> be the result of performing the SHA-256 hash function\n                    defined in Section 6.2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-fips-180-4\" title=\"FIPS PUB 180-4: Secure Hash Standard (SHS)\">FIPS-180-4</a></cite>] using\n                    <var>message</var> as the input message, <var>M</var>."
                },
                {
                  "case": "If the name member of normalizedAlgorithm is a cases-sensitive string match for \"SHA-384\":",
                  "html": "Let <var>result</var> be the result of performing the SHA-384 hash function\n                    defined in Section 6.5 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-fips-180-4\" title=\"FIPS PUB 180-4: Secure Hash Standard (SHS)\">FIPS-180-4</a></cite>] using\n                    <var>message</var> as the input message, <var>M</var>."
                },
                {
                  "case": "If the name member of normalizedAlgorithm is a cases-sensitive string match for \"SHA-512\":",
                  "html": "Let <var>result</var> be the result of performing the SHA-512 hash function\n                    defined in Section 6.4 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-fips-180-4\" title=\"FIPS PUB 180-4: Secure Hash Standard (SHS)\">FIPS-180-4</a></cite>] using\n                    <var>message</var> as the input message, <var>M</var>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                  If performing the operation results in an error, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>length</var> is null or is not a multiple of 8, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>keyDerivationKey</var> be the secret represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-56\"><code>[[handle]]</code></a> internal slot of <var>key</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of performing the HKDF extract and then\n                  the HKDF expand step described in Section 2 of\n                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc5869\" title=\"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)\">RFC5869</a></cite>] using:\n                </p>\n                <ul>\n                  <li>\n                    <p>\n                      the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HkdfParams-hash\" class=\"internalDFN\" id=\"ref-for-dfn-HkdfParams-hash-2\"><code>hash</code></a> member of\n                      <var>normalizedAlgorithm</var> as <var>Hash</var>,\n                    </p>\n                  </li>\n                  <li>\n                    <p>\n                      <var>keyDerivationKey</var> as the input keying material,\n                      <var>IKM</var>,\n                    </p>\n                  </li>\n                  <li>\n                    <p>\n                      the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HkdfParams-salt\" class=\"internalDFN\" id=\"ref-for-dfn-HkdfParams-salt-2\"><code>salt</code></a> member of\n                      <var>normalizedAlgorithm</var> as <var>salt</var>,\n                    </p>\n                  </li>\n                  <li>\n                    <p>\n                      the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-HkdfParams-info\" class=\"internalDFN\" id=\"ref-for-dfn-HkdfParams-info-2\"><code>info</code></a> member of\n                      <var>normalizedAlgorithm</var> as <var>info</var>,\n                    </p>\n                  </li>\n                  <li>\n                    <p>\n                      <var>length</var> divided by 8 as the value of <var>L</var>,\n                    </p>\n                  </li>\n                </ul>"
        },
        {
          "html": "<p>\n                  If the key derivation operation fails,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n                  <dt>\n                    If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-28\"><code>raw</code></a>\":\n                  </dt>\n                  <dd>\n                    \n                  </dd>\n                  <dt>Otherwise:</dt>\n                  <dd>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </dd>\n                </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                          If <var>usages</var> contains a value that is not\n                           \"<code>deriveKey</code>\" or \"<code>deriveBits</code>\",\n\n                              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                              <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          If <var>extractable</var> is not <code>false</code>,\n                          then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                          <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-122\"><code>CryptoKey</code></a>\n                          representing the key data provided in <var>keyData</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-103\"><code>[[type]]</code></a> internal slot of\n                          <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-secret\" class=\"internalDFN\" id=\"ref-for-dom-keytype-secret-16\"><code>secret</code></a>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Let <var>algorithm</var> be a new\n                          <a data-link-type=\"idl\" data-lt=\"KeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-KeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-KeyAlgorithm-22\"><code>KeyAlgorithm</code></a> object.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-64\"><code>name</code></a> attribute of\n                          <var>algorithm</var> to \"<code>HKDF</code>\".\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-120\"><code>[[algorithm]]</code></a> internal\n                          slot of <var>key</var> to <var>algorithm</var>.\n                        </p>"
                    },
                    {
                      "html": "<p>\n                          Return <var>key</var>.\n                        </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "rationale": "return",
      "steps": [
        {
          "html": "<p>\n                  Return null.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>length</var> is null or is not a multiple of 8, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-Pbkdf2Params-iterations\" class=\"internalDFN\" id=\"ref-for-dfn-Pbkdf2Params-iterations-2\"><code>iterations</code></a> member of <var>normalizedAlgorithm</var> is zero,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If <var>length</var> is zero, return an empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>prf</var> be the MAC Generation function described in Section 4 of\n                  [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-fips-198-1\" title=\"The Keyed-Hash Message Authentication Code (HMAC)\">FIPS-198-1</a></cite>] using the hash function\n                  described by the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-Pbkdf2Params-hash\" class=\"internalDFN\" id=\"ref-for-dfn-Pbkdf2Params-hash-2\"><code>hash</code></a> member of\n                  <var>normalizedAlgorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>result</var> be the result of performing the PBKDF2 operation defined\n                  in Section 5.2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://w3c.github.io/webcrypto/#bib-rfc8018\" title=\"PKCS #5: Password-Based Cryptography Specification Version 2.1\">RFC8018</a></cite>] using <var>prf</var> as the\n                  pseudo-random function, <var>PRF</var>, the password represented by the <a data-link-type=\"attribute\" data-lt=\"[[handle]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-handle\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-handle-57\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n                  as the password, <var>P</var>,\n                  the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-Pbkdf2Params-salt\" class=\"internalDFN\" id=\"ref-for-dfn-Pbkdf2Params-salt-2\"><code>salt</code></a> attribute of\n                  <var>normalizedAlgorithm</var> as the salt, <var>S</var>, the value of the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dfn-Pbkdf2Params-iterations\" class=\"internalDFN\" id=\"ref-for-dfn-Pbkdf2Params-iterations-3\"><code>iterations</code></a> attribute of\n                  <var>normalizedAlgorithm</var> as the iteration count, <var>c</var>, and\n                  <var>length</var> divided by 8 as the intended key length, <var>dkLen</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  If the key derivation operation fails,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                  <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>result</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                  If <var>format</var> is not \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyformat-raw\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-29\"><code>raw</code></a>\", <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>\n                </p>"
        },
        {
          "html": "<p>\n                  If <var>usages</var> contains a value that is not\n                  \"<code>deriveKey</code>\"  or \"<code>deriveBits</code>\", then\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  If <var>extractable</var> is not <code>false</code>,\n                  then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>key</var> be a new <a data-link-type=\"idl\" data-lt=\"CryptoKey\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-124\"><code>CryptoKey</code></a>\n                  representing <var>keyData</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[type]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-type\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-type-104\"><code>[[type]]</code></a> internal slot of\n                  <var>key</var> to \"<a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keytype-secret\" class=\"internalDFN\" id=\"ref-for-dom-keytype-secret-17\"><code>secret</code></a>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Let <var>algorithm</var> be a new <a data-link-type=\"idl\" data-lt=\"KeyAlgorithm\" href=\"https://w3c.github.io/webcrypto/#dfn-KeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-KeyAlgorithm-23\"><code>KeyAlgorithm</code></a>\n                  object.\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"idl\" href=\"https://w3c.github.io/webcrypto/#dom-keyalgorithm-name\" class=\"internalDFN\" id=\"ref-for-dom-keyalgorithm-name-65\"><code>name</code></a> attribute of\n                  <var>algorithm</var> to \"<code>PBKDF2</code>\".\n                </p>"
        },
        {
          "html": "<p>\n                  Set the <a data-link-type=\"attribute\" data-lt=\"[[algorithm]]\" href=\"https://w3c.github.io/webcrypto/#dfn-CryptoKey-slot-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-CryptoKey-slot-algorithm-121\"><code>[[algorithm]]</code></a> internal\n                  slot of <var>key</var> to <var>algorithm</var>.\n                </p>"
        },
        {
          "html": "<p>\n                  Return <var>key</var>.\n                </p>"
        }
      ]
    },
    {
      "rationale": "return",
      "steps": [
        {
          "html": "<p>\n                  Return null.\n                </p>"
        }
      ]
    }
  ]
}