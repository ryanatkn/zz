{
  "spec": {
    "title": "Secure Curves in the Web Cryptography API",
    "url": "https://wicg.github.io/webcrypto-secure-curves/"
  },
  "algorithms": [
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot of\n                <var>key</var> is not \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>publicKey</var> be the\n                <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-EcdhKeyDeriveParams-public\"><code>public</code></a> member of\n                <var>normalizedAlgorithm</var>.\n              </p>"
        },
        {
          "html": "<p>\n                If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot of\n                <var>publicKey</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n              </p>"
        },
        {
          "html": "<p>\n                If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a> internal slot of\n                <var>publicKey</var> is not equal to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> property of the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a> internal slot of\n                <var>key</var>, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>secret</var> be the result of performing the X25519 function specified in\n                [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc7748\" title=\"Elliptic Curves for Security\">RFC7748</a></cite>] Section 5 with <var>key</var> as the X25519 private key <var>k</var>\n                and the X25519 public key represented by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">[[handle]]</a>\n                internal slot of <var>publicKey</var> as the X25519 public key <var>u</var>.\n              </p>"
        },
        {
          "html": "<p>\n                If <var>secret</var> is the all-zero value,\n                then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                This check must be performed in constant-time, as per [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc7748\" title=\"Elliptic Curves for Security\">RFC7748</a></cite>] Section 6.1.\n              </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                <dt>If <var>length</var> is null:</dt>\n                <dd>Return <var>secret</var></dd>\n                <dt>Otherwise:</dt>\n                <dd>\n                  <dl class=\"switch\">\n                    <dt>\n                      If the length of <var>secret</var> in bits is less than\n                      <var>length</var>:\n                    </dt>\n                    <dd>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                      <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      Return an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#octet-string-containing\">octet string containing</a> the first <var>length</var> bits of <var>secret</var>.\n                    </dd>\n                  </dl>\n                </dd>\n              </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If length is null:",
                  "html": "Return <var>secret</var>"
                },
                {
                  "case": "Otherwise:",
                  "html": "<dl class=\"switch\">\n                    <dt>\n                      If the length of <var>secret</var> in bits is less than\n                      <var>length</var>:\n                    </dt>\n                    <dd>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                      <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      Return an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#octet-string-containing\">octet string containing</a> the first <var>length</var> bits of <var>secret</var>.\n                    </dd>\n                  </dl>",
                  "rationale": ".switch",
                  "steps": [
                    {
                      "operation": "switch",
                      "steps": [
                        {
                          "case": "If the length of secret in bits is less than length:",
                          "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                      <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>."
                        },
                        {
                          "case": "Otherwise:",
                          "html": "Return an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#octet-string-containing\">octet string containing</a> the first <var>length</var> bits of <var>secret</var>."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                If <var>usages</var> contains an entry which is not\n                \"<code>deriveKey</code>\" or \"<code>deriveBits</code>\"\n                then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n              </p>"
        },
        {
          "html": "<p>\n                Generate an X25519 key pair, with the private key being 32 random bytes,\n                and the public key being <code>X25519(a, 9)</code>,\n                as defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc7748\" title=\"Elliptic Curves for Security\">RFC7748</a></cite>], section 6.1.\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a> object.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                <var>algorithm</var> to \"<code>X25519</code>\".\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>publicKey</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> associated with the\n                <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and\n                representing the public key of the generated key pair.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot of\n                <var>publicKey</var> to \"<code>public</code>\"\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a> internal\n                slot of <var>publicKey</var> to <var>algorithm</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">[[extractable]]</a> internal\n                slot of <var>publicKey</var> to true.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">[[usages]]</a> internal slot of\n                <var>publicKey</var> to be the empty list.\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>privateKey</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> associated with the\n                <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and\n                representing the private key of the generated key pair.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot of\n                <var>privateKey</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\"\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a> internal\n                slot of <var>privateKey</var> to <var>algorithm</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">[[extractable]]</a> internal\n                slot of <var>privateKey</var> to <var>extractable</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">[[usages]]</a> internal slot of\n                <var>privateKey</var> to be the\n                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection\">usage intersection</a> of\n                <var>usages</var> and <code>[ \"deriveKey\", \"deriveBits\" ]</code>.\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>result</var> be a new <a data-link-type=\"dictionary\" data-lt=\"CryptoKeyPair\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair\"><code>CryptoKeyPair</code></a>\n                dictionary.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair-publicKey\"><code>publicKey</code></a> attribute\n                of <var>result</var> to be <var>publicKey</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair-privateKey\"><code>privateKey</code></a> attribute\n                of <var>result</var> to be <var>privateKey</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Return the result of converting <var>result</var> to an ECMAScript Object, as\n                defined by [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>].\n              </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-spki\"><code>spki</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-pkcs8\"><code>pkcs8</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-jwk\"><code>jwk</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-raw\"><code>raw</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>Otherwise:</dt>\n                <dd>\n                  <p>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </p>\n                </dd>\n              </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If <var>usages</var> is not empty\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>spki</var> be the result of running the\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-spki\">parse a subjectPublicKeyInfo</a>\n                        algorithm over <var>keyData</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If an error occurred while parsing,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <code>algorithm</code> object identifier field of the\n                        <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is\n                        not equal to the <code>id-X25519</code>\n                        object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>],\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <code>parameters</code> field of the <code>algorithm</code>\n                        AlgorithmIdentifier field of <var>spki</var> is present,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>publicKey</var> be the X25519 public key identified by\n                        the <code>subjectPublicKey</code> field of <var>spki</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and\n                        that represents <var>publicKey</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> to \"<code>public</code>\"\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                        <var>algorithm</var> to \"<code>X25519</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a>\n                        internal slot of <var>key</var> to <var>algorithm</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If <var>usages</var> contains an entry which is not\n                        \"<code>deriveKey</code>\" or \"<code>deriveBits</code>\"\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>privateKeyInfo</var> be the result of running the\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-privateKeyInfo\">parse a privateKeyInfo</a>\n                        algorithm over <var>keyData</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If an error occurs while parsing,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <code>algorithm</code> object identifier field of the\n                        <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of\n                        <var>privateKeyInfo</var> is not equal to the\n                        <code>id-X25519</code> object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>],\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <code>parameters</code> field of the\n                        <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                        of <var>privateKeyInfo</var> is present,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>curvePrivateKey</var> be the result of performing the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-an-asn1-structure\">parse an ASN.1 structure</a>\n                        algorithm, with <var>data</var> as the <code>privateKey</code> field\n                        of <var>privateKeyInfo</var>, <var>structure</var> as the ASN.1\n                        <code>CurvePrivateKey</code> structure specified in Section 7 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>], and <var>exactData</var> set to true.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If an error occurred while parsing,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and\n                        that represents the X25519 private key identified by <var>curvePrivateKey</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\"\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                        <var>algorithm</var> to \"<code>X25519</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a>\n                        internal slot of <var>key</var> to <var>algorithm</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                        <dt>If <var>keyData</var> is a <a data-link-type=\"dictionary\" data-lt=\"JsonWebKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey\"><code>JsonWebKey</code></a> dictionary:</dt>\n                        <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                        <dt>Otherwise:</dt>\n                        <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                      </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-d\"><code>d</code></a> field is present and if <var>usages</var>\n                        contains an entry which is not\n                        \"<code>deriveKey</code>\" or \"<code>deriveBits</code>\"\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-d\"><code>d</code></a> field is not present and if <var>usages</var> is not\n                        empty\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-kty\"><code>kty</code></a> field of <var>jwk</var> is not\n                        \"<code>OKP</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-crv\"><code>crv</code></a> field of <var>jwk</var> is not\n                        \"<code>X25519</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If <var>usages</var> is non-empty and the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-use\"><code>use</code></a> field of <var>jwk</var> is present\n                        and is not equal to \"<code>enc</code>\" then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-key_ops\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                        is invalid according to the requirements of JSON Web\n                        Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>], or it does not contain all of the specified <var>usages</var>\n                        values,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-ext\"><code>ext</code></a> field of <var>jwk</var> is present and\n                        has the value false and <var>extractable</var> is true,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                        <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-d\"><code>d</code></a> field is present:</dt>\n                        <dd>\n                          \n                        </dd>\n                        <dt>Otherwise:</dt>\n                        <dd>\n                          \n                        </dd>\n                      </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the d field is present:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                If <var>jwk</var> does not meet the requirements of\n                                the JWK private key format described in Section 2\n                                of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>], then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                              </p>"
                                },
                                {
                                  "html": "<p>\n                                Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> object that represents the\n                                X25519 private key identified by interpreting\n                                <var>jwk</var> according to Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                              </p>"
                                },
                                {
                                  "html": "<p>\n                                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a>\n                                internal slot of <var>Key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\".\n                              </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                If <var>jwk</var> does not meet the requirements of\n                                the JWK public key format described in Section 2\n                                of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>], then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                              </p>"
                                },
                                {
                                  "html": "<p>\n                                Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> object that represents the\n                                X25519 public key identified by interpreting\n                                <var>jwk</var> according to Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                              </p>"
                                },
                                {
                                  "html": "<p>\n                                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a>\n                                internal slot of <var>Key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-public\"><code>public</code></a>\".\n                              </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                        Let <var>algorithm</var> be a new instance of a <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a> object.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                        <var>algorithm</var> to \"<code>X25519</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a>\n                        internal slot of <var>key</var> to <var>algorithm</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If <var>usages</var> is not empty\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>data</var> be <var>keyData</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-length-in-bits\">length in bits</a> of <var>data</var> is not 256 then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a> object.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                        <var>algorithm</var> to \"<code>X25519</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and that represents <var>data</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> to \"<code>public</code>\"\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a>\n                        internal slot of <var>key</var> to <var>algorithm</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                Return <var>key</var>\n              </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                Let <var>key</var> be the <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> to be\n                exported.\n              </p>"
        },
        {
          "html": "<p>\n                If the underlying cryptographic key material represented by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">[[handle]]</a> internal slot of <var>key</var>\n                cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n              </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-spki\"><code>spki</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-pkcs8\"><code>pkcs8</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-jwk\"><code>jwk</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>\n                  If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-raw\"><code>raw</code></a>\":\n                </dt>\n                <dd>\n                  \n                </dd>\n                <dt>Otherwise:</dt>\n                <dd>\n                  <p>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </p>\n                </dd>\n              </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>data</var> be an instance of the <code>subjectPublicKeyInfo</code>\n                        ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc5280\" title=\"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile\">RFC5280</a></cite>]\n                        with the following properties:\n                      </p>\n                      <ul>\n                        <li>\n                          <p>\n                            Set the <var>algorithm</var> field to an\n                            <code>AlgorithmIdentifier</code> ASN.1 type with the following\n                            properties:\n                          </p>\n                          <ul>\n                            <li>\n                              <p>\n                                Set the <var>algorithm</var> object identifier to the\n                                <code>id-X25519</code> OID defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>].\n                              </p>\n                            </li>\n                          </ul>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <var>subjectPublicKey</var> field to <var>keyData</var>.\n                          </p>\n                        </li>\n                      </ul>"
                    },
                    {
                      "html": "<p>\n                        Let <var>result</var> be a new <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and containing\n                        <var>data</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> is not \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>data</var> be an instance of the <code>privateKeyInfo</code>\n                        ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc5208\" title=\"Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2\">RFC5208</a></cite>]\n                        with the following properties:\n                      </p>\n                      <ul>\n                        <li>\n                          <p>\n                            Set the <var>version</var> field to <code>0</code>.\n                          </p>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <var>privateKeyAlgorithm</var> field to a\n                            <code>PrivateKeyAlgorithmIdentifier</code> ASN.1 type with the\n                            following properties:\n                          </p>\n                          <ul>\n                            <li>\n                              <p>\n                                Set the <var>algorithm</var> object identifier to the\n                                <code>id-X25519</code> OID defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>].\n                              </p>\n                            </li>\n                          </ul>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <var>privateKey</var> field to the result of DER-encoding\n                            a <code>CurvePrivateKey</code> ASN.1 type, as defined in Section 7 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>], that represents the\n                            X25519 private key represented by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">[[handle]]</a> internal slot of\n                            <var>key</var>\n                          </p>\n                        </li>\n                      </ul>"
                    },
                    {
                      "html": "<p>\n                        Let <var>result</var> be a new <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and containing\n                        <var>data</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                        Let <var>jwk</var> be a new <a data-link-type=\"dictionary\" data-lt=\"JsonWebKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey\"><code>JsonWebKey</code></a>\n                        dictionary.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <code>kty</code> attribute of <var>jwk</var> to\n                        \"<code>OKP</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <code>crv</code> attribute of <var>jwk</var> to\n                        \"<code>X25519</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-x\"><code>x</code></a> attribute of <var>jwk</var> according to the\n                        definition in Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                      </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                        <dt>\n                          If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                          of <var>key</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\"\n                        </dt>\n                        <dd>\n                          Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-d\"><code>d</code></a> attribute of <var>jwk</var> according to the\n                          definition in Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                        </dd>\n                      </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the [[type]] internal slot of key is \"private\"",
                              "html": "Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-d\"><code>d</code></a> attribute of <var>jwk</var> according to the\n                          definition in Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>]."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                        Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a data-link-type=\"attribute\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-cryptokey-usages\"><code>usages</code></a> attribute of <var>key</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <code>ext</code> attribute of <var>jwk</var> to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">[[extractable]]</a> internal slot\n                        of <var>key</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>result</var> be the result of converting <var>jwk</var>\n                        to an ECMAScript Object, as defined by [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>].\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>data</var> be an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a> representing the X25519\n                        public key represented by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">[[handle]]</a> internal slot of\n                        <var>key</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>result</var> be a new <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and containing\n                        <var>data</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                Return <var>result</var>.\n              </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot of\n                <var>key</var> is not \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>publicKey</var> be the\n                <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-EcdhKeyDeriveParams-public\"><code>public</code></a> member of\n                <var>normalizedAlgorithm</var>.\n              </p>"
        },
        {
          "html": "<p>\n                If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot of\n                <var>publicKey</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n              </p>"
        },
        {
          "html": "<p>\n                If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a> internal slot of\n                <var>publicKey</var> is not equal to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> property of the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a> internal slot of\n                <var>key</var>, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>secret</var> be the result of performing the X448 function specified in\n                [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc7748\" title=\"Elliptic Curves for Security\">RFC7748</a></cite>] Section 5 with <var>key</var> as the X448 private key <var>k</var>\n                and the X448 public key represented by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">[[handle]]</a>\n                internal slot of <var>publicKey</var> as the X448 public key <var>u</var>.\n              </p>"
        },
        {
          "html": "<p>\n                If <var>secret</var> is the all-zero value,\n                then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                This check must be performed in constant-time, as per [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc7748\" title=\"Elliptic Curves for Security\">RFC7748</a></cite>] Section 6.2.\n              </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                <dt>If <var>length</var> is null:</dt>\n                <dd>Return <var>secret</var></dd>\n                <dt>Otherwise:</dt>\n                <dd>\n                  <dl class=\"switch\">\n                    <dt>\n                      If the length of <var>secret</var> in bits is less than\n                      <var>length</var>:\n                    </dt>\n                    <dd>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                      <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      Return an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#octet-string-containing\">octet string containing</a> the first <var>length</var> bits of <var>secret</var>.\n                    </dd>\n                  </dl>\n                </dd>\n              </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If length is null:",
                  "html": "Return <var>secret</var>"
                },
                {
                  "case": "Otherwise:",
                  "html": "<dl class=\"switch\">\n                    <dt>\n                      If the length of <var>secret</var> in bits is less than\n                      <var>length</var>:\n                    </dt>\n                    <dd>\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                      <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n                    </dd>\n                    <dt>Otherwise:</dt>\n                    <dd>\n                      Return an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#octet-string-containing\">octet string containing</a> the first <var>length</var> bits of <var>secret</var>.\n                    </dd>\n                  </dl>",
                  "rationale": ".switch",
                  "steps": [
                    {
                      "operation": "switch",
                      "steps": [
                        {
                          "case": "If the length of secret in bits is less than length:",
                          "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                      <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>."
                        },
                        {
                          "case": "Otherwise:",
                          "html": "Return an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#octet-string-containing\">octet string containing</a> the first <var>length</var> bits of <var>secret</var>."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                If <var>usages</var> contains an entry which is not\n                \"<code>deriveKey</code>\" or \"<code>deriveBits</code>\"\n                then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n              </p>"
        },
        {
          "html": "<p>\n                Generate an X448 key pair, with the private key being 56 random bytes,\n                and the public key being <code>X448(a, 5)</code>,\n                as defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc7748\" title=\"Elliptic Curves for Security\">RFC7748</a></cite>], section 6.2.\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a> object.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                <var>algorithm</var> to \"<code>X448</code>\".\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>publicKey</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> associated with the\n                <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and\n                representing the public key of the generated key pair.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot of\n                <var>publicKey</var> to \"<code>public</code>\"\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a> internal\n                slot of <var>publicKey</var> to <var>algorithm</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">[[extractable]]</a> internal\n                slot of <var>publicKey</var> to true.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">[[usages]]</a> internal slot of\n                <var>publicKey</var> to be the empty list.\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>privateKey</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> associated with the\n                <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and\n                representing the private key of the generated key pair.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot of\n                <var>privateKey</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\"\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a> internal\n                slot of <var>privateKey</var> to <var>algorithm</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">[[extractable]]</a> internal\n                slot of <var>privateKey</var> to <var>extractable</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">[[usages]]</a> internal slot of\n                <var>privateKey</var> to be the\n                <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection\">usage intersection</a> of\n                <var>usages</var> and <code>[ \"deriveKey\", \"deriveBits\" ]</code>.\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>result</var> be a new <a data-link-type=\"dictionary\" data-lt=\"CryptoKeyPair\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair\"><code>CryptoKeyPair</code></a>\n                dictionary.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair-publicKey\"><code>publicKey</code></a> attribute\n                of <var>result</var> to be <var>publicKey</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair-privateKey\"><code>privateKey</code></a> attribute\n                of <var>result</var> to be <var>privateKey</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Return the result of converting <var>result</var> to an ECMAScript Object, as\n                defined by [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>].\n              </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-spki\"><code>spki</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-pkcs8\"><code>pkcs8</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-jwk\"><code>jwk</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-raw\"><code>raw</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>Otherwise:</dt>\n                <dd>\n                  <p>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </p>\n                </dd>\n              </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If <var>usages</var> is not empty\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>spki</var> be the result of running the\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-spki\">parse a subjectPublicKeyInfo</a>\n                        algorithm over <var>keyData</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If an error occurred while parsing,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <code>algorithm</code> object identifier field of the\n                        <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is\n                        not equal to the <code>id-X448</code>\n                        object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>],\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <code>parameters</code> field of the <code>algorithm</code>\n                        AlgorithmIdentifier field of <var>spki</var> is present,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>publicKey</var> be the X448 public key identified by\n                        the <code>subjectPublicKey</code> field of <var>spki</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and\n                        that represents <var>publicKey</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> to \"<code>public</code>\"\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                        <var>algorithm</var> to \"<code>X448</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a>\n                        internal slot of <var>key</var> to <var>algorithm</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If <var>usages</var> contains an entry which is not\n                        \"<code>deriveKey</code>\" or \"<code>deriveBits</code>\"\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>privateKeyInfo</var> be the result of running the\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-privateKeyInfo\">parse a privateKeyInfo</a>\n                        algorithm over <var>keyData</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If an error occurs while parsing,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <code>algorithm</code> object identifier field of the\n                        <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of\n                        <var>privateKeyInfo</var> is not equal to the\n                        <code>id-X448</code> object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>],\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <code>parameters</code> field of the\n                        <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                        of <var>privateKeyInfo</var> is present,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>curvePrivateKey</var> be the result of performing the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-an-asn1-structure\">parse an ASN.1 structure</a>\n                        algorithm, with <var>data</var> as the <code>privateKey</code> field\n                        of <var>privateKeyInfo</var>, <var>structure</var> as the ASN.1\n                        <code>CurvePrivateKey</code> structure specified in Section 7 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>], and <var>exactData</var> set to true.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If an error occurred while parsing,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and\n                        that represents the X448 private key identified by <var>curvePrivateKey</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\"\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                        <var>algorithm</var> to \"<code>X448</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a>\n                        internal slot of <var>key</var> to <var>algorithm</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                        <dt>If <var>keyData</var> is a <a data-link-type=\"dictionary\" data-lt=\"JsonWebKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey\"><code>JsonWebKey</code></a> dictionary:</dt>\n                        <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                        <dt>Otherwise:</dt>\n                        <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                      </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-d\"><code>d</code></a> field is present and if <var>usages</var>\n                        contains an entry which is not\n                        \"<code>deriveKey</code>\" or \"<code>deriveBits</code>\"\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-d\"><code>d</code></a> field is not present and if <var>usages</var> is not\n                        empty\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-kty\"><code>kty</code></a> field of <var>jwk</var> is not\n                        \"<code>OKP</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-crv\"><code>crv</code></a> field of <var>jwk</var> is not\n                        \"<code>X448</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If <var>usages</var> is non-empty and the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-use\"><code>use</code></a> field of <var>jwk</var> is present\n                        and is not equal to \"<code>enc</code>\" then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-key_ops\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                        is invalid according to the requirements of JSON Web\n                        Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>], or it does not contain all of the specified <var>usages</var>\n                        values,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-ext\"><code>ext</code></a> field of <var>jwk</var> is present and\n                        has the value false and <var>extractable</var> is true,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                        <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-d\"><code>d</code></a> field is present:</dt>\n                        <dd>\n                          \n                        </dd>\n                        <dt>Otherwise:</dt>\n                        <dd>\n                          \n                        </dd>\n                      </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the d field is present:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                If <var>jwk</var> does not meet the requirements of\n                                the JWK private key format described in Section 2\n                                of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>], then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                              </p>"
                                },
                                {
                                  "html": "<p>\n                                Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> object that represents the\n                                X448 private key identified by interpreting\n                                <var>jwk</var> according to Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                              </p>"
                                },
                                {
                                  "html": "<p>\n                                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a>\n                                internal slot of <var>Key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\".\n                              </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                If <var>jwk</var> does not meet the requirements of\n                                the JWK public key format described in Section 2\n                                of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>], then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                              </p>"
                                },
                                {
                                  "html": "<p>\n                                Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> object that represents the\n                                X448 public key identified by interpreting\n                                <var>jwk</var> according to Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                              </p>"
                                },
                                {
                                  "html": "<p>\n                                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a>\n                                internal slot of <var>Key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-public\"><code>public</code></a>\".\n                              </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                        Let <var>algorithm</var> be a new instance of a <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a> object.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                        <var>algorithm</var> to \"<code>X448</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a>\n                        internal slot of <var>key</var> to <var>algorithm</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If <var>usages</var> is not empty\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>data</var> be <var>keyData</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-length-in-bits\">length in bits</a> of <var>data</var> is not 448 then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a> object.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                        <var>algorithm</var> to \"<code>X448</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and that represents <var>data</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> to \"<code>public</code>\"\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a>\n                        internal slot of <var>key</var> to <var>algorithm</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                Return <var>key</var>\n              </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                Let <var>key</var> be the <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> to be\n                exported.\n              </p>"
        },
        {
          "html": "<p>\n                If the underlying cryptographic key material represented by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">[[handle]]</a> internal slot of <var>key</var>\n                cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n              </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-spki\"><code>spki</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-pkcs8\"><code>pkcs8</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-jwk\"><code>jwk</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>\n                  If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-raw\"><code>raw</code></a>\":\n                </dt>\n                <dd>\n                  \n                </dd>\n                <dt>Otherwise:</dt>\n                <dd>\n                  <p>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </p>\n                </dd>\n              </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>data</var> be an instance of the <code>subjectPublicKeyInfo</code>\n                        ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc5280\" title=\"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile\">RFC5280</a></cite>]\n                        with the following properties:\n                      </p>\n                      <ul>\n                        <li>\n                          <p>\n                            Set the <var>algorithm</var> field to an\n                            <code>AlgorithmIdentifier</code> ASN.1 type with the following\n                            properties:\n                          </p>\n                          <ul>\n                            <li>\n                              <p>\n                                Set the <var>algorithm</var> object identifier to the\n                                <code>id-X448</code> OID defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>].\n                              </p>\n                            </li>\n                          </ul>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <var>subjectPublicKey</var> field to <var>keyData</var>.\n                          </p>\n                        </li>\n                      </ul>"
                    },
                    {
                      "html": "<p>\n                        Let <var>result</var> be a new <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and containing\n                        <var>data</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> is not \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>data</var> be an instance of the <code>privateKeyInfo</code>\n                        ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc5208\" title=\"Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2\">RFC5208</a></cite>]\n                        with the following properties:\n                      </p>\n                      <ul>\n                        <li>\n                          <p>\n                            Set the <var>version</var> field to <code>0</code>.\n                          </p>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <var>privateKeyAlgorithm</var> field to a\n                            <code>PrivateKeyAlgorithmIdentifier</code> ASN.1 type with the\n                            following properties:\n                          </p>\n                          <ul>\n                            <li>\n                              <p>\n                                Set the <var>algorithm</var> object identifier to the\n                                <code>id-X448</code> OID defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>].\n                              </p>\n                            </li>\n                          </ul>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <var>privateKey</var> field to the result of DER-encoding\n                            a <code>CurvePrivateKey</code> ASN.1 type, as defined in Section 7 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>], that represents the\n                            X448 private key represented by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">[[handle]]</a> internal slot of\n                            <var>key</var>\n                          </p>\n                        </li>\n                      </ul>"
                    },
                    {
                      "html": "<p>\n                        Let <var>result</var> be a new <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and containing\n                        <var>data</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                        Let <var>jwk</var> be a new <a data-link-type=\"dictionary\" data-lt=\"JsonWebKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey\"><code>JsonWebKey</code></a>\n                        dictionary.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <code>kty</code> attribute of <var>jwk</var> to\n                        \"<code>OKP</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <code>crv</code> attribute of <var>jwk</var> to\n                        \"<code>X448</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-x\"><code>x</code></a> attribute of <var>jwk</var> according to the\n                        definition in Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                      </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                        <dt>\n                          If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                          of <var>key</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\"\n                        </dt>\n                        <dd>\n                          Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-d\"><code>d</code></a> attribute of <var>jwk</var> according to the\n                          definition in Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                        </dd>\n                      </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the [[type]] internal slot of key is \"private\"",
                              "html": "Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-d\"><code>d</code></a> attribute of <var>jwk</var> according to the\n                          definition in Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>]."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                        Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a data-link-type=\"attribute\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-cryptokey-usages\"><code>usages</code></a> attribute of <var>key</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <code>ext</code> attribute of <var>jwk</var> to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">[[extractable]]</a> internal slot\n                        of <var>key</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>result</var> be the result of converting <var>jwk</var>\n                        to an ECMAScript Object, as defined by [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>].\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>data</var> be an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a> representing the X448\n                        public key represented by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">[[handle]]</a> internal slot of\n                        <var>key</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>result</var> be a new <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and containing\n                        <var>data</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                Return <var>result</var>.\n              </p>"
        }
      ]
    },
    {
      "html": "When signing, the following algorithm should be used:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot of\n                <var>key</var> is not \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n              </p>"
        },
        {
          "html": "<p>\n                Perform the Ed25519 signing process, as specified in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8032\" title=\"Edwards-Curve Digital Signature Algorithm (EdDSA)\">RFC8032</a></cite>],\n                Section 5.1.6, with <var>message</var> as <var>M</var>,\n                using the Ed25519 private key associated with <var>key</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Return a new <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a> associated with the\n                <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and containing the\n                bytes of the signature resulting from performing\n                the Ed25519 signing process.\n              </p>"
        }
      ]
    },
    {
      "html": "When verifying, the following algorithm should be used:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot of\n                <var>key</var> is not \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-public\"><code>public</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n              </p>"
        },
        {
          "html": "<p>\n                If the key data of <var>key</var> represents an invalid point or a small-order element\n                on the Elliptic Curve of Ed25519, return <code>false</code>.\n              </p>"
        },
        {
          "html": "<p>\n                If the point R, encoded in the first half of <var>signature</var>,\n                represents an invalid point or a small-order element\n                on the Elliptic Curve of Ed25519, return <code>false</code>.\n              </p>"
        },
        {
          "html": "<p>\n                Perform the Ed25519 verification steps, as specified in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8032\" title=\"Edwards-Curve Digital Signature Algorithm (EdDSA)\">RFC8032</a></cite>],\n                Section 5.1.7, using the cofactorless (unbatched) equation,\n                <code>[S]B = R + [k]A'</code>, on the <var>signature</var>, with <var>message</var> as <var>M</var>,\n                using the Ed25519 public key associated with <var>key</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>result</var> be a boolean with the value <code>true</code> if the signature is valid\n                and the value <code>false</code> otherwise.\n              </p>"
        },
        {
          "html": "<p>\n                Return <var>result</var>.\n              </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                If <var>usages</var> contains a value which is not\n                one of \"<code>sign</code>\" or \"<code>verify</code>\",\n                then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n              </p>"
        },
        {
          "html": "<p>\n                Generate an Ed25519 key pair, as defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8032\" title=\"Edwards-Curve Digital Signature Algorithm (EdDSA)\">RFC8032</a></cite>], section 5.1.5.\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a> object.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                <var>algorithm</var> to \"<code>Ed25519</code>\".\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>publicKey</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> associated with the\n                <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and\n                representing the public key of the generated key pair.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot of\n                <var>publicKey</var> to \"<code>public</code>\"\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a> internal\n                slot of <var>publicKey</var> to <var>algorithm</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">[[extractable]]</a> internal\n                slot of <var>publicKey</var> to true.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">[[usages]]</a> internal slot of\n                <var>publicKey</var> to be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection\">usage intersection</a>\n                of <var>usages</var> and <code>[ \"verify\" ]</code>.\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>privateKey</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> associated with the\n                <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and\n                representing the private key of the generated key pair.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot of\n                <var>privateKey</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\"\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a> internal\n                slot of <var>privateKey</var> to <var>algorithm</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">[[extractable]]</a> internal\n                slot of <var>privateKey</var> to <var>extractable</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">[[usages]]</a> internal slot of\n                <var>privateKey</var> to be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection\">usage intersection</a>\n                of <var>usages</var> and <code>[ \"sign\" ]</code>.\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>result</var> be a new <a data-link-type=\"dictionary\" data-lt=\"CryptoKeyPair\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair\"><code>CryptoKeyPair</code></a>\n                dictionary.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair-publicKey\"><code>publicKey</code></a> attribute\n                of <var>result</var> to be <var>publicKey</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair-privateKey\"><code>privateKey</code></a> attribute\n                of <var>result</var> to be <var>privateKey</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Return the result of converting <var>result</var> to an ECMAScript Object, as\n                defined by [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>].\n              </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-spki\"><code>spki</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-pkcs8\"><code>pkcs8</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-jwk\"><code>jwk</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-raw\"><code>raw</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>Otherwise:</dt>\n                <dd>\n                  <p>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </p>\n                </dd>\n              </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If <var>usages</var> contains a value which is not\n                        \"<code>verify</code>\"\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>spki</var> be the result of running the\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-spki\">parse a subjectPublicKeyInfo</a>\n                        algorithm over <var>keyData</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If an error occurred while parsing,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <code>algorithm</code> object identifier field of the\n                        <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is\n                        not equal to the <code>id-Ed25519</code>\n                        object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>],\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <code>parameters</code> field of the <code>algorithm</code>\n                        AlgorithmIdentifier field of <var>spki</var> is present,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>publicKey</var> be the Ed25519 public key identified by\n                        the <code>subjectPublicKey</code> field of <var>spki</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and\n                        that represents <var>publicKey</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> to \"<code>public</code>\"\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                        <var>algorithm</var> to \"<code>Ed25519</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a>\n                        internal slot of <var>key</var> to <var>algorithm</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If <var>usages</var> contains a value which is not\n                        \"<code>sign</code>\"\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>privateKeyInfo</var> be the result of running the\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-privateKeyInfo\">parse a privateKeyInfo</a>\n                        algorithm over <var>keyData</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If an error occurs while parsing,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <code>algorithm</code> object identifier field of the\n                        <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of\n                        <var>privateKeyInfo</var> is not equal to the\n                        <code>id-Ed25519</code> object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>],\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <code>parameters</code> field of the\n                        <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                        of <var>privateKeyInfo</var> is present,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>curvePrivateKey</var> be the result of performing the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-an-asn1-structure\">parse an ASN.1 structure</a>\n                        algorithm, with <var>data</var> as the <code>privateKey</code> field\n                        of <var>privateKeyInfo</var>, <var>structure</var> as the ASN.1\n                        <code>CurvePrivateKey</code> structure specified in Section 7 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>], and <var>exactData</var> set to true.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If an error occurred while parsing,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and\n                        that represents the Ed25519 private key identified by <var>curvePrivateKey</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\"\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                        <var>algorithm</var> to \"<code>Ed25519</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a>\n                        internal slot of <var>key</var> to <var>algorithm</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                        <dt>If <var>keyData</var> is a <a data-link-type=\"dictionary\" data-lt=\"JsonWebKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey\"><code>JsonWebKey</code></a> dictionary:</dt>\n                        <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                        <dt>Otherwise:</dt>\n                        <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                      </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-d\"><code>d</code></a> field is present and <var>usages</var> contains\n                        a value which is not\n                        \"<code>sign</code>\", or,\n                        if the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-d\"><code>d</code></a> field is not present and <var>usages</var> contains\n                        a value which is not\n                        \"<code>verify</code>\"\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-kty\"><code>kty</code></a> field of <var>jwk</var> is not\n                        \"<code>OKP</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-crv\"><code>crv</code></a> field of <var>jwk</var> is not\n                        \"<code>Ed25519</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-alg\"><code>alg</code></a> field of <var>jwk</var> is present and is\n                        not \"<code>Ed25519</code>\" or \"<code>EdDSA</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If <var>usages</var> is non-empty and the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-use\"><code>use</code></a> field of <var>jwk</var> is present and is\n                        not \"<code>sig</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-key_ops\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                        is invalid according to the requirements of JSON Web\n                        Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>], or it does not contain all of the specified <var>usages</var>\n                        values,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-ext\"><code>ext</code></a> field of <var>jwk</var> is present and\n                        has the value false and <var>extractable</var> is true,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                        <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-d\"><code>d</code></a> field is present:</dt>\n                        <dd>\n                          \n                        </dd>\n                        <dt>Otherwise:</dt>\n                        <dd>\n                          \n                        </dd>\n                      </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the d field is present:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                If <var>jwk</var> does not meet the requirements of\n                                the JWK private key format described in Section 2\n                                of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>], then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                              </p>"
                                },
                                {
                                  "html": "<p>\n                                Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> object that represents the\n                                Ed25519 private key identified by interpreting\n                                <var>jwk</var> according to Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                              </p>"
                                },
                                {
                                  "html": "<p>\n                                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a>\n                                internal slot of <var>Key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\".\n                              </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                If <var>jwk</var> does not meet the requirements of\n                                the JWK public key format described in Section 2\n                                of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>], then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                              </p>"
                                },
                                {
                                  "html": "<p>\n                                Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> object that represents the\n                                Ed25519 public key identified by interpreting\n                                <var>jwk</var> according to Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                              </p>"
                                },
                                {
                                  "html": "<p>\n                                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a>\n                                internal slot of <var>Key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-public\"><code>public</code></a>\".\n                              </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                        Let <var>algorithm</var> be a new instance of a <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a> object.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                        <var>algorithm</var> to \"<code>Ed25519</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a>\n                        internal slot of <var>key</var> to <var>algorithm</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If <var>usages</var> contains a value which is not\n                        \"<code>verify</code>\"\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>data</var> be <var>keyData</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-length-in-bits\">length in bits</a> of <var>data</var> is not 256 then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a> object.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                        <var>algorithm</var> to \"<code>Ed25519</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and that represents <var>data</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> to \"<code>public</code>\"\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a>\n                        internal slot of <var>key</var> to <var>algorithm</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                Return <var>key</var>\n              </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                Let <var>key</var> be the <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> to be\n                exported.\n              </p>"
        },
        {
          "html": "<p>\n                If the underlying cryptographic key material represented by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">[[handle]]</a> internal slot of <var>key</var>\n                cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n              </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-spki\"><code>spki</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-pkcs8\"><code>pkcs8</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-jwk\"><code>jwk</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>\n                  If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-raw\"><code>raw</code></a>\":\n                </dt>\n                <dd>\n                  \n                </dd>\n                <dt>Otherwise:</dt>\n                <dd>\n                  <p>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </p>\n                </dd>\n              </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>data</var> be an instance of the <code>subjectPublicKeyInfo</code>\n                        ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc5280\" title=\"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile\">RFC5280</a></cite>]\n                        with the following properties:\n                      </p>\n                      <ul>\n                        <li>\n                          <p>\n                            Set the <var>algorithm</var> field to an\n                            <code>AlgorithmIdentifier</code> ASN.1 type with the following\n                            properties:\n                          </p>\n                          <ul>\n                            <li>\n                              <p>\n                                Set the <var>algorithm</var> object identifier to the\n                                <code>id-Ed25519</code> OID defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>].\n                              </p>\n                            </li>\n                          </ul>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <var>subjectPublicKey</var> field to <var>keyData</var>.\n                          </p>\n                        </li>\n                      </ul>"
                    },
                    {
                      "html": "<p>\n                        Let <var>result</var> be a new <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and containing\n                        <var>data</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> is not \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>data</var> be an instance of the <code>privateKeyInfo</code>\n                        ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc5208\" title=\"Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2\">RFC5208</a></cite>]\n                        with the following properties:\n                      </p>\n                      <ul>\n                        <li>\n                          <p>\n                            Set the <var>version</var> field to <code>0</code>.\n                          </p>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <var>privateKeyAlgorithm</var> field to a\n                            <code>PrivateKeyAlgorithmIdentifier</code> ASN.1 type with the\n                            following properties:\n                          </p>\n                          <ul>\n                            <li>\n                              <p>\n                                Set the <var>algorithm</var> object identifier to the\n                                <code>id-Ed25519</code> OID defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>].\n                              </p>\n                            </li>\n                          </ul>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <var>privateKey</var> field to the result of DER-encoding\n                            a <code>CurvePrivateKey</code> ASN.1 type, as defined in Section 7 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>], that represents the\n                            Ed25519 private key represented by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">[[handle]]</a> internal slot of\n                            <var>key</var>\n                          </p>\n                        </li>\n                      </ul>"
                    },
                    {
                      "html": "<p>\n                        Let <var>result</var> be a new <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and containing\n                        <var>data</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                        Let <var>jwk</var> be a new <a data-link-type=\"dictionary\" data-lt=\"JsonWebKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey\"><code>JsonWebKey</code></a>\n                        dictionary.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <code>kty</code> attribute of <var>jwk</var> to\n                        \"<code>OKP</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <code>alg</code> attribute of <var>jwk</var> to\n                        \"<code>Ed25519</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <code>crv</code> attribute of <var>jwk</var> to\n                        \"<code>Ed25519</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-x\"><code>x</code></a> attribute of <var>jwk</var> according to the\n                        definition in Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                      </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                        <dt>\n                          If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                          of <var>key</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\"\n                        </dt>\n                        <dd>\n                          Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-d\"><code>d</code></a> attribute of <var>jwk</var> according to the\n                          definition in Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                        </dd>\n                      </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the [[type]] internal slot of key is \"private\"",
                              "html": "Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-d\"><code>d</code></a> attribute of <var>jwk</var> according to the\n                          definition in Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>]."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                        Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a data-link-type=\"attribute\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-cryptokey-usages\"><code>usages</code></a> attribute of <var>key</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <code>ext</code> attribute of <var>jwk</var> to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">[[extractable]]</a> internal slot\n                        of <var>key</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>result</var> be the result of converting <var>jwk</var>\n                        to an ECMAScript Object, as defined by [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>].\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>data</var> be an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a> representing the Ed25519\n                        public key represented by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">[[handle]]</a> internal slot of\n                        <var>key</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>result</var> be a new <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and containing\n                        <var>data</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                Return <var>result</var>.\n              </p>"
        }
      ]
    },
    {
      "html": "When signing, the following algorithm should be used:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot of\n                <var>key</var> is not \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>context</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">contents of</a>\n                the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-secure-curves/#dfn-Ed448Params-context\" class=\"internalDFN\" id=\"ref-for-dfn-Ed448Params-context-2\"><code>context</code></a> member of <var>normalizedAlgorithm</var>\n                or the empty octet string if the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-secure-curves/#dfn-Ed448Params-context\" class=\"internalDFN\" id=\"ref-for-dfn-Ed448Params-context-3\"><code>context</code></a> member of\n                <var>normalizedAlgorithm</var> is not present.\n              </p>"
        },
        {
          "html": "<p>\n                If <var>context</var> has a length greater than 255 bytes,\n                then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n              </p>"
        },
        {
          "html": "<p>\n                Perform the Ed448 signing process, as specified in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8032\" title=\"Edwards-Curve Digital Signature Algorithm (EdDSA)\">RFC8032</a></cite>],\n                Section 5.2.6, with <var>message</var> as <var>M</var>\n                and <var>context</var> as <var>C</var>,\n                using the Ed448 private key associated with <var>key</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Return a new <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a> associated with the\n                <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and containing the\n                bytes of the signature resulting from performing\n                the Ed448 signing process.\n              </p>"
        }
      ]
    },
    {
      "html": "When verifying, the following algorithm should be used:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot of\n                <var>key</var> is not \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-public\"><code>public</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>context</var> be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-contents-of-arraybuffer\">contents of</a>\n                the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-secure-curves/#dfn-Ed448Params-context\" class=\"internalDFN\" id=\"ref-for-dfn-Ed448Params-context-4\"><code>context</code></a> member of <var>normalizedAlgorithm</var>\n                or the empty octet string if the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-secure-curves/#dfn-Ed448Params-context\" class=\"internalDFN\" id=\"ref-for-dfn-Ed448Params-context-5\"><code>context</code></a> member of\n                <var>normalizedAlgorithm</var> is not present.\n              </p>"
        },
        {
          "html": "<p>\n                If <var>context</var> has a length greater than 255 bytes,\n                then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n              </p>"
        },
        {
          "html": "<p>\n                If the key data of <var>key</var> represents an invalid point or a small-order element\n                on the Elliptic Curve of Ed448, return <code>false</code>.\n              </p>"
        },
        {
          "html": "<p>\n                If the point R, encoded in the first half of <var>signature</var>,\n                represents an invalid point or a small-order element\n                on the Elliptic Curve of Ed448, return <code>false</code>.\n              </p>"
        },
        {
          "html": "<p>\n                Perform the Ed448 verification steps, as specified in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8032\" title=\"Edwards-Curve Digital Signature Algorithm (EdDSA)\">RFC8032</a></cite>],\n                Section 5.2.7, using the cofactorless (unbatched) equation,\n                <code>[S]B = R + [k]A'</code>, on the <var>signature</var>, with <var>message</var> as <var>M</var>\n                and <var>context</var> as <var>C</var>,\n                using the Ed448 public key associated with <var>key</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>result</var> be a boolean with the value <code>true</code> if the signature is valid\n                and the value <code>false</code> otherwise.\n              </p>"
        },
        {
          "html": "<p>\n                Return <var>result</var>.\n              </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n                If <var>usages</var> contains a value which is not\n                one of \"<code>sign</code>\" or \"<code>verify</code>\",\n                then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n              </p>"
        },
        {
          "html": "<p>\n                Generate an Ed448 key pair, as defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8032\" title=\"Edwards-Curve Digital Signature Algorithm (EdDSA)\">RFC8032</a></cite>], section 5.1.5.\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a> object.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                <var>algorithm</var> to \"<code>Ed448</code>\".\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>publicKey</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> associated with the\n                <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and\n                representing the public key of the generated key pair.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot of\n                <var>publicKey</var> to \"<code>public</code>\"\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a> internal\n                slot of <var>publicKey</var> to <var>algorithm</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">[[extractable]]</a> internal\n                slot of <var>publicKey</var> to true.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">[[usages]]</a> internal slot of\n                <var>publicKey</var> to be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection\">usage intersection</a>\n                of <var>usages</var> and <code>[ \"verify\" ]</code>.\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>privateKey</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> associated with the\n                <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and\n                representing the private key of the generated key pair.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot of\n                <var>privateKey</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\"\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a> internal\n                slot of <var>privateKey</var> to <var>algorithm</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">[[extractable]]</a> internal\n                slot of <var>privateKey</var> to <var>extractable</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-usages\">[[usages]]</a> internal slot of\n                <var>privateKey</var> to be the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-usage-intersection\">usage intersection</a>\n                of <var>usages</var> and <code>[ \"sign\" ]</code>.\n              </p>"
        },
        {
          "html": "<p>\n                Let <var>result</var> be a new <a data-link-type=\"dictionary\" data-lt=\"CryptoKeyPair\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair\"><code>CryptoKeyPair</code></a>\n                dictionary.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair-publicKey\"><code>publicKey</code></a> attribute\n                of <var>result</var> to be <var>publicKey</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair-privateKey\"><code>privateKey</code></a> attribute\n                of <var>result</var> to be <var>privateKey</var>.\n              </p>"
        },
        {
          "html": "<p>\n                Return the result of converting <var>result</var> to an ECMAScript Object, as\n                defined by [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>].\n              </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-spki\"><code>spki</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-pkcs8\"><code>pkcs8</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-jwk\"><code>jwk</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-raw\"><code>raw</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>Otherwise:</dt>\n                <dd>\n                  <p>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </p>\n                </dd>\n              </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If <var>usages</var> contains a value which is not\n                        \"<code>verify</code>\"\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>spki</var> be the result of running the\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-spki\">parse a subjectPublicKeyInfo</a>\n                        algorithm over <var>keyData</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If an error occurred while parsing,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <code>algorithm</code> object identifier field of the\n                        <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is\n                        not equal to the <code>id-Ed448</code>\n                        object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>],\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <code>parameters</code> field of the <code>algorithm</code>\n                        AlgorithmIdentifier field of <var>spki</var> is present,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>publicKey</var> be the Ed448 public key identified by\n                        the <code>subjectPublicKey</code> field of <var>spki</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and\n                        that represents <var>publicKey</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> to \"<code>public</code>\"\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                        <var>algorithm</var> to \"<code>Ed448</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a>\n                        internal slot of <var>key</var> to <var>algorithm</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If <var>usages</var> contains a value which is not\n                        \"<code>sign</code>\"\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>privateKeyInfo</var> be the result of running the\n                        <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-a-privateKeyInfo\">parse a privateKeyInfo</a>\n                        algorithm over <var>keyData</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If an error occurs while parsing,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <code>algorithm</code> object identifier field of the\n                        <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of\n                        <var>privateKeyInfo</var> is not equal to the\n                        <code>id-Ed448</code> object identifier defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>],\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <code>parameters</code> field of the\n                        <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                        of <var>privateKeyInfo</var> is present,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>curvePrivateKey</var> be the result of performing the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#concept-parse-an-asn1-structure\">parse an ASN.1 structure</a>\n                        algorithm, with <var>data</var> as the <code>privateKey</code> field\n                        of <var>privateKeyInfo</var>, <var>structure</var> as the ASN.1\n                        <code>CurvePrivateKey</code> structure specified in Section 7 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>], and <var>exactData</var> set to true.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If an error occurred while parsing,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and\n                        that represents the Ed448 private key identified by <var>curvePrivateKey</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\"\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                        <var>algorithm</var> to \"<code>Ed448</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a>\n                        internal slot of <var>key</var> to <var>algorithm</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                        <dt>If <var>keyData</var> is a <a data-link-type=\"dictionary\" data-lt=\"JsonWebKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey\"><code>JsonWebKey</code></a> dictionary:</dt>\n                        <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                        <dt>Otherwise:</dt>\n                        <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                      </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-d\"><code>d</code></a> field is present and <var>usages</var> contains\n                        a value which is not\n                        \"<code>sign</code>\", or,\n                        if the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-d\"><code>d</code></a> field is not present and <var>usages</var> contains\n                        a value which is not\n                        \"<code>verify</code>\"\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-kty\"><code>kty</code></a> field of <var>jwk</var> is not\n                        \"<code>OKP</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-crv\"><code>crv</code></a> field of <var>jwk</var> is not\n                        \"<code>Ed448</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-alg\"><code>alg</code></a> field of <var>jwk</var> is present and is\n                        not \"<code>Ed448</code>\" or \"<code>EdDSA</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If <var>usages</var> is non-empty and the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-use\"><code>use</code></a> field of <var>jwk</var> is present and is\n                        not \"<code>sig</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-key_ops\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                        is invalid according to the requirements of JSON Web\n                        Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>], or it does not contain all of the specified <var>usages</var>\n                        values,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-ext\"><code>ext</code></a> field of <var>jwk</var> is present and\n                        has the value false and <var>extractable</var> is true,\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                        <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-d\"><code>d</code></a> field is present:</dt>\n                        <dd>\n                          \n                        </dd>\n                        <dt>Otherwise:</dt>\n                        <dd>\n                          \n                        </dd>\n                      </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the d field is present:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                If <var>jwk</var> does not meet the requirements of\n                                the JWK private key format described in Section 2\n                                of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>], then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                              </p>"
                                },
                                {
                                  "html": "<p>\n                                Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> object that represents the\n                                Ed448 private key identified by interpreting\n                                <var>jwk</var> according to Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                              </p>"
                                },
                                {
                                  "html": "<p>\n                                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a>\n                                internal slot of <var>Key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\".\n                              </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                                If <var>jwk</var> does not meet the requirements of\n                                the JWK public key format described in Section 2\n                                of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>], then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                              </p>"
                                },
                                {
                                  "html": "<p>\n                                Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> object that represents the\n                                Ed448 public key identified by interpreting\n                                <var>jwk</var> according to Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                              </p>"
                                },
                                {
                                  "html": "<p>\n                                Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a>\n                                internal slot of <var>Key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-public\"><code>public</code></a>\".\n                              </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                        Let <var>algorithm</var> be a new instance of a <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a> object.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                        <var>algorithm</var> to \"<code>Ed448</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a>\n                        internal slot of <var>key</var> to <var>algorithm</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If <var>usages</var> contains a value which is not\n                        \"<code>verify</code>\"\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>data</var> be <var>keyData</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-length-in-bits\">length in bits</a> of <var>data</var> is not 448 then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a> object.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                        <var>algorithm</var> to \"<code>Ed448</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and that represents <var>data</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> to \"<code>public</code>\"\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-algorithm\">[[algorithm]]</a>\n                        internal slot of <var>key</var> to <var>algorithm</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                Return <var>key</var>\n              </p>"
        }
      ]
    },
    {
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n                Let <var>key</var> be the <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> to be\n                exported.\n              </p>"
        },
        {
          "html": "<p>\n                If the underlying cryptographic key material represented by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">[[handle]]</a> internal slot of <var>key</var>\n                cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n              </p>"
        },
        {
          "html": "<dl class=\"switch\">\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-spki\"><code>spki</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-pkcs8\"><code>pkcs8</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-jwk\"><code>jwk</code></a>\":</dt>\n                <dd>\n                  \n                </dd>\n                <dt>\n                  If <var>format</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyformat-raw\"><code>raw</code></a>\":\n                </dt>\n                <dd>\n                  \n                </dd>\n                <dt>Otherwise:</dt>\n                <dd>\n                  <p>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </p>\n                </dd>\n              </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>data</var> be an instance of the <code>subjectPublicKeyInfo</code>\n                        ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc5280\" title=\"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile\">RFC5280</a></cite>]\n                        with the following properties:\n                      </p>\n                      <ul>\n                        <li>\n                          <p>\n                            Set the <var>algorithm</var> field to an\n                            <code>AlgorithmIdentifier</code> ASN.1 type with the following\n                            properties:\n                          </p>\n                          <ul>\n                            <li>\n                              <p>\n                                Set the <var>algorithm</var> object identifier to the\n                                <code>id-Ed448</code> OID defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>].\n                              </p>\n                            </li>\n                          </ul>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <var>subjectPublicKey</var> field to <var>keyData</var>.\n                          </p>\n                        </li>\n                      </ul>"
                    },
                    {
                      "html": "<p>\n                        Let <var>result</var> be a new <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and containing\n                        <var>data</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> is not \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>data</var> be an instance of the <code>privateKeyInfo</code>\n                        ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc5208\" title=\"Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2\">RFC5208</a></cite>]\n                        with the following properties:\n                      </p>\n                      <ul>\n                        <li>\n                          <p>\n                            Set the <var>version</var> field to <code>0</code>.\n                          </p>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <var>privateKeyAlgorithm</var> field to a\n                            <code>PrivateKeyAlgorithmIdentifier</code> ASN.1 type with the\n                            following properties:\n                          </p>\n                          <ul>\n                            <li>\n                              <p>\n                                Set the <var>algorithm</var> object identifier to the\n                                <code>id-Ed448</code> OID defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>].\n                              </p>\n                            </li>\n                          </ul>\n                        </li>\n                        <li>\n                          <p>\n                            Set the <var>privateKey</var> field to the result of DER-encoding\n                            a <code>CurvePrivateKey</code> ASN.1 type, as defined in Section 7 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8410\" title=\"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure\">RFC8410</a></cite>], that represents the\n                            Ed448 private key represented by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">[[handle]]</a> internal slot of\n                            <var>key</var>\n                          </p>\n                        </li>\n                      </ul>"
                    },
                    {
                      "html": "<p>\n                        Let <var>result</var> be a new <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and containing\n                        <var>data</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                        Let <var>jwk</var> be a new <a data-link-type=\"dictionary\" data-lt=\"JsonWebKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey\"><code>JsonWebKey</code></a>\n                        dictionary.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <code>kty</code> attribute of <var>jwk</var> to\n                        \"<code>OKP</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <code>alg</code> attribute of <var>jwk</var> to\n                        \"<code>Ed448</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <code>crv</code> attribute of <var>jwk</var> to\n                        \"<code>Ed448</code>\".\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-x\"><code>x</code></a> attribute of <var>jwk</var> according to the\n                        definition in Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                      </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                        <dt>\n                          If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                          of <var>key</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\"\n                        </dt>\n                        <dd>\n                          Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-d\"><code>d</code></a> attribute of <var>jwk</var> according to the\n                          definition in Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>].\n                        </dd>\n                      </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the [[type]] internal slot of key is \"private\"",
                              "html": "Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-d\"><code>d</code></a> attribute of <var>jwk</var> according to the\n                          definition in Section 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-rfc8037\" title=\"CFRG Elliptic Curve Diffie-Hellman (ECDH) and Signatures in JSON Object Signing and Encryption (JOSE)\">RFC8037</a></cite>]."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                        Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a data-link-type=\"attribute\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-cryptokey-usages\"><code>usages</code></a> attribute of <var>key</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Set the <code>ext</code> attribute of <var>jwk</var> to the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-extractable\">[[extractable]]</a> internal slot\n                        of <var>key</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>result</var> be the result of converting <var>jwk</var>\n                        to an ECMAScript Object, as defined by [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>].\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                        If the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-type\">[[type]]</a> internal slot\n                        of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>data</var> be an <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-octet-string\">octet string</a>\n                        representing the Ed448 public key represented by the <a href=\"https://www.w3.org/TR/WebCryptoAPI/#dfn-CryptoKey-slot-handle\">[[handle]]</a>\n                        internal slot of <var>key</var>.\n                      </p>"
                    },
                    {
                      "html": "<p>\n                        Let <var>result</var> be a new <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a> associated with the\n                        <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                        of <code>this</code> [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-secure-curves/#bib-html\" title=\"HTML Standard\">HTML</a></cite>], and containing\n                        <var>data</var>.\n                      </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                  </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n                Return <var>result</var>.\n              </p>"
        }
      ]
    }
  ]
}