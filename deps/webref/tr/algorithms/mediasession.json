{
  "spec": {
    "title": "Media Session",
    "url": "https://www.w3.org/TR/mediasession/"
  },
  "algorithms": [
    {
      "name": "update metadata algorithm",
      "href": "https://www.w3.org/TR/mediasession/#update-metadata-algorithm",
      "html": "The media metadata for the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#active-media-session\" id=\"ref-for-active-media-session⑦\">active media session</a> MAY be displayed in\n    the platform UI depending on platform conventions. Whenever the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#active-media-session\" id=\"ref-for-active-media-session⑧\">active\n    media session</a> changes or setting <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediasession-metadata\" id=\"ref-for-dom-mediasession-metadata\">metadata</a></code> of the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#active-media-session\" id=\"ref-for-active-media-session⑨\">active media session</a>, the user agent MUST run the <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-lt=\"update metadata algorithm\" data-noexport=\"\" id=\"update-metadata-algorithm\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">update\n    metadata algorithm</dfn>. The steps are as follows:",
      "rationale": "if",
      "steps": [
        {
          "html": "If the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#active-media-session\" id=\"ref-for-active-media-session①⓪\">active media session</a> is null, unset the media metadata\n        presented to the platform, and terminate these steps."
        },
        {
          "html": "If the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediasession-metadata\" id=\"ref-for-dom-mediasession-metadata①\">metadata</a></code> of the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#active-media-session\" id=\"ref-for-active-media-session①①\">active media session</a> is an <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#empty-metadata\" id=\"ref-for-empty-metadata\">empty metadata</a>, unset the media\n        metadata presented to the platform, and terminate these steps."
        },
        {
          "html": "Update the media metadata presented to the platform to match the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediasession-metadata\" id=\"ref-for-dom-mediasession-metadata②\">metadata</a></code> for the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#active-media-session\" id=\"ref-for-active-media-session①②\">active media session</a>."
        },
        {
          "html": "If the user agent wants to display an <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#mediametadata-artwork-images\" id=\"ref-for-mediametadata-artwork-images\">artwork image</a>,\n        the user agent MUST run the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#fetch-image-algorithm\" id=\"ref-for-fetch-image-algorithm\">fetch image algorithm</a>."
        }
      ]
    },
    {
      "name": "fetch image algorithm",
      "href": "https://www.w3.org/TR/mediasession/#fetch-image-algorithm",
      "html": "The <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"fetch-image-algorithm\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">fetch image algorithm</dfn> is as follows:",
      "rationale": "if",
      "steps": [
        {
          "html": "If there are other <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#fetch-image-algorithm\" id=\"ref-for-fetch-image-algorithm①\">fetch image algorithms</a> running, cancel\n        existing algorithm execution instances."
        },
        {
          "html": "If <var>metadata</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediametadata-artwork\" id=\"ref-for-dom-mediametadata-artwork\">artwork</a></code> of the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#active-media-session\" id=\"ref-for-active-media-session①③\">active\n        media session</a> is empty, then terminate these steps."
        },
        {
          "html": "If the platform supports displaying media artwork, select a <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"preferred-artwork-image\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">preferred artwork image</dfn> from <var>metadata</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediametadata-artwork\" id=\"ref-for-dom-mediametadata-artwork①\">artwork</a></code> of the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#active-media-session\" id=\"ref-for-active-media-session①④\">active media session</a>."
        },
        {
          "html": "Let <var>request</var> be a new <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-fetch-record-request\" id=\"ref-for-concept-fetch-record-request\">request</a> whose <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-url\" id=\"ref-for-concept-request-url\">URL</a> is the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#preferred-artwork-image\" id=\"ref-for-preferred-artwork-image\">preferred artwork image</a>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediaimage-src\" id=\"ref-for-dom-mediaimage-src\">src</a></code>, <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-destination\" id=\"ref-for-concept-request-destination\">destination</a> is \"image\", <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-mode\" id=\"ref-for-concept-request-mode\">mode</a> is \"no-cors\", <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-credentials-mode\" id=\"ref-for-concept-request-credentials-mode\">credentials mode</a> is \"include\",\n        and whose <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-use-url-credentials-flag\" id=\"ref-for-concept-request-use-url-credentials-flag\">use-URL-credentials flag</a> is set."
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-fetch\" id=\"ref-for-concept-fetch\">Fetch</a> <var>request</var> with  the following steps executed\n        as the fetch’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#process-response\" id=\"ref-for-process-response\">processResponse</a> algorithm.",
          "rationale": "let",
          "steps": [
            {
              "html": "Let <var>response</var> be the <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response\">response</a> given to the fetch’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#process-response\" id=\"ref-for-process-response①\">processResponse</a> algorithm."
            },
            {
              "html": "If <var>response</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response-type\" id=\"ref-for-concept-response-type\">type</a> is not <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://fetch.spec.whatwg.org/#dom-responsetype-error\" id=\"ref-for-dom-responsetype-error\">\"error\"</a></code>, attempt to decode <var>response</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#body-with-type-body\" id=\"ref-for-body-with-type-body\">body</a> as an\n            image."
            },
            {
              "html": "If the image format is supported, use the image as the artwork for\n            display in platform UI. Otherwise the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#fetch-image-algorithm\" id=\"ref-for-fetch-image-algorithm②\">fetch image algorithm</a> fails and terminates."
            }
          ]
        }
      ]
    },
    {
      "name": "update action handler algorithm",
      "href": "https://www.w3.org/TR/mediasession/#update-action-handler-algorithm",
      "html": "When the <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"update-action-handler-algorithm\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">update action handler algorithm</dfn> on a given <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#mediasession\" id=\"ref-for-mediasession⑤\">MediaSession</a></code> with <var>action</var> and <var>handler</var> parameters\n      is invoked, the user agent MUST run the following steps:",
      "rationale": "if",
      "steps": [
        {
          "html": "If <var>handler</var> is <code>null</code>, remove <var>action</var> from the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#supported-media-session-actions\" id=\"ref-for-supported-media-session-actions\">supported media session actions</a> for <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#mediasession\" id=\"ref-for-mediasession⑥\">MediaSession</a></code> and abort these steps."
        },
        {
          "html": "Add <var>action</var> to the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#supported-media-session-actions\" id=\"ref-for-supported-media-session-actions①\">supported media session actions</a> for <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#mediasession\" id=\"ref-for-mediasession⑦\">MediaSession</a></code> and associate to it the <var>handler</var>."
        }
      ]
    },
    {
      "name": "handle media session action",
      "href": "https://www.w3.org/TR/mediasession/#handle-media-session-action",
      "html": "When the user agent is notified by a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#media-session-action-source\" id=\"ref-for-media-session-action-source④\">media session action source</a> named <var>source</var> that a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#media-session-action\" id=\"ref-for-media-session-action⑤\">media session action</a> named <var>action</var> has been triggered,\n      the user agent MUST <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task\" id=\"ref-for-queue-a-task①\">queue a task</a>, using the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source\" id=\"ref-for-user-interaction-task-source\">user interaction task source</a>, to run the following <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"handle-media-session-action\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">handle media session action</dfn> steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var>session</var> be <var>source</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#media-session-action-source-target\" id=\"ref-for-media-session-action-source-target①\">target</a>."
        },
        {
          "html": "If <var>session</var> is <code>null</code>, set <var>session</var> to the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#active-media-session\" id=\"ref-for-active-media-session①⑥\">active media session</a>."
        },
        {
          "html": "If <var>session</var> is <code>null</code>, abort these steps."
        },
        {
          "html": "Let <var>actions</var> be <var>session</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#supported-media-session-actions\" id=\"ref-for-supported-media-session-actions③\">supported media session actions</a>."
        },
        {
          "html": "If <var>actions</var> does not contain the key <var>action</var>,\n        abort these steps."
        },
        {
          "html": "Let <var>handler</var> be the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#callbackdef-mediasessionactionhandler\" id=\"ref-for-callbackdef-mediasessionactionhandler①\">MediaSessionActionHandler</a></code> associated\n        with the key <var>action</var> in <var>actions</var>."
        },
        {
          "html": "Run <var>handler</var> with the <var>details</var> parameter set to: <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dictdef-mediasessionactiondetails\" id=\"ref-for-dictdef-mediasessionactiondetails\">MediaSessionActionDetails</a></code>."
        },
        {
          "html": "Run the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/interaction.html#activation-notification\" id=\"ref-for-activation-notification\">activation notification</a> steps in the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/document-sequences.html#browsing-context\" id=\"ref-for-browsing-context④\">browsing context</a> associated with <var>session</var>."
        }
      ]
    },
    {
      "html": "When the user agent receives a joint command for <a class=\"idl-code\" data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/mediasession/#dom-mediasessionaction-play\" id=\"ref-for-dom-mediasessionaction-play②\">play</a> and <a class=\"idl-code\" data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/mediasession/#dom-mediasessionaction-pause\" id=\"ref-for-dom-mediasessionaction-pause③\">pause</a>, such as a headset button click, it MUST <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task\" id=\"ref-for-queue-a-task②\">queue a task</a>, using the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source\" id=\"ref-for-user-interaction-task-source①\">user interaction task source</a>, to run\n      the following steps:",
      "rationale": "if",
      "steps": [
        {
          "html": "If the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#active-media-session\" id=\"ref-for-active-media-session①⑦\">active media session</a> is <code>null</code>, abort these steps."
        },
        {
          "html": "Let <var>action</var> be a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#media-session-action\" id=\"ref-for-media-session-action⑥\">media session action</a>."
        },
        {
          "html": "If the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#actual-playback-state\" id=\"ref-for-actual-playback-state②\">actual playback state</a> of the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#active-media-session\" id=\"ref-for-active-media-session①⑧\">active media session</a> is <a class=\"idl-code\" data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/mediasession/#dom-mediasessionplaybackstate-playing\" id=\"ref-for-dom-mediasessionplaybackstate-playing③\">playing</a>, set <var>action</var> to <a class=\"idl-code\" data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/mediasession/#dom-mediasessionaction-pause\" id=\"ref-for-dom-mediasessionaction-pause④\">pause</a>."
        },
        {
          "html": "Otherwise, set <var>action</var> to <a class=\"idl-code\" data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/mediasession/#dom-mediasessionaction-play\" id=\"ref-for-dom-mediasessionaction-play③\">play</a>."
        },
        {
          "html": "Run the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#handle-media-session-action\" id=\"ref-for-handle-media-session-action\">handle media session action</a> steps with <var>action</var>."
        }
      ]
    },
    {
      "name": "media session actions update algorithm",
      "href": "https://www.w3.org/TR/mediasession/#media-session-actions-update-algorithm",
      "html": "When the <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"media-session-actions-update-algorithm\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">media session actions update algorithm</dfn> is invoked, the\n      user agent MUST run the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var>available actions</var> be an array of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#media-session-action\" id=\"ref-for-media-session-action①①\">media session\n        actions</a>."
        },
        {
          "html": "If the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#active-media-session\" id=\"ref-for-active-media-session②①\">active media session</a> is null, set <var>available\n        actions</var> to the empty array."
        },
        {
          "html": "Otherwise, set the <var>available actions</var> to the list of keys\n        available in the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#active-media-session\" id=\"ref-for-active-media-session②②\">active media session</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#supported-media-session-actions\" id=\"ref-for-supported-media-session-actions⑤\">supported media\n        session actions</a>."
        },
        {
          "html": "For each <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#media-session-action-source\" id=\"ref-for-media-session-action-source⑥\">media session action source</a> <var>source</var>, run the\n        following substeps:",
          "rationale": "if",
          "steps": [
            {
              "html": "Optionally, if the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#active-media-session\" id=\"ref-for-active-media-session②③\">active media session</a> is not null:",
              "rationale": "if",
              "steps": [
                {
                  "html": "If the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#active-media-session\" id=\"ref-for-active-media-session②④\">active media session</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#actual-playback-state\" id=\"ref-for-actual-playback-state③\">actual playback\n                state</a> is <a class=\"idl-code\" data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/mediasession/#dom-mediasessionplaybackstate-playing\" id=\"ref-for-dom-mediasessionplaybackstate-playing④\">playing</a>, remove <a class=\"idl-code\" data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/mediasession/#dom-mediasessionaction-play\" id=\"ref-for-dom-mediasessionaction-play⑤\">play</a> from <var>available\n                actions</var>."
                },
                {
                  "html": "Otherwise, remove <a class=\"idl-code\" data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/mediasession/#dom-mediasessionaction-pause\" id=\"ref-for-dom-mediasessionaction-pause⑥\">pause</a> from <var>available\n                actions</var>."
                }
              ]
            },
            {
              "html": "If the <var>source</var> is a UI element created by the user\n            agent, it MAY remove some elements from <var>available\n            actions</var> if there are too many of them compared to the\n            available space."
            },
            {
              "html": "Notify the <var>source</var> with the updated list of <var>available actions</var>."
            }
          ]
        }
      ]
    },
    {
      "name": "MediaSession/metadata",
      "href": "https://www.w3.org/TR/mediasession/#dom-mediasession-metadata",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"MediaSession\" data-dfn-type=\"attribute\" data-export=\"\" id=\"dom-mediasession-metadata\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>metadata</code></dfn> attribute\n  reflects the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#mediasession\" id=\"ref-for-mediasession①③\">MediaSession</a></code>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediasession-metadata\" id=\"ref-for-dom-mediasession-metadata④\">metadata</a></code>. On getting, it MUST\n  return the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#mediasession\" id=\"ref-for-mediasession①④\">MediaSession</a></code>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediasession-metadata\" id=\"ref-for-dom-mediasession-metadata⑤\">metadata</a></code>. On setting, it MUST\n  run the following steps with <var>value</var> being the new value being set:",
      "rationale": "if",
      "steps": [
        {
          "html": "If the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#mediasession\" id=\"ref-for-mediasession①⑤\">MediaSession</a></code>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediasession-metadata\" id=\"ref-for-dom-mediasession-metadata⑥\">metadata</a></code> is not <code>null</code>, set its <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#mediametadata-media-session\" id=\"ref-for-mediametadata-media-session\">media session</a> to <code>null</code>."
        },
        {
          "html": "Set the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#mediasession\" id=\"ref-for-mediasession①⑥\">MediaSession</a></code>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediasession-metadata\" id=\"ref-for-dom-mediasession-metadata⑦\">metadata</a></code> to <var>value</var>."
        },
        {
          "html": "If the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#mediasession\" id=\"ref-for-mediasession①⑦\">MediaSession</a></code>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediasession-metadata\" id=\"ref-for-dom-mediasession-metadata⑧\">metadata</a></code> is not <code>null</code>, set its <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#mediametadata-media-session\" id=\"ref-for-mediametadata-media-session①\">media session</a> to the current <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#mediasession\" id=\"ref-for-mediasession①⑧\">MediaSession</a></code>."
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel\">In parallel</a>, run the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#update-metadata-algorithm\" id=\"ref-for-update-metadata-algorithm①\">update metadata algorithm</a>."
        }
      ]
    },
    {
      "name": "MediaSession/setMicrophoneActive(active)",
      "href": "https://www.w3.org/TR/mediasession/#dom-mediasession-setmicrophoneactive",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"MediaSession\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-mediasession-setmicrophoneactive\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>setMicrophoneActive(active)</code></dfn> method\n  indicates to the user agent the microphone capture state desired by the page\n  (e.g. if the microphone is considered \"inactive\" by the page since it is no\n  longer sending audio through a call, the page can invoke <code>setMicrophoneActive(false)</code>). When invoked, it MUST perform the\n  following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var>document</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this\">this</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\" id=\"ref-for-concept-relevant-global\">relevant global object</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window\" id=\"ref-for-concept-document-window\">associated Document</a>."
        },
        {
          "html": "Let <var>captureKind</var> be \"microphone\"."
        },
        {
          "html": "Return the result of running the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#update-capture-state-algorithm\" id=\"ref-for-update-capture-state-algorithm\">update capture state algorithm</a> with <var>document</var>, <var>active</var> and <var>captureKind</var>."
        }
      ]
    },
    {
      "name": "MediaSession/setCameraActive(active)",
      "href": "https://www.w3.org/TR/mediasession/#dom-mediasession-setcameraactive",
      "html": "Similarly, the <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"MediaSession\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-mediasession-setcameraactive\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>setCameraActive(active)</code></dfn> method indicates to the user agent the camera capture state desired by the\n  page. When invoked, it MUST perform the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var>document</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①\">this</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\" id=\"ref-for-concept-relevant-global①\">relevant global object</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window\" id=\"ref-for-concept-document-window①\">associated Document</a>."
        },
        {
          "html": "Let <var>captureKind</var> be \"camera\"."
        },
        {
          "html": "Return the result of running the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#update-capture-state-algorithm\" id=\"ref-for-update-capture-state-algorithm①\">update capture state algorithm</a> with <var>document</var>, <var>active</var> and <var>captureKind</var>."
        }
      ]
    },
    {
      "name": "MediaSession/setScreenshareActive(active)",
      "href": "https://www.w3.org/TR/mediasession/#dom-mediasession-setscreenshareactive",
      "html": "Similarly, the <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"MediaSession\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-mediasession-setscreenshareactive\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>setScreenshareActive(active)</code></dfn> method indicates to the user agent the screenshare capture state desired by\n  the page. When invoked, it MUST perform the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var>document</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this②\">this</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\" id=\"ref-for-concept-relevant-global②\">relevant global object</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window\" id=\"ref-for-concept-document-window②\">associated Document</a>."
        },
        {
          "html": "Let <var>captureKind</var> be \"screenshare\"."
        },
        {
          "html": "Return the result of running the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#update-capture-state-algorithm\" id=\"ref-for-update-capture-state-algorithm②\">update capture state algorithm</a> with <var>document</var>, <var>active</var> and <var>captureKind</var>."
        }
      ]
    },
    {
      "name": "update capture state algorithm",
      "href": "https://www.w3.org/TR/mediasession/#update-capture-state-algorithm",
      "html": "The <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"update-capture-state-algorithm\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">update capture state algorithm</dfn>, when invoked with <var>document</var>, <var>active</var> and <var>captureKind</var>, MUST\n  perform the following steps:",
      "rationale": "if",
      "steps": [
        {
          "html": "If <var>document</var> is not <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/document-sequences.html#fully-active\" id=\"ref-for-fully-active\">fully active</a>, return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with\">a promise rejected with</a> <a class=\"idl-code\" data-link-type=\"exception\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror\">InvalidStateError</a>."
        },
        {
          "html": "If <var>active</var> is <code>true</code> and <var>document</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/interaction.html#visibility-state\" id=\"ref-for-visibility-state\">visibility state</a> is not \"visible\", the user agent MAY return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with①\">a promise rejected with</a> <a class=\"idl-code\" data-link-type=\"exception\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror①\">InvalidStateError</a>."
        },
        {
          "html": "Let <var>p</var> be a new promise."
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①\">In parallel</a>, run the following steps:",
          "rationale": "let",
          "steps": [
            {
              "html": "Let <var>applyPausePolicy</var> be <code>true</code> if the user agent\n        implements a policy of <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"pausing-all-input-sources\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">pausing all input sources</dfn> of type <var>captureKind</var> in response to UI and <code>false</code> otherwise."
            },
            {
              "html": "If <var>applyPausePolicy</var> is <code>true</code>, run the following\n        substeps:",
              "rationale": "let",
              "steps": [
                {
                  "html": "Let <var>currentlyActive</var> be <code>false</code> if the user\n            agent is currently <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#pausing-all-input-sources\" id=\"ref-for-pausing-all-input-sources\">pausing all input sources</a> of type <var>captureKind</var> and <code>true</code> otherwise."
                },
                {
                  "html": "If <var>active</var> is <var>currentlyActive</var>, <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task\" id=\"ref-for-queue-a-task③\">queue a task</a> using the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source\" id=\"ref-for-user-interaction-task-source②\">user interaction task source</a> to resolve <var>p</var> with <code>undefined</code> and abort these steps."
                },
                {
                  "html": "If <var>active</var> is <code>true</code>, the user agent MAY wait\n            to proceed, for instance to prompt the user."
                },
                {
                  "html": "If the user agent denies the request to update the capture state, <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task\" id=\"ref-for-queue-a-task④\">queue a task</a> using the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source\" id=\"ref-for-user-interaction-task-source③\">user interaction task source</a> to\n            reject <var>p</var> with a <a class=\"idl-code\" data-link-type=\"exception\" href=\"https://webidl.spec.whatwg.org/#notallowederror\" id=\"ref-for-notallowederror\">NotAllowedError</a> and\n            abort these steps."
                }
              ]
            },
            {
              "html": "Update the user agent capture state UI according to <var>captureKind</var> and <var>active</var>."
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task\" id=\"ref-for-queue-a-task⑤\">Queue a task</a> using the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source\" id=\"ref-for-user-interaction-task-source④\">user interaction task source</a> to resolve <var>p</var> with <code>undefined</code>."
            },
            {
              "html": "If <var>applyPausePolicy</var> is <code>true</code>, run the following\n        substeps:",
              "rationale": "let",
              "steps": [
                {
                  "html": "Let <var>newMutedState</var> be <code>true</code> if <var>active</var> is <code>false</code> and <code>false</code> otherwise."
                },
                {
                  "html": "For each <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediacapture-streams/#dom-mediastreamtrack\" id=\"ref-for-dom-mediastreamtrack⑤\">MediaStreamTrack</a></code> whose source is of type <var>captureKind</var>, <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task\" id=\"ref-for-queue-a-task⑥\">queue a task</a> using the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#user-interaction-task-source\" id=\"ref-for-user-interaction-task-source⑤\">user interaction task source</a> to <a data-link-type=\"abstract-op\" href=\"https://www.w3.org/TR/mediacapture-streams/#set-track-muted\" id=\"ref-for-set-track-muted①\">set a track’s muted state</a> to <var>newMutedState</var>."
                }
              ]
            }
          ]
        },
        {
          "html": "Return <var>p</var>."
        }
      ]
    },
    {
      "name": "MediaMetadata/MediaMetadata(init)",
      "href": "https://www.w3.org/TR/mediasession/#dom-mediametadata-mediametadata",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"MediaMetadata\" data-dfn-type=\"constructor\" data-export=\"\" data-lt=\"MediaMetadata(init)|constructor(init)|MediaMetadata()|constructor()\" id=\"dom-mediametadata-mediametadata\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>MediaMetadata(<var>init</var>)</code></dfn> constructor, when invoked, MUST run the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var>metadata</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#mediametadata\" id=\"ref-for-mediametadata①⑥\">MediaMetadata</a></code> object."
        },
        {
          "html": "Set <var>metadata</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediametadata-title\" id=\"ref-for-dom-mediametadata-title①\">title</a></code> to <var>init</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediametadatainit-title\" id=\"ref-for-dom-mediametadatainit-title\">title</a></code>."
        },
        {
          "html": "Set <var>metadata</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediametadata-artist\" id=\"ref-for-dom-mediametadata-artist①\">artist</a></code> to <var>init</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediametadatainit-artist\" id=\"ref-for-dom-mediametadatainit-artist\">artist</a></code>."
        },
        {
          "html": "Set <var>metadata</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediametadata-album\" id=\"ref-for-dom-mediametadata-album①\">album</a></code> to <var>init</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediametadatainit-album\" id=\"ref-for-dom-mediametadatainit-album\">album</a></code>."
        },
        {
          "html": "Run the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#convert-artwork-algorithm\" id=\"ref-for-convert-artwork-algorithm\">convert artwork algorithm</a> with <var>init</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediametadatainit-artwork\" id=\"ref-for-dom-mediametadatainit-artwork\">artwork</a></code> as <var>input</var> and set <var>metadata</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#mediametadata-artwork-images\" id=\"ref-for-mediametadata-artwork-images②\">artwork images</a> as the\n    result if it succeeded."
        },
        {
          "html": "Let <var>chapters</var> be an empty list of type <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#chapterinformation\" id=\"ref-for-chapterinformation①\">ChapterInformation</a></code>."
        },
        {
          "html": "For each <var>entry</var> in <var>init</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediametadatainit-chapterinfo\" id=\"ref-for-dom-mediametadatainit-chapterinfo\">chapterInfo</a></code>, <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#create-a-chapterinformation\" id=\"ref-for-create-a-chapterinformation\">create a ChapterInformation</a> from <var>entry</var> and append it to <var>chapters</var>."
        },
        {
          "html": "Set <var>metadata</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#mediametadata-chapter-information\" id=\"ref-for-mediametadata-chapter-information①\">chapter information</a> to the result of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-create-frozen-array\" id=\"ref-for-dfn-create-frozen-array\">creating a frozen array</a> from <var>chapters</var>."
        },
        {
          "html": "Return <var>metadata</var>."
        }
      ]
    },
    {
      "name": "convert artwork algorithm",
      "href": "https://www.w3.org/TR/mediasession/#convert-artwork-algorithm",
      "html": "When the <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"convert-artwork-algorithm\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">convert artwork algorithm</dfn> with <var>input</var> parameter is\ninvoked, where the <var>input</var> is a sequence of type <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dictdef-mediaimage\" id=\"ref-for-dictdef-mediaimage②\">MediaImage</a></code>, the\nuser agent MUST run the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var>output</var> be an empty list of type <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dictdef-mediaimage\" id=\"ref-for-dictdef-mediaimage③\">MediaImage</a></code>."
        },
        {
          "html": "For each <var>entry</var> in <var>input</var> (which is a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dictdef-mediaimage\" id=\"ref-for-dictdef-mediaimage④\">MediaImage</a></code> list), perform the following steps:",
          "rationale": "let",
          "steps": [
            {
              "html": "Let <var>image</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dictdef-mediaimage\" id=\"ref-for-dictdef-mediaimage⑤\">MediaImage</a></code>."
            },
            {
              "html": "Let <var>baseURL</var> be the API base URL specified by the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#entry-settings-object\" id=\"ref-for-entry-settings-object\">entry\n      settings object</a>."
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-parser\" id=\"ref-for-concept-url-parser\">Parse</a> <var>entry</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediaimage-src\" id=\"ref-for-dom-mediaimage-src①\">src</a></code> using <var>baseURL</var>. If it does not return failure, set <var>image</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediaimage-src\" id=\"ref-for-dom-mediaimage-src②\">src</a></code> to the return value. Otherwise,\n        throw a <a class=\"idl-code\" data-link-type=\"exception\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror④\">TypeError</a> and abort these steps."
            },
            {
              "html": "Set <var>image</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediaimage-sizes\" id=\"ref-for-dom-mediaimage-sizes\">sizes</a></code> to <var>entry</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediaimage-sizes\" id=\"ref-for-dom-mediaimage-sizes①\">sizes</a></code>."
            },
            {
              "html": "Set <var>image</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediaimage-type\" id=\"ref-for-dom-mediaimage-type\">type</a></code> to <var>entry</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-mediaimage-type\" id=\"ref-for-dom-mediaimage-type①\">type</a></code>."
            },
            {
              "html": "Append <var>image</var> to the <var>output</var>."
            }
          ]
        },
        {
          "html": "Return <var>output</var> as result."
        }
      ]
    },
    {
      "name": "MediaMetadata/artwork",
      "href": "https://www.w3.org/TR/mediasession/#dom-mediametadata-artwork",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"MediaMetadata\" data-dfn-type=\"attribute\" data-export=\"\" id=\"dom-mediametadata-artwork\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>artwork</code></dfn> attribute reflects the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#mediametadata\" id=\"ref-for-mediametadata②⑥\">MediaMetadata</a></code>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#mediametadata-artwork-images\" id=\"ref-for-mediametadata-artwork-images③\">artwork\n  images</a>. On getting, it MUST run the following steps:",
      "rationale": "if",
      "steps": [
        {
          "html": "If the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#mediametadata\" id=\"ref-for-mediametadata②⑦\">MediaMetadata</a></code>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#mediametadata-converted-artwork-images\" id=\"ref-for-mediametadata-converted-artwork-images\">converted artwork images</a> is <code>undefined</code>, run the following steps:",
          "rationale": "let",
          "steps": [
            {
              "html": "Let <var>frozenArtwork</var> be a JavaScript Array value."
            },
            {
              "html": "For each <var>entry</var> in the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#mediametadata\" id=\"ref-for-mediametadata②⑧\">MediaMetadata</a></code>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#mediametadata-artwork-images\" id=\"ref-for-mediametadata-artwork-images④\">artwork images</a>, perform the following steps:",
              "rationale": "let",
              "steps": [
                {
                  "html": "Let <var>image</var> be the result of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-convert-idl-to-javascript-value\" id=\"ref-for-dfn-convert-idl-to-javascript-value\">converting to a JavaScript object</a> <var>entry</var>."
                },
                {
                  "html": "Perform <a href=\"https://tc39.es/ecma262/#sec-setintegritylevel\"> SetIntegrityLevel</a>(<var>image</var>, \"<code>frozen</code>\"),\n            to prevent accidental mutation by scripts."
                },
                {
                  "html": "Push <var>image</var> to <var>frozenArtwork</var>."
                }
              ]
            },
            {
              "html": "Perform <a href=\"https://tc39.es/ecma262/#sec-setintegritylevel\"> SetIntegrityLevel</a>(<var>frozenArtwork</var>, \"<code>frozen</code>\")."
            },
            {
              "html": "Set the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#mediametadata\" id=\"ref-for-mediametadata②⑨\">MediaMetadata</a></code>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#mediametadata-converted-artwork-images\" id=\"ref-for-mediametadata-converted-artwork-images①\">converted artwork images</a> to <var>frozenArtwork</var>."
            }
          ]
        },
        {
          "html": "Return the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#mediametadata\" id=\"ref-for-mediametadata③⓪\">MediaMetadata</a></code>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#mediametadata-converted-artwork-images\" id=\"ref-for-mediametadata-converted-artwork-images②\">converted artwork images</a>."
        }
      ]
    },
    {
      "html": "On setting, it MUST run the following steps with <var>value</var> being the\n  new value being set:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var>convertedArtwork</var> be the result of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-convert-ecmascript-to-idl-value\" id=\"ref-for-dfn-convert-ecmascript-to-idl-value\">converting</a> <var>value</var> to a sequence of type <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dictdef-mediaimage\" id=\"ref-for-dictdef-mediaimage⑥\">MediaImage</a></code>."
        },
        {
          "html": "Run <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#convert-artwork-algorithm\" id=\"ref-for-convert-artwork-algorithm①\">convert artwork algorithm</a> with <var>convertedArtwork</var>, and\n    set the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#mediametadata\" id=\"ref-for-mediametadata③①\">MediaMetadata</a></code>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#mediametadata-artwork-images\" id=\"ref-for-mediametadata-artwork-images⑤\">artwork images</a> as\n    the result if it succeeds."
        },
        {
          "html": "Set the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#mediametadata\" id=\"ref-for-mediametadata③②\">MediaMetadata</a></code>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#mediametadata-converted-artwork-images\" id=\"ref-for-mediametadata-converted-artwork-images③\">converted artwork images</a> to <code>undefined</code>."
        }
      ]
    },
    {
      "html": "When <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#mediametadata\" id=\"ref-for-mediametadata③③\">MediaMetadata</a></code>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#mediametadata-title\" id=\"ref-for-mediametadata-title④\">title</a>, <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#mediametadata-artist\" id=\"ref-for-mediametadata-artist④\">artist</a>, <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#mediametadata-album\" id=\"ref-for-mediametadata-album④\">album</a> or <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#mediametadata-artwork-images\" id=\"ref-for-mediametadata-artwork-images⑥\">artwork images</a> are modified, the user agent MUST run the\n  following steps:",
      "rationale": "if",
      "steps": [
        {
          "html": "If the instance has no associated <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#mediametadata-media-session\" id=\"ref-for-mediametadata-media-session③\">media session</a>, abort\n    these steps."
        },
        {
          "html": "Otherwise, <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task\" id=\"ref-for-queue-a-task⑦\">queue a task</a> to run the following substeps:",
          "rationale": "if",
          "steps": [
            {
              "html": "If the instance no longer has an associated <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#mediametadata-media-session\" id=\"ref-for-mediametadata-media-session④\">media\n        session</a>, abort these steps."
            },
            {
              "html": "Otherwise, <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel②\">in parallel</a>, run the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#update-metadata-algorithm\" id=\"ref-for-update-metadata-algorithm②\">update metadata\n        algorithm</a>."
            }
          ]
        }
      ]
    },
    {
      "name": "create a ChapterInformation",
      "href": "https://www.w3.org/TR/mediasession/#create-a-chapterinformation",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"create-a-chapterinformation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">create a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#chapterinformation\" id=\"ref-for-chapterinformation⑦\">ChapterInformation</a></code></dfn> with <var>init</var>, run the\n  following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var>chapterInfo</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#chapterinformation\" id=\"ref-for-chapterinformation⑧\">ChapterInformation</a></code> object."
        },
        {
          "html": "Set <var>chapterInfo</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-chapterinformation-title\" id=\"ref-for-dom-chapterinformation-title①\">title</a></code> to <var>init</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-chapterinformationinit-title\" id=\"ref-for-dom-chapterinformationinit-title\">title</a></code>."
        },
        {
          "html": "Set <var>chapterInfo</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-chapterinformation-starttime\" id=\"ref-for-dom-chapterinformation-starttime①\">startTime</a></code> to <var>init</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-chapterinformationinit-starttime\" id=\"ref-for-dom-chapterinformationinit-starttime\">startTime</a></code>. If the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#chapterinformation-starttime\" id=\"ref-for-chapterinformation-starttime\">startTime</a> is negative or greater than <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#duration\" id=\"ref-for-duration③\">duration</a>, throw a <a class=\"idl-code\" data-link-type=\"exception\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror⑤\">TypeError</a>."
        },
        {
          "html": "Let <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-chapterinformationinit-artwork\" id=\"ref-for-dom-chapterinformationinit-artwork\">artwork</a></code> be the result of running the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#convert-artwork-algorithm\" id=\"ref-for-convert-artwork-algorithm②\">convert artwork algorithm</a> with <var>init</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-chapterinformation-artwork\" id=\"ref-for-dom-chapterinformation-artwork①\">artwork</a></code> as <var>input</var>."
        },
        {
          "html": "Set <var>chapterInfo</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/mediasession/#chapterinformation-artwork-images\" id=\"ref-for-chapterinformation-artwork-images\">artwork\n    images</a> to the result of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-create-frozen-array\" id=\"ref-for-dfn-create-frozen-array①\">creating a frozen\n    array</a> from <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/mediasession/#dom-chapterinformationinit-artwork\" id=\"ref-for-dom-chapterinformationinit-artwork①\">artwork</a></code>."
        },
        {
          "html": "Return <var>chapterInfo</var>."
        }
      ]
    }
  ]
}