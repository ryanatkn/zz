#!/usr/bin/env bash

# Build wrapper - auto-builds and runs zz

set -e
cd "$(dirname "$0")"

# Handle wrapper flags
skip_build=false
debug_build=true
app_args=()

for arg in "$@"; do
    case $arg in
        --no-build) skip_build=true ;;
        --debug) debug_build=true ;;
        *) app_args+=("$arg") ;;
    esac
done

# Build if needed
if [ "$skip_build" = false ]; then
    if [ "$debug_build" = true ]; then
        zig build -Doptimize=Debug
    else
        zig build -Doptimize=ReleaseFast
    fi
fi

# Run with args
exec ./zig-out/bin/zz "${app_args[@]}"