{
  "spec": {
    "title": "Web Serial API",
    "url": "https://wicg.github.io/serial/"
  },
  "algorithms": [
    {
      "html": "The <a data-link-type=\"idl\" data-lt=\"requestPort()\" href=\"https://wicg.github.io/serial/#dom-serial-requestport\" class=\"internalDFN\" id=\"ref-for-dom-serial-requestport-3\"><code>requestPort</code></a><code>()</code> method steps are:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var data-type=\"Promise\">promise</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\">a new promise</a>."
        },
        {
          "html": "If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>'s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>'s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window\">associated Document</a> is not <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use\">allowed to use</a> the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/permissions-policy-1/#policy-controlled-feature\">policy-controlled feature</a> named \"<a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-serial\" class=\"internalDFN\" id=\"ref-for-dfn-serial-1\"><code>serial</code></a>\", <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\">reject</a>\n          <var data-type=\"Promise\">promise</var> with a \"<a data-link-type=\"exception\" data-lt=\"SecurityError\" href=\"https://webidl.spec.whatwg.org/#securityerror\"><code>SecurityError</code></a>\" <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\"><code>DOMException</code></a> and return\n          <var data-type=\"Promise\">promise</var>."
        },
        {
          "html": "If the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a> does not have\n          <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/interaction.html#transient-activation\">transient activation</a>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\">reject</a> <var data-type=\"Promise\">promise</var> with a\n          \"<a data-link-type=\"exception\" data-lt=\"SecurityError\" href=\"https://webidl.spec.whatwg.org/#securityerror\"><code>SecurityError</code></a>\" <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\"><code>DOMException</code></a> and return <var data-type=\"Promise\">promise</var>."
        },
        {
          "html": "If <var>options</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialportrequestoptions-filters\" class=\"internalDFN\" id=\"ref-for-dom-serialportrequestoptions-filters-1\"><code>filters</code></a>\"] is present,\n          then for each <var data-type=\"SerialPortFilter\">filter</var> in\n          <var>options</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialportrequestoptions-filters\" class=\"internalDFN\" id=\"ref-for-dom-serialportrequestoptions-filters-2\"><code>filters</code></a>\"] run the following\n          steps:",
          "rationale": "if",
          "steps": [
            {
              "html": "If <var data-type=\"SerialPortFilter\">filter</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialportfilter-bluetoothserviceclassid\" class=\"internalDFN\" id=\"ref-for-dom-serialportfilter-bluetoothserviceclassid-1\"><code>bluetoothServiceClassId</code></a>\"] is\n              present:",
              "rationale": "if",
              "steps": [
                {
                  "html": "If <var data-type=\"SerialPortFilter\">filter</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialportfilter-usbvendorid\" class=\"internalDFN\" id=\"ref-for-dom-serialportfilter-usbvendorid-1\"><code>usbVendorId</code></a>\"] is present,\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\">reject</a> <var data-type=\"Promise\">promise</var> with a <a data-link-type=\"exception\" data-lt=\"TypeError\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\"><code>TypeError</code></a> and return <var data-type=\"Promise\">promise</var>."
                },
                {
                  "html": "If <var data-type=\"SerialPortFilter\">filter</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialportfilter-usbproductid\" class=\"internalDFN\" id=\"ref-for-dom-serialportfilter-usbproductid-1\"><code>usbProductId</code></a>\"] is present,\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\">reject</a> <var data-type=\"Promise\">promise</var> with a <a data-link-type=\"exception\" data-lt=\"TypeError\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\"><code>TypeError</code></a> and return <var data-type=\"Promise\">promise</var>."
                }
              ]
            },
            {
              "html": "If <var data-type=\"SerialPortFilter\">filter</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialportfilter-usbvendorid\" class=\"internalDFN\" id=\"ref-for-dom-serialportfilter-usbvendorid-2\"><code>usbVendorId</code></a>\"] is not\n              present, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\">reject</a> <var data-type=\"Promise\">promise</var> with a <a data-link-type=\"exception\" data-lt=\"TypeError\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\"><code>TypeError</code></a> and return\n              <var data-type=\"Promise\">promise</var>."
            }
          ]
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "Let <var data-type=\"list&lt;SerialPort&gt;\">allPorts</var> be an empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list\">list</a>."
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\">For each</a> Bluetooth device registered with the system:",
              "rationale": "for",
              "steps": [
                {
                  "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\">For each</a> <a data-link-type=\"typedef\" data-lt=\"BluetoothServiceUUID\" href=\"https://webbluetoothcg.github.io/web-bluetooth/#typedefdef-bluetoothserviceuuid\"><code>BluetoothServiceUUID</code></a>\n                  <var data-type=\"BluetoothServiceUUID\">uuid</var> supported by the device:",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<var>options</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialportrequestoptions-allowedbluetoothserviceclassids\" class=\"internalDFN\" id=\"ref-for-dom-serialportrequestoptions-allowedbluetoothserviceclassids-1\"><code>allowedBluetoothServiceClassIds</code></a>\"]\n                          is present and <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-contain\">contains</a> <var data-type=\"BluetoothServiceUUID\">uuid</var>:",
                      "rationale": "let",
                      "steps": [
                        {
                          "html": "Let <var data-type=\"SerialPort\">port</var> be a <a data-link-type=\"idl\" data-lt=\"SerialPort\" href=\"https://wicg.github.io/serial/#dom-serialport\" class=\"internalDFN\" id=\"ref-for-dom-serialport-3\"><code>SerialPort</code></a>\n                              representing the service on the Bluetooth device."
                        },
                        {
                          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\">Append</a> <var data-type=\"SerialPort\">port</var> to <var data-type=\"list&lt;SerialPort&gt;\">allPorts</var>."
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\">For each</a> <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-available\" class=\"internalDFN\" id=\"ref-for-dfn-available-1\">available</a> non-Bluetooth serial port:",
              "rationale": "let",
              "steps": [
                {
                  "html": "Let <var data-type=\"SerialPort\">port</var> be a <a data-link-type=\"idl\" data-lt=\"SerialPort\" href=\"https://wicg.github.io/serial/#dom-serialport\" class=\"internalDFN\" id=\"ref-for-dom-serialport-4\"><code>SerialPort</code></a> representing\n                  the port."
                },
                {
                  "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\">Append</a> <var data-type=\"SerialPort\">port</var> to <var data-type=\"list&lt;SerialPort&gt;\">allPorts</var>."
                }
              ]
            },
            {
              "html": "Prompt the user to grant the site access to a serial port by\n              presenting them with a list of ports in <var data-type=\"list&lt;SerialPort&gt;\">allPorts</var> that <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-match-any-filter\" class=\"internalDFN\" id=\"ref-for-dfn-match-any-filter-1\">match any filter</a> in <var>options</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialportrequestoptions-filters\" class=\"internalDFN\" id=\"ref-for-dom-serialportrequestoptions-filters-3\"><code>filters</code></a>\"]\n              if present and <var data-type=\"list&lt;SerialPort&gt;\">allPorts</var> otherwise."
            },
            {
              "html": "If the user does not choose a port, <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a>\n              on the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a> using the <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-serial-port-task-source\" class=\"internalDFN\" id=\"ref-for-dfn-serial-port-task-source-1\">serial port task source</a> to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\">reject</a> <var data-type=\"Promise\">promise</var> with a\n              \"<a data-link-type=\"exception\" href=\"https://webidl.spec.whatwg.org/#notfounderror\"><code>NotFoundError</code></a>\" <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\"><code>DOMException</code></a> and abort these steps."
            },
            {
              "html": "Let <var data-type=\"SerialPort\">port</var> be a <a data-link-type=\"idl\" data-lt=\"SerialPort\" href=\"https://wicg.github.io/serial/#dom-serialport\" class=\"internalDFN\" id=\"ref-for-dom-serialport-5\"><code>SerialPort</code></a> representing the\n              port chosen by the user."
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a> of\n              <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a> using the <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-serial-port-task-source\" class=\"internalDFN\" id=\"ref-for-dfn-serial-port-task-source-2\">serial port task source</a> to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\">resolve</a>\n              <var data-type=\"Promise\">promise</var> with <var data-type=\"SerialPort\">port</var>."
            }
          ]
        },
        {
          "html": "Return <var data-type=\"Promise\">promise</var>."
        }
      ]
    },
    {
      "name": "matches the filter",
      "href": "https://wicg.github.io/serial/#dfn-matches-the-filter",
      "html": "A serial port <var data-type=\"SerialPort\">port</var> <dfn id=\"dfn-matches-the-filter\" tabindex=\"0\" aria-haspopup=\"dialog\" data-dfn-type=\"dfn\">matches the filter</dfn>\n            <var data-type=\"SerialPortFilter\">filter</var> if these steps return <code>true</code>:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var data-type=\"SerialPortInfo\">info</var> be the result of calling\n            <var data-type=\"SerialPort\">port</var>.<a data-link-type=\"idl\" data-lt=\"getInfo()\" href=\"https://wicg.github.io/serial/#dom-serialport-getinfo\" class=\"internalDFN\" id=\"ref-for-dom-serialport-getinfo-1\"><code>getInfo</code></a><code>()</code>."
        },
        {
          "html": "If <var data-type=\"SerialPortFilter\">filter</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialportfilter-bluetoothserviceclassid\" class=\"internalDFN\" id=\"ref-for-dom-serialportfilter-bluetoothserviceclassid-3\"><code>bluetoothServiceClassId</code></a>\"] is\n            present:",
          "rationale": "if",
          "steps": [
            {
              "html": "If the serial port is not part of a Bluetooth device,\n                return <code>false</code>."
            },
            {
              "html": "If <var data-type=\"SerialPortFilter\">filter</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialportfilter-bluetoothserviceclassid\" class=\"internalDFN\" id=\"ref-for-dom-serialportfilter-bluetoothserviceclassid-4\"><code>bluetoothServiceClassId</code></a>\"]\n                is equal to\n                <var data-type=\"SerialPortInfo\">info</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialportinfo-bluetoothserviceclassid\" class=\"internalDFN\" id=\"ref-for-dom-serialportinfo-bluetoothserviceclassid-1\"><code>bluetoothServiceClassId</code></a>\"], return\n                <code>true</code>."
            },
            {
              "html": "Otherwise, return <code>false</code>."
            }
          ]
        },
        {
          "html": "If <var data-type=\"SerialPortFilter\">filter</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialportfilter-usbvendorid\" class=\"internalDFN\" id=\"ref-for-dom-serialportfilter-usbvendorid-5\"><code>usbVendorId</code></a>\"] is not present,\n            return <code>true</code>."
        },
        {
          "html": "If the serial port is not part of a USB device, return <code>false</code>."
        },
        {
          "html": "If <var data-type=\"SerialPortInfo\">info</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialportinfo-usbvendorid\" class=\"internalDFN\" id=\"ref-for-dom-serialportinfo-usbvendorid-1\"><code>usbVendorId</code></a>\"] is not equal to\n            <var data-type=\"SerialPortFilter\">filter</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialportfilter-usbvendorid\" class=\"internalDFN\" id=\"ref-for-dom-serialportfilter-usbvendorid-6\"><code>usbVendorId</code></a>\"], return <code>false</code>."
        },
        {
          "html": "If <var data-type=\"SerialPortFilter\">filter</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialportfilter-usbproductid\" class=\"internalDFN\" id=\"ref-for-dom-serialportfilter-usbproductid-4\"><code>usbProductId</code></a>\"] is not\n            present, return <code>true</code>."
        },
        {
          "html": "If <var data-type=\"SerialPortInfo\">info</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialportinfo-usbproductid\" class=\"internalDFN\" id=\"ref-for-dom-serialportinfo-usbproductid-1\"><code>usbProductId</code></a>\"] is not equal to\n            <var data-type=\"SerialPortFilter\">filter</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialportfilter-usbproductid\" class=\"internalDFN\" id=\"ref-for-dom-serialportfilter-usbproductid-5\"><code>usbProductId</code></a>\"], return <code>false</code>."
        },
        {
          "html": "Otherwise, return <code>true</code>."
        }
      ]
    },
    {
      "name": "match any filter",
      "href": "https://wicg.github.io/serial/#dfn-match-any-filter",
      "html": "A serial port <var data-type=\"SerialPort\">port</var> <dfn data-lt=\"match any filter|matches any filter\" id=\"dfn-match-any-filter\" tabindex=\"0\" aria-haspopup=\"dialog\" data-dfn-type=\"dfn\">matches any filter</dfn> in a sequence of\n            <a data-link-type=\"idl\" data-lt=\"SerialPortFilter\" href=\"https://wicg.github.io/serial/#dom-serialportfilter\" class=\"internalDFN\" id=\"ref-for-dom-serialportfilter-4\"><code>SerialPortFilter</code></a> if these steps return <code>true</code>:",
      "rationale": "for",
      "steps": [
        {
          "html": "For each <var data-type=\"SerialPortFilter\">filter</var> in the sequence, run these sub-steps:",
          "rationale": "if",
          "steps": [
            {
              "html": "If <var data-type=\"SerialPort\">port</var> <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-matches-the-filter\" class=\"internalDFN\" id=\"ref-for-dfn-matches-the-filter-1\">matches the filter</a> <var data-type=\"SerialPortFilter\">filter</var>, return <code>true</code>."
            }
          ]
        },
        {
          "html": "Return <code>false</code>."
        }
      ]
    },
    {
      "html": "The <a data-link-type=\"idl\" data-lt=\"getPorts()\" href=\"https://wicg.github.io/serial/#dom-serial-getports\" class=\"internalDFN\" id=\"ref-for-dom-serial-getports-2\"><code>getPorts</code></a><code>()</code> method steps are:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var data-type=\"Promise\">promise</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\">a new promise</a>."
        },
        {
          "html": "If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>'s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>'s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window\">associated Document</a> is not <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use\">allowed to use</a> the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/permissions-policy-1/#policy-controlled-feature\">policy-controlled feature</a> named <code>\"serial\"</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\">reject</a> <var data-type=\"Promise\">promise</var> with a\n          \"<a data-link-type=\"exception\" data-lt=\"SecurityError\" href=\"https://webidl.spec.whatwg.org/#securityerror\"><code>SecurityError</code></a>\" <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\"><code>DOMException</code></a> and return <var data-type=\"Promise\">promise</var>."
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "Let <var>availablePorts</var> be the sequence of <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-available\" class=\"internalDFN\" id=\"ref-for-dfn-available-2\">available</a> serial\n              ports which the user has allowed the site to access\n              as the result of a previous call to <a data-link-type=\"idl\" data-lt=\"requestPort()\" href=\"https://wicg.github.io/serial/#dom-serial-requestport\" class=\"internalDFN\" id=\"ref-for-dom-serial-requestport-4\"><code>requestPort</code></a><code>()</code>."
            },
            {
              "html": "Let <var>ports</var> be the sequence of the <a data-link-type=\"idl\" data-lt=\"SerialPort\" href=\"https://wicg.github.io/serial/#dom-serialport\" class=\"internalDFN\" id=\"ref-for-dom-serialport-6\"><code>SerialPort</code></a>s\n              representing the ports in <var>availablePorts</var>."
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a> of\n              <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a> using the <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-serial-port-task-source\" class=\"internalDFN\" id=\"ref-for-dfn-serial-port-task-source-3\">serial port task source</a> to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\">resolve</a>\n              <var data-type=\"Promise\">promise</var> with <var>ports</var>."
            }
          ]
        },
        {
          "html": "Return <var data-type=\"Promise\">promise</var>."
        }
      ]
    },
    {
      "html": "When a serial port that the user has allowed the site to access as the\n          result of a previous call to <a data-link-type=\"idl\" data-lt=\"requestPort()\" href=\"https://wicg.github.io/serial/#dom-serial-requestport\" class=\"internalDFN\" id=\"ref-for-dom-serial-requestport-5\"><code>requestPort</code></a><code>()</code> becomes\n          <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-logically-connected\" class=\"internalDFN\" id=\"ref-for-dfn-logically-connected-1\">logically connected</a>, run the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var data-type=\"SerialPort\">port</var> be a <a data-link-type=\"idl\" data-lt=\"SerialPort\" href=\"https://wicg.github.io/serial/#dom-serialport\" class=\"internalDFN\" id=\"ref-for-dom-serialport-12\"><code>SerialPort</code></a> representing the port."
        },
        {
          "html": "Set <var data-type=\"SerialPort\">port</var>.<a data-link-type=\"attribute\" data-lt=\"[[connected]]\" href=\"https://wicg.github.io/serial/#dfn-connected\" class=\"internalDFN\" id=\"ref-for-dfn-connected-1\"><code>[[connected]]</code></a> to <code>true</code>."
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-event-fire\">Fire an event</a> named <a data-link-type=\"idl\" data-lt=\"connect\" href=\"https://wicg.github.io/serial/#dfn-connect\" class=\"internalDFN\" id=\"ref-for-dfn-connect-2\"><code>connect</code></a> at <var data-type=\"SerialPort\">port</var> with its\n          <a data-link-type=\"attribute\" href=\"https://dom.spec.whatwg.org/#dom-event-bubbles\"><code>bubbles</code></a> attribute initialized to <code>true</code>."
        }
      ]
    },
    {
      "html": "When a serial port that the user has allowed the site to access as the\n          result of a previous call to <a data-link-type=\"idl\" data-lt=\"requestPort()\" href=\"https://wicg.github.io/serial/#dom-serial-requestport\" class=\"internalDFN\" id=\"ref-for-dom-serial-requestport-6\"><code>requestPort</code></a><code>()</code> is no longer\n          <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-logically-connected\" class=\"internalDFN\" id=\"ref-for-dfn-logically-connected-2\">logically connected</a>, run the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var data-type=\"SerialPort\">port</var> be a <a data-link-type=\"idl\" data-lt=\"SerialPort\" href=\"https://wicg.github.io/serial/#dom-serialport\" class=\"internalDFN\" id=\"ref-for-dom-serialport-13\"><code>SerialPort</code></a> representing the port."
        },
        {
          "html": "Set <var data-type=\"SerialPort\">port</var>.<a data-link-type=\"attribute\" data-lt=\"[[connected]]\" href=\"https://wicg.github.io/serial/#dfn-connected\" class=\"internalDFN\" id=\"ref-for-dfn-connected-2\"><code>[[connected]]</code></a> to <code>false</code>."
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-event-fire\">Fire an event</a> named <a data-link-type=\"idl\" data-lt=\"disconnect\" href=\"https://wicg.github.io/serial/#dfn-disconnect\" class=\"internalDFN\" id=\"ref-for-dfn-disconnect-2\"><code>disconnect</code></a> at <var data-type=\"SerialPort\">port</var> with its\n          <a data-link-type=\"attribute\" href=\"https://dom.spec.whatwg.org/#dom-event-bubbles\"><code>bubbles</code></a> attribute initialized to <code>true</code>."
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var data-type=\"SerialPortInfo\">info</var> be an empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ordered-map\">ordered map</a>."
        },
        {
          "html": "If the port is part of a USB device, perform the following steps:",
          "rationale": "set",
          "steps": [
            {
              "html": "Set <var data-type=\"SerialPortInfo\">info</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialportinfo-usbvendorid\" class=\"internalDFN\" id=\"ref-for-dom-serialportinfo-usbvendorid-2\"><code>usbVendorId</code></a>\"] to the vendor ID\n              of the device."
            },
            {
              "html": "Set <var data-type=\"SerialPortInfo\">info</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialportinfo-usbproductid\" class=\"internalDFN\" id=\"ref-for-dom-serialportinfo-usbproductid-2\"><code>usbProductId</code></a>\"] to the product\n              ID of the device."
            }
          ]
        },
        {
          "html": "If the port is a service on a Bluetooth device, perform the\n          following steps:",
          "rationale": "set",
          "steps": [
            {
              "html": "Set <var data-type=\"SerialPortInfo\">info</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialportinfo-bluetoothserviceclassid\" class=\"internalDFN\" id=\"ref-for-dom-serialportinfo-bluetoothserviceclassid-2\"><code>bluetoothServiceClassId</code></a>\"] to\n              the service class UUID of the Bluetooth service."
            }
          ]
        },
        {
          "html": "Return <var data-type=\"SerialPortInfo\">info</var>."
        }
      ]
    },
    {
      "html": "The <a data-link-type=\"idl\" data-lt=\"open()\" href=\"https://wicg.github.io/serial/#dom-serialport-open\" class=\"internalDFN\" id=\"ref-for-dom-serialport-open-3\"><code>open</code></a><code>()</code> method steps are:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var>promise</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\">a new promise</a>."
        },
        {
          "html": "If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[state]]\" href=\"https://wicg.github.io/serial/#dfn-state\" class=\"internalDFN\" id=\"ref-for-dfn-state-1\"><code>[[state]]</code></a> is not <code>\"closed\"</code>, reject\n          <var>promise</var> with an \"<a data-link-type=\"exception\" data-lt=\"InvalidStateError\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\"><code>InvalidStateError</code></a>\" <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\"><code>DOMException</code></a> and return\n          <var>promise</var>."
        },
        {
          "html": "If <var>options</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialoptions-databits\" class=\"internalDFN\" id=\"ref-for-dom-serialoptions-databits-1\"><code>dataBits</code></a>\"] is not 7 or 8, reject\n          <var>promise</var> with <a data-link-type=\"exception\" data-lt=\"TypeError\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\"><code>TypeError</code></a> and return <var>promise</var>."
        },
        {
          "html": "If <var>options</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialoptions-stopbits\" class=\"internalDFN\" id=\"ref-for-dom-serialoptions-stopbits-1\"><code>stopBits</code></a>\"] is not 1 or 2, reject\n          <var>promise</var> with <a data-link-type=\"exception\" data-lt=\"TypeError\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\"><code>TypeError</code></a> and return <var>promise</var>."
        },
        {
          "html": "If <var>options</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialoptions-buffersize\" class=\"internalDFN\" id=\"ref-for-dom-serialoptions-buffersize-1\"><code>bufferSize</code></a>\"] is 0, reject\n          <var>promise</var> with <a data-link-type=\"exception\" data-lt=\"TypeError\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\"><code>TypeError</code></a> and return <var>promise</var>."
        },
        {
          "html": "Optionally, if <var>options</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialoptions-buffersize\" class=\"internalDFN\" id=\"ref-for-dom-serialoptions-buffersize-2\"><code>bufferSize</code></a>\"] is\n          larger than the implementation is able to support, reject <var>promise</var>\n          with a <a data-link-type=\"exception\" data-lt=\"TypeError\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\"><code>TypeError</code></a> and return <var>promise</var>."
        },
        {
          "html": "Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[state]]\" href=\"https://wicg.github.io/serial/#dfn-state\" class=\"internalDFN\" id=\"ref-for-dfn-state-2\"><code>[[state]]</code></a> to <code>\"opening\"</code>."
        },
        {
          "html": "Perform the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.",
          "rationale": "invoke",
          "steps": [
            {
              "html": "Invoke the operating system to open the serial port using the\n              connection parameters (or their defaults) specified in <var>options</var>."
            },
            {
              "html": "If this fails for any reason, <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a> on the\n              <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a> using the <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-serial-port-task-source\" class=\"internalDFN\" id=\"ref-for-dfn-serial-port-task-source-4\">serial port task source</a> to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\">reject</a> <var>promise</var> with a \"<a data-link-type=\"exception\" data-lt=\"NetworkError\" href=\"https://webidl.spec.whatwg.org/#networkerror\"><code>NetworkError</code></a>\"\n              <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\"><code>DOMException</code></a> and abort these steps."
            },
            {
              "html": "Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[state]]\" href=\"https://wicg.github.io/serial/#dfn-state\" class=\"internalDFN\" id=\"ref-for-dfn-state-3\"><code>[[state]]</code></a> to <code>\"opened\"</code>."
            },
            {
              "html": "Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[bufferSize]]\" href=\"https://wicg.github.io/serial/#dfn-buffersize\" class=\"internalDFN\" id=\"ref-for-dfn-buffersize-1\"><code>[[bufferSize]]</code></a> to\n              <var>options</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialoptions-buffersize\" class=\"internalDFN\" id=\"ref-for-dom-serialoptions-buffersize-3\"><code>bufferSize</code></a>\"]."
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a> of\n              <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a> using the <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-serial-port-task-source\" class=\"internalDFN\" id=\"ref-for-dfn-serial-port-task-source-5\">serial port task source</a> to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\">resolve</a>\n              <var>promise</var> with <code>undefined</code>."
            }
          ]
        },
        {
          "html": "Return <var>promise</var>."
        }
      ]
    },
    {
      "html": "The <a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialport-connected\" class=\"internalDFN\" id=\"ref-for-dom-serialport-connected-2\"><code>connected</code></a> getter steps are:",
      "rationale": "return",
      "steps": [
        {
          "html": "Return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[connected]]\" href=\"https://wicg.github.io/serial/#dfn-connected\" class=\"internalDFN\" id=\"ref-for-dfn-connected-3\"><code>[[connected]]</code></a>."
        }
      ]
    },
    {
      "html": "The <a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialport-readable\" class=\"internalDFN\" id=\"ref-for-dom-serialport-readable-6\"><code>readable</code></a> getter steps are:",
      "rationale": "if",
      "steps": [
        {
          "html": "If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-1\"><code>[[readable]]</code></a> is not <code>null</code>, return\n          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-2\"><code>[[readable]]</code></a>."
        },
        {
          "html": "If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[state]]\" href=\"https://wicg.github.io/serial/#dfn-state\" class=\"internalDFN\" id=\"ref-for-dfn-state-4\"><code>[[state]]</code></a> is not <code>\"opened\"</code>, return\n          <code>null</code>."
        },
        {
          "html": "If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readFatal]]\" href=\"https://wicg.github.io/serial/#dfn-readfatal\" class=\"internalDFN\" id=\"ref-for-dfn-readfatal-1\"><code>[[readFatal]]</code></a> is <code>true</code>, return\n          <code>null</code>."
        },
        {
          "html": "Let <var>stream</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\">new</a> <a data-link-type=\"interface\" data-lt=\"ReadableStream\" href=\"https://streams.spec.whatwg.org/#readablestream\"><code>ReadableStream</code></a>."
        },
        {
          "html": "Let <var>pullAlgorithm</var> be the following steps:",
          "rationale": "let",
          "steps": [
            {
              "html": "Let <var>desiredSize</var> be the <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-desired-size-to-fill-up-to-the-high-water-mark\">desired size to fill up to the high water mark</a> for\n              <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-3\"><code>[[readable]]</code></a>."
            },
            {
              "html": "If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-4\"><code>[[readable]]</code></a>'s\n              <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-current-byob-request-view\">current BYOB request view</a> is non-null, then\n              set <var>desiredSize</var> to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-5\"><code>[[readable]]</code></a>'s\n              <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-current-byob-request-view\">current BYOB request view</a>'s\n              <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#buffersource-byte-length\">byte length</a>."
            },
            {
              "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>:",
              "rationale": "invoke",
              "steps": [
                {
                  "html": "Invoke the operating system to read up to <var>desiredSize</var>\n                  bytes from the port, putting the result in the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> <var>bytes</var>."
                },
                {
                  "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                  of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a> using the <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-serial-port-task-source\" class=\"internalDFN\" id=\"ref-for-dfn-serial-port-task-source-6\">serial port task source</a> to run the\n                  following steps:",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "If no errors were encountered, then:",
                      "rationale": "if",
                      "steps": [
                        {
                          "html": "If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-6\"><code>[[readable]]</code></a>'s\n                          <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-current-byob-request-view\">current BYOB request view</a> is\n                          non-null, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#arraybufferview-write\">write</a> <var>bytes</var> into\n                          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-7\"><code>[[readable]]</code></a>'s\n                          <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-current-byob-request-view\">current BYOB request view</a>, and set\n                          <var>view</var> to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-8\"><code>[[readable]]</code></a>'s\n                          <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-current-byob-request-view\">current BYOB request view</a>."
                        },
                        {
                          "html": "Otherwise, set <var>view</var> to the result of\n                          <a data-link-type=\"dfn\" data-lt=\"create\" href=\"https://webidl.spec.whatwg.org/#arraybufferview-create\">creating</a> a <a data-link-type=\"interface\" data-lt=\"Uint8Array\" href=\"https://webidl.spec.whatwg.org/#idl-Uint8Array\"><code>Uint8Array</code></a>\n                          from <var>bytes</var> in <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>'s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\">relevant Realm</a>."
                        },
                        {
                          "html": "<a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-enqueue\">Enqueue</a> <var>view</var> into\n                          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-9\"><code>[[readable]]</code></a>."
                        }
                      ]
                    },
                    {
                      "html": "If a buffer overrun condition was encountered, invoke\n                      <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-error\">error</a> on\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-10\"><code>[[readable]]</code></a> with a\n                      \"<code>BufferOverrunError</code>\" <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\"><code>DOMException</code></a> and\n                      invoke the steps to <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-handle-closing-the-readable-stream\" class=\"internalDFN\" id=\"ref-for-dfn-handle-closing-the-readable-stream-1\">handle closing the readable stream</a>."
                    },
                    {
                      "html": "If a break condition was encountered, invoke\n                      <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-error\">error</a> on\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-11\"><code>[[readable]]</code></a> with a\n                      \"<code>BreakError</code>\" <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\"><code>DOMException</code></a> and invoke the\n                      steps to <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-handle-closing-the-readable-stream\" class=\"internalDFN\" id=\"ref-for-dfn-handle-closing-the-readable-stream-2\">handle closing the readable stream</a>."
                    },
                    {
                      "html": "If a framing error was encountered, invoke\n                      <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-error\">error</a> on\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-12\"><code>[[readable]]</code></a> with a\n                      \"<code>FramingError</code>\" <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\"><code>DOMException</code></a> and invoke\n                      the steps to <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-handle-closing-the-readable-stream\" class=\"internalDFN\" id=\"ref-for-dfn-handle-closing-the-readable-stream-3\">handle closing the readable stream</a>."
                    },
                    {
                      "html": "If a parity error was encountered, invoke\n                      <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-error\">error</a> on\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-13\"><code>[[readable]]</code></a> with a\n                      \"<code>ParityError</code>\" <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\"><code>DOMException</code></a> and invoke\n                      the steps to <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-handle-closing-the-readable-stream\" class=\"internalDFN\" id=\"ref-for-dfn-handle-closing-the-readable-stream-4\">handle closing the readable stream</a>."
                    },
                    {
                      "html": "If an operating system error was encountered, invoke\n                      <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-error\">error</a> on\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-14\"><code>[[readable]]</code></a> with an\n                      \"<a data-link-type=\"exception\" data-lt=\"UnknownError\" href=\"https://webidl.spec.whatwg.org/#unknownerror\"><code>UnknownError</code></a>\" <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\"><code>DOMException</code></a> and invoke the steps\n                      to <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-handle-closing-the-readable-stream\" class=\"internalDFN\" id=\"ref-for-dfn-handle-closing-the-readable-stream-5\">handle closing the readable stream</a>."
                    },
                    {
                      "html": "If <var>the port was disconnected</var>, run the following\n                      steps:",
                      "rationale": "set",
                      "steps": [
                        {
                          "html": "Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readFatal]]\" href=\"https://wicg.github.io/serial/#dfn-readfatal\" class=\"internalDFN\" id=\"ref-for-dfn-readfatal-2\"><code>[[readFatal]]</code></a> to\n                          <code>true</code>,"
                        },
                        {
                          "html": "Invoke <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-error\">error</a> on\n                          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-15\"><code>[[readable]]</code></a> with a\n                          \"<a data-link-type=\"exception\" data-lt=\"NetworkError\" href=\"https://webidl.spec.whatwg.org/#networkerror\"><code>NetworkError</code></a>\" <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\"><code>DOMException</code></a>."
                        },
                        {
                          "html": "Invoke the steps to <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-handle-closing-the-readable-stream\" class=\"internalDFN\" id=\"ref-for-dfn-handle-closing-the-readable-stream-6\">handle closing the readable stream</a>."
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "html": "Return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-resolved-with\">a promise resolved with</a> <code>undefined</code>."
            }
          ]
        },
        {
          "html": "Let <var>cancelAlgorithm</var> be the following steps:",
          "rationale": "let",
          "steps": [
            {
              "html": "Let <var>promise</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\">a new promise</a>."
            },
            {
              "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.",
              "rationale": "invoke",
              "steps": [
                {
                  "html": "Invoke the operating system to discard the contents of\n                  all software and hardware receive buffers for the port."
                },
                {
                  "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                  of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a> using the <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-serial-port-task-source\" class=\"internalDFN\" id=\"ref-for-dfn-serial-port-task-source-7\">serial port task source</a> to run the\n                  following steps:",
                  "rationale": "invoke",
                  "steps": [
                    {
                      "html": "Invoke the steps to <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-handle-closing-the-readable-stream\" class=\"internalDFN\" id=\"ref-for-dfn-handle-closing-the-readable-stream-7\">handle closing the readable stream</a>."
                    },
                    {
                      "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\">Resolve</a> <var>promise</var> with <code>undefined</code>."
                    }
                  ]
                }
              ]
            },
            {
              "html": "Return <var>promise</var>."
            }
          ]
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-set-up-with-byte-reading-support\">Set up with byte reading support</a> <var>stream</var> with\n          <i><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-set-up-with-byte-reading-support-pullalgorithm\">pullAlgorithm</a></i> set to <var>pullAlgorithm</var>,\n          <i><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-set-up-with-byte-reading-support-cancelalgorithm\">cancelAlgorithm</a></i> set to <var>cancelAlgorithm</var>, and\n          <i><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-set-up-with-byte-reading-support-highwatermark\">highWaterMark</a></i> set to\n          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[bufferSize]]\" href=\"https://wicg.github.io/serial/#dfn-buffersize\" class=\"internalDFN\" id=\"ref-for-dfn-buffersize-2\"><code>[[bufferSize]]</code></a>."
        },
        {
          "html": "Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-16\"><code>[[readable]]</code></a> to <var>stream</var>."
        },
        {
          "html": "Return <var>stream</var>."
        }
      ]
    },
    {
      "html": "The <a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialport-readable\" class=\"internalDFN\" id=\"ref-for-dom-serialport-readable-6\"><code>readable</code></a> getter steps are:",
      "rationale": "set",
      "steps": [
        {
          "html": "Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-17\"><code>[[readable]]</code></a> to <code>null</code>."
        },
        {
          "html": "If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[writable]]\" href=\"https://wicg.github.io/serial/#dfn-writable\" class=\"internalDFN\" id=\"ref-for-dfn-writable-1\"><code>[[writable]]</code></a> is <code>null</code> and\n          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[pendingClosePromise]]\" href=\"https://wicg.github.io/serial/#dfn-pendingclosepromise\" class=\"internalDFN\" id=\"ref-for-dfn-pendingclosepromise-1\"><code>[[pendingClosePromise]]</code></a> is not <code>null</code>,\n          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\">resolve</a> <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[pendingClosePromise]]\" href=\"https://wicg.github.io/serial/#dfn-pendingclosepromise\" class=\"internalDFN\" id=\"ref-for-dfn-pendingclosepromise-2\"><code>[[pendingClosePromise]]</code></a> with\n          <code>undefined</code>."
        }
      ]
    },
    {
      "html": "The <a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialport-writable\" class=\"internalDFN\" id=\"ref-for-dom-serialport-writable-4\"><code>writable</code></a> getter steps are:",
      "rationale": "if",
      "steps": [
        {
          "html": "If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[writable]]\" href=\"https://wicg.github.io/serial/#dfn-writable\" class=\"internalDFN\" id=\"ref-for-dfn-writable-2\"><code>[[writable]]</code></a> is not <code>null</code>, return\n          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[writable]]\" href=\"https://wicg.github.io/serial/#dfn-writable\" class=\"internalDFN\" id=\"ref-for-dfn-writable-3\"><code>[[writable]]</code></a>."
        },
        {
          "html": "If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[state]]\" href=\"https://wicg.github.io/serial/#dfn-state\" class=\"internalDFN\" id=\"ref-for-dfn-state-6\"><code>[[state]]</code></a> is not <code>\"opened\"</code>, return\n          <code>null</code>."
        },
        {
          "html": "If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[writeFatal]]\" href=\"https://wicg.github.io/serial/#dfn-writefatal\" class=\"internalDFN\" id=\"ref-for-dfn-writefatal-1\"><code>[[writeFatal]]</code></a> is <code>true</code>, return\n          <code>null</code>."
        },
        {
          "html": "Let <var data-type=\"WritableStream\">stream</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\">new</a> <a data-link-type=\"interface\" data-lt=\"WritableStream\" href=\"https://streams.spec.whatwg.org/#writablestream\"><code>WritableStream</code></a>."
        },
        {
          "html": "Let <var data-type=\"AbortSignal\">signal</var> be <var data-type=\"WritableStream\">stream</var>'s <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#writablestream-signal\">signal</a>."
        },
        {
          "html": "Let <var>writeAlgorithm</var> be the following steps, given <var>chunk</var>:",
          "rationale": "let",
          "steps": [
            {
              "html": "Let <var data-type=\"Promise\">promise</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\">a new promise</a>."
            },
            {
              "html": "Assert: <var data-type=\"AbortSignal\">signal</var> is not <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#abortsignal-aborted\">aborted</a>."
            },
            {
              "html": "If <var>chunk</var> cannot be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-convert-ecmascript-to-idl-value\">converted to an IDL value</a> of type\n              <a data-link-type=\"typedef\" data-lt=\"BufferSource\" href=\"https://webidl.spec.whatwg.org/#BufferSource\"><code>BufferSource</code></a>, reject <var data-type=\"Promise\">promise</var> with a <a data-link-type=\"exception\" data-lt=\"TypeError\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\"><code>TypeError</code></a> and\n              return <var data-type=\"Promise\">promise</var>. Otherwise, save the result of the conversion in\n              <var data-type=\"BufferSource\">source</var>."
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-get-buffer-source-copy\">Get a copy of the buffer source</a> <var data-type=\"BufferSource\">source</var> and save the\n              result in <var>bytes</var>."
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">In parallel</a>, run the following steps:",
              "rationale": "invoke",
              "steps": [
                {
                  "html": "Invoke the operating system to write <var>bytes</var> to the port.\n                  Alternately, store the chunk for future coalescing."
                },
                {
                  "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                  of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a> using the <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-serial-port-task-source\" class=\"internalDFN\" id=\"ref-for-dfn-serial-port-task-source-8\">serial port task source</a> to run the\n                  following steps:",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "If the chunk was successfully written, or was stored\n                      for future coalescing, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\">resolve</a> <var data-type=\"Promise\">promise</var> with\n                      <code>undefined</code>."
                    },
                    {
                      "html": "If an operating system error was encountered,\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\">reject</a> <var data-type=\"Promise\">promise</var> with an \"<a data-link-type=\"exception\" data-lt=\"UnknownError\" href=\"https://webidl.spec.whatwg.org/#unknownerror\"><code>UnknownError</code></a>\"\n                      <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\"><code>DOMException</code></a>."
                    },
                    {
                      "html": "If <var>the port was disconnected</var>, run the following\n                      steps:",
                      "rationale": "set",
                      "steps": [
                        {
                          "html": "Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[writeFatal]]\" href=\"https://wicg.github.io/serial/#dfn-writefatal\" class=\"internalDFN\" id=\"ref-for-dfn-writefatal-2\"><code>[[writeFatal]]</code></a> to\n                          <code>true</code>."
                        },
                        {
                          "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\">Reject</a> <var data-type=\"Promise\">promise</var> with a \"<a data-link-type=\"exception\" data-lt=\"NetworkError\" href=\"https://webidl.spec.whatwg.org/#networkerror\"><code>NetworkError</code></a>\"\n                          <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\"><code>DOMException</code></a>."
                        },
                        {
                          "html": "Invoke the steps to <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-handle-closing-the-writable-stream\" class=\"internalDFN\" id=\"ref-for-dfn-handle-closing-the-writable-stream-1\">handle closing the writable stream</a>."
                        }
                      ]
                    },
                    {
                      "html": "If <var data-type=\"AbortSignal\">signal</var> is <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#abortsignal-aborted\">aborted</a>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\">reject</a>\n                      <var data-type=\"Promise\">promise</var> with <var data-type=\"AbortSignal\">signal</var>'s <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#abortsignal-abort-reason\">abort reason</a>."
                    }
                  ]
                }
              ]
            },
            {
              "html": "Return <var data-type=\"Promise\">promise</var>."
            }
          ]
        },
        {
          "html": "Let <var>abortAlgorithm</var> be the following steps:",
          "rationale": "let",
          "steps": [
            {
              "html": "Let <var data-type=\"Promise\">promise</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\">a new promise</a>."
            },
            {
              "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.",
              "rationale": "invoke",
              "steps": [
                {
                  "html": "Invoke the operating system to discard the contents of\n                  all software and hardware transmit buffers for the port."
                },
                {
                  "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                  of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a> using the <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-serial-port-task-source\" class=\"internalDFN\" id=\"ref-for-dfn-serial-port-task-source-9\">serial port task source</a> to run the\n                  following steps:",
                  "rationale": "invoke",
                  "steps": [
                    {
                      "html": "Invoke the steps to <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-handle-closing-the-writable-stream\" class=\"internalDFN\" id=\"ref-for-dfn-handle-closing-the-writable-stream-2\">handle closing the writable stream</a>."
                    },
                    {
                      "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\">Resolve</a> <var data-type=\"Promise\">promise</var> with <code>undefined</code>."
                    }
                  ]
                }
              ]
            },
            {
              "html": "Return <var data-type=\"Promise\">promise</var>."
            }
          ]
        },
        {
          "html": "Let <var>closeAlgorithm</var> be the following steps:",
          "rationale": "let",
          "steps": [
            {
              "html": "Let <var data-type=\"Promise\">promise</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\">a new promise</a>."
            },
            {
              "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.",
              "rationale": "invoke",
              "steps": [
                {
                  "html": "Invoke the operating system to flush the contents of all\n                  software and hardware transmit buffers for the port."
                },
                {
                  "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                  of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a> using the <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-serial-port-task-source\" class=\"internalDFN\" id=\"ref-for-dfn-serial-port-task-source-10\">serial port task source</a> to run the\n                  following steps:",
                  "rationale": "invoke",
                  "steps": [
                    {
                      "html": "Invoke the steps to <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-handle-closing-the-writable-stream\" class=\"internalDFN\" id=\"ref-for-dfn-handle-closing-the-writable-stream-3\">handle closing the writable stream</a>."
                    },
                    {
                      "html": "If <var data-type=\"AbortSignal\">signal</var> is <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#abortsignal-aborted\">aborted</a>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\">reject</a>\n                      <var data-type=\"Promise\">promise</var> with <var data-type=\"AbortSignal\">signal</var>'s <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#abortsignal-abort-reason\">abort reason</a>."
                    },
                    {
                      "html": "Otherwise, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\">resolve</a> <var data-type=\"Promise\">promise</var> with <code>undefined</code>."
                    }
                  ]
                }
              ]
            },
            {
              "html": "Return <var data-type=\"Promise\">promise</var>."
            }
          ]
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#writablestream-set-up\">Set up</a> <var data-type=\"WritableStream\">stream</var> with <a href=\"https://streams.spec.whatwg.org/#writablestream-set-up-writealgorithm\">\n            writeAlgorithm</a> set to <var>writeAlgorithm</var>, <a href=\"https://streams.spec.whatwg.org/#writablestream-set-up-abortalgorithm\">\n            abortAlgorithm</a> set to <var>abortAlgorithm</var>, <a href=\"https://streams.spec.whatwg.org/#writablestream-set-up-closealgorithm\">\n            closeAlgorithm</a> set to <var>closeAlgorithm</var>, <a href=\"https://streams.spec.whatwg.org/#writablestream-set-up-highwatermark\">\n            highWaterMark</a> set to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[bufferSize]]\" href=\"https://wicg.github.io/serial/#dfn-buffersize\" class=\"internalDFN\" id=\"ref-for-dfn-buffersize-3\"><code>[[bufferSize]]</code></a>,\n            and <a href=\"https://streams.spec.whatwg.org/#writablestream-set-up-sizealgorithm\">\n            sizeAlgorithm</a> set to a byte-counting size algorithm."
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#abortsignal-add\">Add</a> the following abort steps to <var data-type=\"AbortSignal\">signal</var>:",
          "rationale": "cause",
          "steps": [
            {
              "html": "Cause any invocation of the operating system to write to the\n              port to return as soon as possible no matter how much data has\n              been written."
            }
          ]
        },
        {
          "html": "Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[writable]]\" href=\"https://wicg.github.io/serial/#dfn-writable\" class=\"internalDFN\" id=\"ref-for-dfn-writable-4\"><code>[[writable]]</code></a> to <var data-type=\"WritableStream\">stream</var>."
        },
        {
          "html": "Return <var data-type=\"WritableStream\">stream</var>."
        }
      ]
    },
    {
      "html": "The <a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialport-writable\" class=\"internalDFN\" id=\"ref-for-dom-serialport-writable-4\"><code>writable</code></a> getter steps are:",
      "rationale": "set",
      "steps": [
        {
          "html": "Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[writable]]\" href=\"https://wicg.github.io/serial/#dfn-writable\" class=\"internalDFN\" id=\"ref-for-dfn-writable-5\"><code>[[writable]]</code></a> to <code>null</code>."
        },
        {
          "html": "If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-18\"><code>[[readable]]</code></a> is <code>null</code> and\n          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[pendingClosePromise]]\" href=\"https://wicg.github.io/serial/#dfn-pendingclosepromise\" class=\"internalDFN\" id=\"ref-for-dfn-pendingclosepromise-3\"><code>[[pendingClosePromise]]</code></a> is not <code>null</code>,\n          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\">resolve</a> <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[pendingClosePromise]]\" href=\"https://wicg.github.io/serial/#dfn-pendingclosepromise\" class=\"internalDFN\" id=\"ref-for-dfn-pendingclosepromise-4\"><code>[[pendingClosePromise]]</code></a> with\n          <code>undefined</code>."
        }
      ]
    },
    {
      "html": "The <a data-link-type=\"idl\" data-lt=\"setSignals()\" href=\"https://wicg.github.io/serial/#dom-serialport-setsignals\" class=\"internalDFN\" id=\"ref-for-dom-serialport-setsignals-2\"><code>setSignals</code></a><code>()</code> method steps are:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var>promise</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\">a new promise</a>."
        },
        {
          "html": "If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[state]]\" href=\"https://wicg.github.io/serial/#dfn-state\" class=\"internalDFN\" id=\"ref-for-dfn-state-8\"><code>[[state]]</code></a> is not <code>\"opened\"</code>, reject\n          <var>promise</var> with an \"<a data-link-type=\"exception\" data-lt=\"InvalidStateError\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\"><code>InvalidStateError</code></a>\" <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\"><code>DOMException</code></a> and return\n          <var>promise</var>."
        },
        {
          "html": "If all of the specified members of <var>signals</var> are not present\n          reject <var>promise</var> with <a data-link-type=\"exception\" data-lt=\"TypeError\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\"><code>TypeError</code></a> and return <var>promise</var>."
        },
        {
          "html": "Perform the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>:",
          "rationale": "if",
          "steps": [
            {
              "html": "If <var>signals</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialoutputsignals-dataterminalready\" class=\"internalDFN\" id=\"ref-for-dom-serialoutputsignals-dataterminalready-1\"><code>dataTerminalReady</code></a>\"] is\n              present, invoke the operating system to either assert (if <code>true</code>)\n              or deassert (if <code>false</code>) the \"data terminal ready\" or \"DTR\"\n              signal on the serial port."
            },
            {
              "html": "If <var>signals</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialoutputsignals-requesttosend\" class=\"internalDFN\" id=\"ref-for-dom-serialoutputsignals-requesttosend-1\"><code>requestToSend</code></a>\"] is\n              present, invoke the operating system to either assert (if <code>true</code>)\n              or deassert (if <code>false</code>) the \"request to send\" or \"RTS\" signal on\n              the serial port."
            },
            {
              "html": "If <var>signals</var>[\"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialoutputsignals-break\" class=\"internalDFN\" id=\"ref-for-dom-serialoutputsignals-break-1\"><code>break</code></a>\"] is present,\n              invoke the operating system to either assert (if <code>true</code>) or\n              deassert (if <code>false</code>) the \"break\" signal on the serial port."
            },
            {
              "html": "If the operating system fails to change the state of any of\n              these signals for any reason, <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a> on the\n              <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a> using the <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-serial-port-task-source\" class=\"internalDFN\" id=\"ref-for-dfn-serial-port-task-source-11\">serial port task source</a> to reject <var>promise</var> with a \"<a data-link-type=\"exception\" data-lt=\"NetworkError\" href=\"https://webidl.spec.whatwg.org/#networkerror\"><code>NetworkError</code></a>\"\n              <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\"><code>DOMException</code></a>."
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a> of\n              <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a> using the <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-serial-port-task-source\" class=\"internalDFN\" id=\"ref-for-dfn-serial-port-task-source-12\">serial port task source</a> to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\">resolve</a>\n              <var>promise</var> with <code>undefined</code>."
            }
          ]
        },
        {
          "html": "Return <var>promise</var>."
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var data-type=\"Promise\">promise</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\">a new promise</a>."
        },
        {
          "html": "If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[state]]\" href=\"https://wicg.github.io/serial/#dfn-state\" class=\"internalDFN\" id=\"ref-for-dfn-state-9\"><code>[[state]]</code></a> is not <code>\"opened\"</code>, reject\n          <var data-type=\"Promise\">promise</var> with an \"<a data-link-type=\"exception\" data-lt=\"InvalidStateError\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\"><code>InvalidStateError</code></a>\" <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\"><code>DOMException</code></a> and return\n          <var data-type=\"Promise\">promise</var>."
        },
        {
          "html": "Perform the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>:",
          "rationale": "query",
          "steps": [
            {
              "html": "Query the operating system for the status of the control\n              signals that may be asserted by the device connected to the\n              serial port."
            },
            {
              "html": "If the operating system fails to determine the status of\n              these signals for any reason, <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a> on the\n              <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a> using the <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-serial-port-task-source\" class=\"internalDFN\" id=\"ref-for-dfn-serial-port-task-source-13\">serial port task source</a> to reject <var data-type=\"Promise\">promise</var> with a \"<a data-link-type=\"exception\" data-lt=\"NetworkError\" href=\"https://webidl.spec.whatwg.org/#networkerror\"><code>NetworkError</code></a>\"\n              <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\"><code>DOMException</code></a> and abort these steps."
            },
            {
              "html": "Let <var>dataCarrierDetect</var> be <code>true</code> if the \"data carrier\n              detect\" or \"DCD\" signal has been asserted by the device, and\n              <code>false</code> otherwise."
            },
            {
              "html": "Let <var>clearToSend</var> be <code>true</code> if the \"clear to send\" or \"CTS\"\n              signal has been asserted by the device, and <code>false</code> otherwise."
            },
            {
              "html": "Let <var>ringIndicator</var> be <code>true</code> if the \"ring indicator\" or \"RI\"\n              signal has been asserted by the device, and <code>false</code> otherwise."
            },
            {
              "html": "Let <var>dataSetReady</var> be <code>true</code> if the \"data set ready\" or \"DSR\"\n              signal has been asserted by the device, and <code>false</code> otherwise."
            },
            {
              "html": "Let <var>signals</var> be the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ordered-map\">ordered map</a> «[\n              \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialinputsignals-datacarrierdetect\" class=\"internalDFN\" id=\"ref-for-dom-serialinputsignals-datacarrierdetect-1\"><code>dataCarrierDetect</code></a>\" → <var>dataCarrierDetect</var>,\n              \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialinputsignals-cleartosend\" class=\"internalDFN\" id=\"ref-for-dom-serialinputsignals-cleartosend-1\"><code>clearToSend</code></a>\" → <var>clearToSend</var>,\n              \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialinputsignals-ringindicator\" class=\"internalDFN\" id=\"ref-for-dom-serialinputsignals-ringindicator-1\"><code>ringIndicator</code></a>\" → <var>ringIndicator</var>,\n              \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/serial/#dom-serialinputsignals-datasetready\" class=\"internalDFN\" id=\"ref-for-dom-serialinputsignals-datasetready-1\"><code>dataSetReady</code></a>\" → <var>dataSetReady</var> ]»."
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a> of\n              <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a> using the <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-serial-port-task-source\" class=\"internalDFN\" id=\"ref-for-dfn-serial-port-task-source-14\">serial port task source</a> to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\">resolve</a>\n              <var data-type=\"Promise\">promise</var> with <var>signals</var>."
            }
          ]
        },
        {
          "html": "Return <var data-type=\"Promise\">promise</var>."
        }
      ]
    },
    {
      "html": "The <a data-link-type=\"idl\" data-lt=\"close()\" href=\"https://wicg.github.io/serial/#dom-serialport-close\" class=\"internalDFN\" id=\"ref-for-dom-serialport-close-7\"><code>close</code></a><code>()</code> method steps are:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var>promise</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\">a new promise</a>."
        },
        {
          "html": "If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[state]]\" href=\"https://wicg.github.io/serial/#dfn-state\" class=\"internalDFN\" id=\"ref-for-dfn-state-10\"><code>[[state]]</code></a> is not <code>\"opened\"</code>, reject\n          <var>promise</var> with an \"<a data-link-type=\"exception\" data-lt=\"InvalidStateError\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\"><code>InvalidStateError</code></a>\" <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\"><code>DOMException</code></a> and return\n          <var>promise</var>."
        },
        {
          "html": "Let <var data-type=\"Promise\">cancelPromise</var> be the result of invoking\n          <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-cancel\">cancel</a> on <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-19\"><code>[[readable]]</code></a> or\n          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-resolved-with\">a promise resolved with</a> <code>undefined</code> if\n          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-20\"><code>[[readable]]</code></a> is <code>null</code>."
        },
        {
          "html": "Let <var data-type=\"Promise\">abortPromise</var> be the result of invoking\n          <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#writablestream-abort\">abort</a> on <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[writable]]\" href=\"https://wicg.github.io/serial/#dfn-writable\" class=\"internalDFN\" id=\"ref-for-dfn-writable-6\"><code>[[writable]]</code></a> or\n          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-resolved-with\">a promise resolved with</a> <code>undefined</code> if\n          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[writable]]\" href=\"https://wicg.github.io/serial/#dfn-writable\" class=\"internalDFN\" id=\"ref-for-dfn-writable-7\"><code>[[writable]]</code></a> is <code>null</code>."
        },
        {
          "html": "Let <var>pendingClosePromise</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\">a new promise</a>."
        },
        {
          "html": "If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readable]]\" href=\"https://wicg.github.io/serial/#dfn-readable\" class=\"internalDFN\" id=\"ref-for-dfn-readable-21\"><code>[[readable]]</code></a> and\n          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[writable]]\" href=\"https://wicg.github.io/serial/#dfn-writable\" class=\"internalDFN\" id=\"ref-for-dfn-writable-8\"><code>[[writable]]</code></a> are <code>null</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\">resolve</a>\n          <var>pendingClosePromise</var> with <code>undefined</code>."
        },
        {
          "html": "Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[pendingClosePromise]]\" href=\"https://wicg.github.io/serial/#dfn-pendingclosepromise\" class=\"internalDFN\" id=\"ref-for-dfn-pendingclosepromise-5\"><code>[[pendingClosePromise]]</code></a> to\n          <var>pendingClosePromise</var>."
        },
        {
          "html": "Let <var data-type=\"Promise\">combinedPromise</var> be the result of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#waiting-for-all-promise\">getting a promise to wait for all</a> with «<var data-type=\"Promise\">cancelPromise</var>, <var data-type=\"Promise\">abortPromise</var>,\n          <var>pendingClosePromise</var>»."
        },
        {
          "html": "Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[state]]\" href=\"https://wicg.github.io/serial/#dfn-state\" class=\"internalDFN\" id=\"ref-for-dfn-state-11\"><code>[[state]]</code></a> to <code>\"closing\"</code>."
        },
        {
          "html": "If <var data-type=\"Promise\">combinedPromise</var> was fulfilled, then:",
          "rationale": "run",
          "steps": [
            {
              "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>:",
              "rationale": "invoke",
              "steps": [
                {
                  "html": "Invoke the operating system to close the serial port\n                      and release any associated resources."
                },
                {
                  "html": "Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[state]]\" href=\"https://wicg.github.io/serial/#dfn-state\" class=\"internalDFN\" id=\"ref-for-dfn-state-12\"><code>[[state]]</code></a> to <code>\"closed\"</code>."
                },
                {
                  "html": "Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[readFatal]]\" href=\"https://wicg.github.io/serial/#dfn-readfatal\" class=\"internalDFN\" id=\"ref-for-dfn-readfatal-3\"><code>[[readFatal]]</code></a> and\n                      <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[writeFatal]]\" href=\"https://wicg.github.io/serial/#dfn-writefatal\" class=\"internalDFN\" id=\"ref-for-dfn-writefatal-3\"><code>[[writeFatal]]</code></a> to <code>false</code>."
                },
                {
                  "html": "Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[pendingClosePromise]]\" href=\"https://wicg.github.io/serial/#dfn-pendingclosepromise\" class=\"internalDFN\" id=\"ref-for-dfn-pendingclosepromise-6\"><code>[[pendingClosePromise]]</code></a>\n                      to <code>null</code>."
                },
                {
                  "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a> using the <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-serial-port-task-source\" class=\"internalDFN\" id=\"ref-for-dfn-serial-port-task-source-15\">serial port task source</a> to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\">resolve</a> <var>promise</var> with <code>undefined</code>."
                }
              ]
            }
          ],
          "additional": [
            {
              "html": "If <var data-type=\"Promise\">combinedPromise</var> was rejected with reason <var>r</var>, then:",
              "rationale": "set",
              "steps": [
                {
                  "html": "Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[pendingClosePromise]]\" href=\"https://wicg.github.io/serial/#dfn-pendingclosepromise\" class=\"internalDFN\" id=\"ref-for-dfn-pendingclosepromise-7\"><code>[[pendingClosePromise]]</code></a> to\n                  <code>null</code>."
                },
                {
                  "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a>\n                  of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a> using the <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-serial-port-task-source\" class=\"internalDFN\" id=\"ref-for-dfn-serial-port-task-source-16\">serial port task source</a> to\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\">reject</a> <var>promise</var> with <var>r</var>."
                }
              ]
            }
          ]
        },
        {
          "html": "Return <var>promise</var>."
        }
      ]
    },
    {
      "html": "The <a data-link-type=\"idl\" data-lt=\"forget()\" href=\"https://wicg.github.io/serial/#dom-serialport-forget\" class=\"internalDFN\" id=\"ref-for-dom-serialport-forget-2\"><code>forget</code></a><code>()</code> method steps are:",
      "rationale": "if",
      "steps": [
        {
          "html": "If the user agent can't perform this action (e.g. permission was\n          granted by administrator policy), return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-resolved-with\">a promise resolved with</a>\n          <code>undefined</code>."
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>:",
          "rationale": "set",
          "steps": [
            {
              "html": "Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[state]]\" href=\"https://wicg.github.io/serial/#dfn-state\" class=\"internalDFN\" id=\"ref-for-dfn-state-13\"><code>[[state]]</code></a> to <code>\"forgetting\"</code>."
            },
            {
              "html": "Remove <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a> from the sequence of serial ports\n              on the system which the user has allowed the site to access as\n              the result of a previous call to <a data-link-type=\"idl\" data-lt=\"requestPort()\" href=\"https://wicg.github.io/serial/#dom-serial-requestport\" class=\"internalDFN\" id=\"ref-for-dom-serial-requestport-7\"><code>requestPort</code></a><code>()</code>."
            },
            {
              "html": "Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.<a data-link-type=\"attribute\" data-lt=\"[[state]]\" href=\"https://wicg.github.io/serial/#dfn-state\" class=\"internalDFN\" id=\"ref-for-dfn-state-14\"><code>[[state]]</code></a> to <code>\"forgotten\"</code>."
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\">relevant global object</a> of\n              <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a> using the <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-serial-port-task-source\" class=\"internalDFN\" id=\"ref-for-dfn-serial-port-task-source-17\">serial port task source</a> to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\">resolve</a>\n              <var>promise</var> with <code>undefined</code>."
            }
          ]
        },
        {
          "html": "Return <var>promise</var>."
        }
      ]
    },
    {
      "name": "blocked Bluetooth service class UUID",
      "href": "https://wicg.github.io/serial/#dfn-blocked-bluetooth-service-class-uuid",
      "html": "A {{BluetoothServiceUUID} <var data-type=\"BluetoothServiceUUID\">serviceUuid</var> is a\n        <dfn id=\"dfn-blocked-bluetooth-service-class-uuid\" tabindex=\"0\" aria-haspopup=\"dialog\" data-dfn-type=\"dfn\">blocked Bluetooth service class UUID</dfn> if the following steps\n        return <code>true</code>:",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <var data-type=\"UUID\">uuid</var> be the result of calling\n        <a data-link-type=\"interface\" data-lt=\"BluetoothUUID\" href=\"https://webbluetoothcg.github.io/web-bluetooth/#bluetoothuuid\"><code>BluetoothUUID</code></a>.<a data-link-type=\"method\" data-lt=\"getService()\" href=\"https://webbluetoothcg.github.io/web-bluetooth/#dom-bluetoothuuid-getservice\"><code>getService</code></a><code>()</code> with <var data-type=\"BluetoothServiceUUID\">serviceUuid</var>."
        },
        {
          "html": "Let <var data-type=\"list&lt;BluetoothServiceUUID&gt;\">blocklist</var> be the result of\n        <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-parsing-the-bluetooth-service-class-id-blocklist\" class=\"internalDFN\" id=\"ref-for-dfn-parsing-the-bluetooth-service-class-id-blocklist-1\">parsing the Bluetooth service class ID blocklist</a> at <a href=\"https://github.com/WICG/serial/blob/main/blocklist.txt\">https://github.com/WICG/serial/blob/main/blocklist.txt</a>."
        },
        {
          "html": "If <var data-type=\"list&lt;BluetoothServiceUUID&gt;\">blocklist</var> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-contain\">contains</a> <var data-type=\"UUID\">uuid</var>, return <code>true</code>."
        },
        {
          "html": "If <var data-type=\"UUID\">uuid</var> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#string-is\">is</a> the <a data-link-type=\"dfn|abstract-op\" href=\"https://wicg.github.io/serial/#dfn-serial-port-profile-service-class-id\" class=\"internalDFN\" id=\"ref-for-dfn-serial-port-profile-service-class-id-2\">Serial Port Profile service class ID</a>, return <code>false</code>."
        },
        {
          "html": "If <var data-type=\"UUID\">uuid</var> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#string-ends-with\">ends with</a> \"<code>-0000-1000-8000-00805f9b34fb</code>\",\n        return <code>true</code>."
        },
        {
          "html": "Otherwise, return <code>false</code>."
        }
      ]
    }
  ]
}